<!DOCTYPE html>
<html lang="en-US" class="">

<!-- Mirrored from 127.0.0.1/products/oneapi/construction-kit/4.0.0/guides/specifications/mux-runtime-spec.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 22 Sep 2025 18:48:44 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <!-- Basics -->
    <title>ComputeMux Runtime Specification - Guides - oneAPI Construction Kit - Products - Codeplay Developer</title>
    <meta name="description" content="Read the 'ComputeMux Runtime Specification' for oneAPI Construction Kit 4.0.0 developer guide." />
    <meta name="keywords" content="guides, tutorials, guide, oneapi, construction, kit, risc-v, arm" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Open Graph -->
    <meta name="title" property="og:title" content="ComputeMux Runtime Specification - Guides - oneAPI Construction Kit - Products - Codeplay Developer" />
    <meta name="type" property="og:type" content="website" />
    <meta name="image" property="og:image" content="../../../../../../assets/img/og-header.png" />
    <meta name="url" property="og:url" content="../../../../../../index.html" />
    <meta name="description" property="og:description" content="Read the 'ComputeMux Runtime Specification' for oneAPI Construction Kit 4.0.0 developer guide." />

    <!-- Fonts -->
    <link href="../../../../../../assets/css/material.css"
          rel="stylesheet preload prefetch"
          as="style" />

    <!-- Fav icon -->
    <link rel="icon" type="image/png" href="../../../../../../favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="../../../../../../favicon.svg" />
    <link rel="shortcut icon" href="../../../../../../favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../../apple-touch-icon.html" />

    <link type="text/css"
          href="../../../../../../assets/css/responsive.css"
          rel="stylesheet"/>

    <script src="https://cdn.usefathom.com/script.js" data-site="XBWVDDFP" defer></script>

    <!-- Stylesheets -->
    <link type="text/css"
          href="../../../../../../assets/css/jquery.cookiepolicyprompt.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/jquery.popupdialog.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/dialogs.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/IndexPage.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/Guides/GuidePageLayout.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/Guides/GuidePageFormatting.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/Guides/GuidePage.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/Products/OneApi/ConstructionKit/OneApiConstructionKitShared.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/Products/OneApi/ConstructionKit/Guide/OneApiConstructionKitGuidePage.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>
    <link type="text/css"
          href="../../../../../../assets/css/Pages/Products/OneApi/ConstructionKit/Guide/OneApiConstructionKitGuidePage.style.css"
          rel="stylesheet preload prefetch"
          as="style"/>

    <!-- Scripts -->
    <script src="../../../../../../assets/js/jquery-3.6.3.min.js"></script>
    <script src="../../../../../../assets/js/jquery.copyright.js"></script>
    <script src="../../../../../../assets/js/jquery.cookiepolicyprompt.js"></script>
    <script src="../../../../../../assets/js/jquery.popupdialog.js"></script>
    <script src="../../../../../../assets/js/Pages/IndexPage.script.js"></script>
    <script src="../../../../../../assets/js/highlight.min.js"></script>
    <script src="../../../../../../assets/js/Pages/Guides/jquery.headingsinfocus.js"></script>
    <script src="../../../../../../assets/js/Pages/Guides/togglebutton.js"></script>
    <script src="../../../../../../assets/js/Pages/Guides/jquery.resizable.js"></script>
    <script src="../../../../../../assets/js/Pages/Guides/GuidePage.script.js"></script>

    <script>
        document.querySelectorAll('link').forEach((el) => {this.onload=null;this.rel='stylesheet';});
    </script>
</head>
<body data-deprecated="">

<!-- Header -->
<header>
    <nav class="main">
        <div>
            <a aria-label="Navigation Bar Logo" href="../../../../../../index.html">
                <div id="codeplay-logo"></div>
            </a>
        </div>
        <div>
            <a title="Click to change production selection">
                <div>
                    <h2>Product</h2>
                    <h1>oneAPI Construction Kit</h1>
                </div>
            </a>
        </div>
        <div>
            <ul>
                <li >
                    <a href="../../../home.html" >
                        <div>

                            <span class="icon material-icons">home</span>

                            <div>Home</div>
                        </div>
                    </a>
                </li>
                <li  class="selected" >
                    <a href="../../../guides/index.html" >
                        <div>

                            <span class="icon material-icons">menu_book</span>

                            <div>Guides</div>
                        </div>
                    </a>
                </li>
                <li >
                    <a href="https://github.com/codeplaysoftware/oneapi-construction-kit" target="_blank">
                        <div>

                            <span class="icon material-icons">local_library</span>

                            <div>Repository</div>
                        </div>
                    </a>
                </li>
            </ul>
        </div>
        <div>
            <ul>
                <li>
                    <a href="../../../../../../support/index.html" title="Get Support">
                        <span class="material-icons">help_outline</span>
                    </a>
                </li>
                <li>
                    <a id="burger"
                       title="Show Navigation Menu">
                        <span class="material-icons">menu</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- The burger menu, designed for mobile -->
    <div id="burger-menu">
        <ul>
            <li>
                <h1>oneAPI Menu</h1>
                <ul>
                    <li >
                        <a href="../../../home.html"
                           >Home</a>
                    </li>
                    <li  class="selected" >
                        <a href="../../../guides/index.html"
                           >Guides</a>
                    </li>
                    <li >
                        <a href="https://github.com/codeplaysoftware/oneapi-construction-kit"
                           target="_blank">Repository</a>
                    </li>
                </ul>
            </li>
            <li>
                <h1>Main Menu</h1>
                <ul>
                    <li>
                        <a href="../../../../../../index.html">Home</a>
                    </li>
                    <li>
                        <h1>Products</h1>
                        <ul>
                            <li>
                                <a href="../../../../../computecpp/ce/index.html">ComputeCpp CE</a>
                            </li>
                            <li>
                                <a href="../../../../../computecpp/pe/index.html">ComputeCpp PE</a>
                            </li>
                            <li>
                                <a href="../../../../../computesuitercar/ce/index.html">ComputeSuite for R-Car CE</a>
                            </li>
                            <li>
                                <a href="../../../../../computesuitercar/pe/index.html">ComputeSuite for R-Car PE</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="../../../../../../cookies.html">Cookie Policy</a>
                    </li>
                    <li>
                        <a href="https://codeplay.com/support/contact">Contact Us</a>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
</header>

<!-- Main element -->
<main>

    <!-- File Container -->
<div class="layout-file guide" id="specifications-mux-runtime-spec">
    <!-- Side Menu -->
    <div class="sticky file-menu-container styled-scroller">
       <div class="nav-padding">
           <!-- Title & Version Selector -->
           <div class="header">
               <h1 class="file-container-title">
                   <span class="material-icons">menu_book</span>Guides
               </h1>
               <div>
                   <!-- Version Selector -->
                   <div class="version-selector ">
                       <div><span class="material-icons">history</span>4.0.0</div>
                       <ul>
                           <li><a href="../index.html">4.0.0</a></li>
                           <li><a href="../../../3.0.0/guides/index.html">3.0.0</a></li>
                           <li><a href="../../../2.0.0/guides/index.html">2.0.0</a></li>
                       </ul>
                       <ul>
                           <li><a href="../index.html">4.0.0</a></li>
                           <li><a href="../../../3.0.0/guides/index.html">3.0.0</a></li>
                           <li><a href="../../../2.0.0/guides/index.html">2.0.0</a></li>
                       </ul>
                       <ul>
                           <li><a href="../index.html">4.0.0</a></li>
                           <li><a href="../../../3.0.0/guides/index.html">3.0.0</a></li>
                           <li><a href="../../../2.0.0/guides/index.html">2.0.0</a></li>
                       </ul>
                   </div>
               </div>
           </div>
           <!-- Menu -->
           <ol class="file-menu">
               <li class=""><a href="../index-2.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Welcome to oneAPI Construction Kit’s documentation!</a><ol></ol></li>               <li class=""><a href="../overview.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>oneAPI Construction Kit Overview</a><ol><li class=""><a href="../overview/preface.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Preface</a><ol></ol></li><li class=""><a href="../overview/introduction.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Introduction</a><ol><li class=""><a href="../overview/introduction/architecture.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>oneAPI Construction Kit Architecture</a><ol></ol></li><li class=""><a href="../overview/introduction/compiler-view.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Compiler View</a><ol></ol></li></ol></li><li class=""><a href="../overview/hardware.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Mapping ComputeMux to Hardware</a><ol><li class=""><a href="../overview/hardware/memory-requirements.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Memory Requirements</a><ol></ol></li><li class=""><a href="../overview/hardware/atomic-requirements.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Atomic Requirements</a><ol></ol></li><li class=""><a href="../overview/hardware/floating-point-requirements.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Floating-Point Requirements</a><ol></ol></li><li class=""><a href="../overview/hardware/synchronization-requirements.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Synchronization Requirements</a><ol></ol></li></ol></li><li class=""><a href="../overview/runtime.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Runtime Information</a><ol><li class=""><a href="../overview/runtime/computemux-runtime.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>ComputeMux Runtime</a><ol></ol></li><li class=""><a href="../overview/runtime/driver-requirements.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Driver Requirements</a><ol></ol></li><li class=""><a href="../overview/runtime/supported-toolchains.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Supported Toolchains</a><ol></ol></li></ol></li><li class=""><a href="../overview/compiler.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Compiler Information</a><ol><li class=""><a href="../overview/compiler/computemux-compiler.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>ComputeMux Compiler</a><ol></ol></li><li class=""><a href="../overview/compiler/ir.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Intermediate Representation</a><ol></ol></li><li class=""><a href="../overview/compiler/supported-llvm-versions.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Supported LLVM Versions</a><ol></ol></li><li class=""><a href="../overview/compiler/non-requirements.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>ComputeMux Compiler Non-Requirements</a><ol></ol></li></ol></li><li class=""><a href="../overview/example-scenarios.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Example Hardware Feature Scenarios</a><ol><li class=""><a href="../overview/example-scenarios/mapping-custom-instructions-to-builtin-functions.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Mapping Custom Instructions To Builtin Functions</a><ol></ol></li><li class=""><a href="../overview/example-scenarios/mapping-custom-ip-blocks-to-builtin-kernels.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Mapping Custom IP Blocks To Builtin Kernels</a><ol></ol></li><li class=""><a href="../overview/example-scenarios/how-to-support-large-scratchpad-memories.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>How To Support Large Scratchpad Memories</a><ol></ol></li><li class=""><a href="../overview/example-scenarios/mapping-algorithms-to-vector-hardware.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Mapping Algorithms To Vector Hardware</a><ol></ol></li><li class=""><a href="../overview/example-scenarios/refsi-in-kernel-dma.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>RefSi In-Kernel DMA for RISC-V</a><ol></ol></li></ol></li><li class=""><a href="../overview/toolkit.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>oneAPI Construction Kit</a><ol></ol></li><li class=""><a href="../overview/new-target-quick-start.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Creating a New ComputeMux Target: Quick Start</a><ol></ol></li><li class=""><a href="../overview/tutorials.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Tutorials</a><ol><li class=""><a href="../overview/tutorials/creating-a-new-hal.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Creating a New HAL</a><ol><li class=""><a href="../overview/tutorials/creating-new-hal/initial-setup.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Initial Setup</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-new-hal/kernel-compilation.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Kernel Compilation</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-new-hal/runing-clik-tests.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Running clik Tests</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-new-hal/skeleton-hal-overview.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Overview of the Skeleton HAL Code</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-new-hal/implementing-hal-operations.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Implementing HAL Operations</a><ol></ol></li></ol></li><li class=""><a href="../overview/tutorials/creating-a-new-mux-target.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Creating a New ComputeMux Target</a><ol><li class=""><a href="../overview/tutorials/creating-a-new-mux-target/running-new-target-script.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Running the create_target.py Script</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-a-new-mux-target/building-and-running-tests.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Building and Running Tests</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-a-new-mux-target/adapting-target-pass-pipeline.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Adapting the Pass Pipeline for the Target</a><ol></ol></li><li class=""><a href="../overview/tutorials/creating-a-new-mux-target/extending-it-further.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Extending it Further</a><ol></ol></li></ol></li></ol></li><li class=""><a href="../overview/reference-silicon.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Codeplay Reference Silicon</a><ol><li class=""><a href="../overview/reference-silicon/overview.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Codeplay Reference Silicon Overview</a><ol></ol></li><li class=""><a href="../overview/reference-silicon/command-processor.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Command Processor Reference</a><ol></ol></li><li class=""><a href="../overview/reference-silicon/dma-controller.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>DMA Controller Reference</a><ol></ol></li><li class=""><a href="../overview/reference-silicon/dma-programming-guide.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>DMA Programming Guide</a><ol></ol></li><li class=""><a href="../overview/reference-silicon/driver-interface.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>RefSi Driver Interface</a><ol></ol></li><li class=""><a href="../overview/reference-silicon/mapping-opencl-to-refsi.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>How The Platform Maps to SYCL and OpenCL</a><ol></ol></li></ol></li></ol></li>               <li class=""><a href="../getting-started.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Getting Started</a><ol></ol></li>               <li class="selected"><a href="../specifications.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Specifications</a><ol><li class=""><a href="versioning.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Versioning Scheme</a><ol></ol></li><li class="selected focused"><a href="mux-runtime-spec.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>ComputeMux Runtime Specification</a><ol></ol></li><li class=""><a href="mux-compiler-spec.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>ComputeMux Compiler Specification</a><ol></ol></li></ol></li>               <li class=""><a href="../developer-guide.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Developer Guide</a><ol></ol></li>               <li class=""><a href="../tutorials.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Tutorials</a><ol><li class=""><a href="../tutorials/adding-a-custom-builtins-extension.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Adding A Custom Builtins Extension</a><ol></ol></li><li class=""><a href="../tutorials/custom-lowering-work-item-builtins.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Custom Lowering Work-Item Builtins</a><ol></ol></li><li class=""><a href="../tutorials/adding-target-specific-metadata.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Adding Target-Specific Metadata</a><ol></ol></li></ol></li>               <li class=""><a href="../design.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Design</a><ol></ol></li>               <li class=""><a href="../source/cl.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>OpenCL</a><ol><li class=""><a href="../source/cl/cmake.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>OpenCL CMake</a><ol></ol></li><li class=""><a href="../source/cl/computemux_mapping.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>How OpenCL Concepts Are Mapped Onto ComputeMux</a><ol></ol></li><li class=""><a href="../source/cl/extension.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>OpenCL Extensions</a><ol><li class=""><a href="../source/cl/extension/cl_codeplay_kernel_debug.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Kernel Debug - cl_codeplay_kernel_debug</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_codeplay_extra_build_options.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Extra Build Options - cl_codeplay_extra_build_options</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_codeplay_kernel_exec_info.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Kernel Exec Info - cl_codeplay_kernel_exec_info</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_codeplay_performance_counters.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Performance Counters - cl_codeplay_performance_counters</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_codeplay_soft_math.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Soft Math - cl_codeplay_soft_math</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_codeplay_wfv.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Whole Function Vectorization - cl_codeplay_wfv</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_intel_unified_shared_memory.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>USM - cl_intel_unified_shared_memory</a><ol></ol></li><li class=""><a href="../source/cl/extension/cl_intel_required_subgroup_size.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Required subgroup sizes for kernels  - cl_intel_required_subgroup_size</a><ol></ol></li></ol></li><li class=""><a href="../source/cl/external-extensions.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>OpenCL External Extensions</a><ol></ol></li><li class=""><a href="../source/cl/icd-loader.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>OpenCL ICD Loader</a><ol></ol></li><li class=""><a href="../source/cl/intercept.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>OpenCL Intercept Layer</a><ol></ol></li><li class=""><a href="../source/cl/tools.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Tools</a><ol></ol></li><li class=""><a href="../source/cl/test.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Tests</a><ol><li class=""><a href="../source/cl/test/unitcl.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>UnitCL</a><ol></ol></li></ol></li></ol></li>               <li class=""><a href="../source/vk.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Vulkan</a><ol></ol></li>               <li class=""><a href="../modules.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Modules</a><ol><li class=""><a href="../modules/builtins.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Builtins</a><ol><li class=""><a href="../modules/builtins/abacus.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Abacus</a><ol></ol></li><li class=""><a href="../modules/builtins/libimg.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Image Library</a><ol></ol></li></ol></li><li class=""><a href="../modules/mux.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>ComputeMux</a><ol><li class=""><a href="../modules/mux/changes.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Change Log</a><ol></ol></li><li class=""><a href="../modules/mux/compiler.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Compiler</a><ol></ol></li><li class=""><a href="../modules/mux/cmake.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>CMake</a><ol></ol></li><li class=""><a href="../modules/mux/bumping-the-spec.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Bumping the Specification Version</a><ol></ol></li></ol></li><li class=""><a href="../modules/host.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Host CPU</a><ol><li class=""><a href="../modules/mux/targets/host/extension/cl_codeplay_host_builtins.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>cl_codeplay_host_builtins</a><ol></ol></li><li class=""><a href="../modules/mux/targets/host/extension/cl_codeplay_set_threads.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>cl_codeplay_set_threads</a><ol></ol></li><li class=""><a href="../modules/mux/targets/host/lit.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Host lit test suite</a><ol></ol></li><li class=""><a href="../modules/mux/targets/host/debug.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Host Debug Features</a><ol></ol></li></ol></li><li class=""><a href="../modules/riscv.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>RISC-V</a><ol></ol></li><li class=""><a href="../modules/compiler.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Compiler</a><ol><li class=""><a href="../modules/compiler/overview.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Overview</a><ol></ol></li><li class=""><a href="../modules/compiler/utils.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Compiler Utilities</a><ol></ol></li><li class=""><a href="../modules/compiler/tools.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Tools</a><ol><li class=""><a href="../modules/compiler/tools/muxc.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>muxc</a><ol></ol></li></ol></li></ol></li><li class=""><a href="../modules/loader.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>ELF loader</a><ol></ol></li><li class=""><a href="../modules/vecz.html"><div class="icon"><span class="icon material-icons">subdirectory_arrow_right</span></div>Vecz</a><ol><li class=""><a href="../modules/vecz/vecz.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Vecz Documentation</a><ol></ol></li></ol></li><li class=""><a href="../modules/spirv-ll.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>spirv-ll</a><ol></ol></li><li class=""><a href="../modules/debug.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Debug Module</a><ol></ol></li><li class=""><a href="../modules/cargo.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Cargo Module</a><ol></ol></li><li class=""><a href="../modules/metadata.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Metadata API</a><ol></ol></li></ol></li>               <li class=""><a href="../cmake.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>CMake Development</a><ol></ol></li>               <li class=""><a href="../scripts.html"><div class="icon"><span class="icon material-icons">arrow_forward</span></div>Scripts</a><ol></ol></li>           </ol>
       </div>
    </div>
    <!-- Core Content -->
    <div>
        <!-- File Content -->
        <div id="content-container" class="nav-padding">
            <article class="file-content-container">
                <header>
                    <!-- Deprecated Notice -->

                    <div class="title">
                        <a class="header-link" href="#computemux-runtime-specification">
                            <h1>ComputeMux Runtime Specification</h1>
                        </a>
                        <div>
                            <a href="#rate" title="Rate this guide">
                                <i class="material-icons">thumb_up</i>
                            </a>

                            <a target="_blank" href="https://github.com/codeplaysoftware/oneapi-construction-kit/blob/main/doc/specifications/mux-runtime-spec.rst" rel="noopener" title="Contribute to this guide">
                                <i class="material-icons">edit</i>
                            </a>

                            <a href="mux-compiler-spec-2.html" title="Goto the next guide">
                                <i class="material-icons">arrow_forward_ios</i>
                            </a>
                        </div>
                    </div>

                </header>

                <div class="formatted-text">
                    <a id="top"></a>
                    <html><body><div class="document">
<div>
<div class="section" id="computemux-runtime-specification">

<blockquote>
<div><p>This is version 0.80.0 of the specification.</p>
</div></blockquote>
<p>ComputeMux is Codeplay’s proprietary API for executing compute workloads across
heterogeneous devices. ComputeMux is an extremely lightweight,
bare-to-the-metal abstraction on modern hardware, and is used to power a suite
of open source standards. ComputeMux consists of a <a class="reference internal" href="#"><span class="doc">Runtime Specification</span></a> and <a class="reference internal" href="mux-compiler-spec.html"><span class="doc">Compiler Specification</span></a>. This document refers to the Runtime
component.</p>
<p>Throughout this specification, ComputeMux has been shortened to Mux for brevity,
but for the avoidance of all doubt, “Mux” refers to “ComputeMux”.</p>
<div class="section" id="glossary">
<a class="header-link" href="#glossary"><h2 id="glossary">Glossary</h2><span class="material-icons">link</span></a>
<p>The key statements <strong>must</strong>, <strong>must not</strong>, <strong>shall</strong>, <strong>shall not</strong>,
<strong>should</strong>, <strong>should not</strong>, <strong>may</strong>, in this document are to be
interpreted as described in <a class="reference external" href="http://www.ietf.org/rfc/rfc2119.txt">IETF RFC
2119</a>.</p>
<ul class="simple">
<li><p><strong>must</strong> or <strong>shall</strong> - means that the definition is an absolute
requirement of the specification.</p></li>
<li><p><strong>must not</strong> or <strong>shall not</strong> - means that the definition is an
absolute prohibition of the specification.</p></li>
<li><p><strong>should</strong> - means that the definition is highly likely to occur, but
there are extraneous circumstances that could result in it not
occurring.</p></li>
<li><p><strong>should not</strong> - means that the definition is highly likely to not
occur, but there are extraneous circumstances that could result in it
occurring.</p></li>
<li><p><strong>may</strong> - means that an item is optional.</p></li>
</ul>
</div>
<div class="section" id="introduction">
<a class="header-link" href="#introduction"><h2 id="introduction">Introduction</h2><span class="material-icons">link</span></a>
<p>This document describes the Mux API, how it is used, and requirements to
follow on its usage.</p>
</div>
<div class="section" id="allocators">
<a class="header-link" href="#allocators"><h2 id="allocators">Allocators</h2><span class="material-icons">link</span></a>
<p>All host-side allocations performed by Mux <strong>should</strong> use the user
provided allocators. A valid exception could be to implement Mux on top
of another framework, e.g., LLVM, which does not support user provided
allocators.</p>
<p>Many Mux API functions take a <code class="docutils literal notranslate">mux_allocator_info_t</code> object which
specifies the allocator to use for their related object creation,
destruction, and operation of the object:</p>
<pre><code class="language-c">typedef struct mux_allocator_info_s mux_allocator_info_t;
</code>
</pre>
<p>Where <code class="docutils literal notranslate">mux_allocator_info_s</code> is defined to be:</p>
<pre><code class="language-c">struct mux_allocator_info_s {
  void* (*alloc)(void* user_data, size_t size, size_t alignment);
  void (*free)(void* user_data, void* pointer);
  void* user_data;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">alloc</code> - allocate aligned memory.</p></li>
<li><p><code class="docutils literal notranslate">free</code> - free previously allocated memory.</p></li>
<li><p><code class="docutils literal notranslate">user_data</code> - user data passed to each call of <code class="docutils literal notranslate">alloc</code> and
<code class="docutils literal notranslate">free</code>.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">alloc</code> <strong>must not</strong> be NULL, otherwise <code class="docutils literal notranslate">mux_allocator_info_s</code> is
invalid.</p></li>
<li><p><code class="docutils literal notranslate">free</code> <strong>must not</strong> be NULL, otherwise <code class="docutils literal notranslate">mux_allocator_info_s</code> is
invalid.</p></li>
<li><p><code class="docutils literal notranslate">user_data</code> <strong>may</strong> be NULL.</p></li>
<li><p>Calls to <code class="docutils literal notranslate">alloc()</code> <strong>should</strong> return a valid pointer address, the
address of which <strong>must</strong> be sized to the <code class="docutils literal notranslate">size</code> argument and
<strong>must</strong> be aligned to the <code class="docutils literal notranslate">alignment</code> argument.</p></li>
<li><p>Calls to <code class="docutils literal notranslate">free()</code> <strong>must</strong> succeed for any <code class="docutils literal notranslate">pointer</code> argument
that was previously returned from <code class="docutils literal notranslate">alloc()</code>.</p></li>
<li><p>Calls to <code class="docutils literal notranslate">alloc()</code> and <code class="docutils literal notranslate">free()</code> <strong>must</strong> be callable from
concurrent threads of execution. Mux device’s are not required to
lock calls to these callbacks.</p></li>
</ul>
<p>Functions with a <code class="docutils literal notranslate">mux_allocator_info_t</code> parameter check that the
<code class="docutils literal notranslate">alloc</code> and <code class="docutils literal notranslate">free</code> fields are not <code class="docutils literal notranslate">NULL</code> but they do not perform
exhaustive testing, e.g., it is not tested if the argument to a
<code class="docutils literal notranslate">muxDestroy...</code> function matches the <code class="docutils literal notranslate">mux_allocator_info_t</code> argument
passed to the matching <code class="docutils literal notranslate">muxCreate...</code> function.</p>
</div>
<div class="section" id="callbacks">
<a class="header-link" href="#callbacks"><h2 id="callbacks">Callbacks</h2><span class="material-icons">link</span></a>
<p>Mux supports a callback message reporting mechanism which allows
implementations to inform the user of detailed information relating to
their use of the API. This mechanism is optional. There are two entry
points which these callbacks <strong>may</strong> be supplied to,
<a class="reference external" href="#muxcreatefinalizer">muxCreateFinalizer</a> and
<a class="reference external" href="#muxcreatecommandbuffer">muxCreateCommandBuffer</a>, both take a
<code class="docutils literal notranslate">mux_callback_info_t</code> which is defined as.</p>
<pre><code class="language-c">typedef struct mux_callback_info_s* mux_callback_info_t;
</code>
</pre>
<p>Where <code class="docutils literal notranslate">mux_callback_info_s</code> is defined to be:</p>
<pre><code class="language-c">struct mux_callback_info_s {
  void (*callback)(
      void* user_data,
      const char* message,
      const void* data,
      size_t data_size);
  void *user_data;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">callback</code> - callback to provide detailed information about an
error or to provide optimization hints to the user.</p>
<ul>
<li><p><code class="docutils literal notranslate">user_data</code> - Pointer to the user data provided by the user.</p></li>
<li><p><code class="docutils literal notranslate">message</code> - String containing a message from the implementation
to the user.</p></li>
<li><p><code class="docutils literal notranslate">data</code> - An implementation defined binary data blob containing
additional data, <strong>may</strong> be null.</p></li>
<li><p><code class="docutils literal notranslate">data_size</code> - The size in bytes of the data blob, <strong>must</strong> be
<code class="docutils literal notranslate">0</code> if <code class="docutils literal notranslate">data</code> is NULL.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate">user_data</code> - User data provided by the user.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">callback</code> <strong>must not</strong> be NULL, otherwise <code class="docutils literal notranslate">mux_callback_info_s</code>
is invalid.</p></li>
<li><p><code class="docutils literal notranslate">user_data</code> <strong>may</strong> be NULL.</p></li>
</ul>
</div>
<div class="section" id="devices">
<a class="header-link" href="#devices"><h2 id="devices">Devices</h2><span class="material-icons">link</span></a>
<p>Mux is designed to support multiple devices. Each device conforms to the
same API, but is allowed to expose differing capabilities. For example,
device A could support images, whereas device B might not.</p>
<p>There are multiple possible types of device which are distinguished by
the <code class="docutils literal notranslate">mux_device_type_e</code> enumeration.</p>
<pre><code class="language-c">enum mux_device_type_e {
  mux_device_type_cpu = (0x1 &lt;&lt; 0),
  mux_device_type_gpu_integrated = (0x1 &lt;&lt; 1),
  mux_device_type_gpu_discrete = (0x1 &lt;&lt; 2),
  mux_device_type_gpu_virtual = (0x1 &lt;&lt; 3),
  mux_device_type_accelerator = (0x1 &lt;&lt; 4),
  mux_device_type_custom = (0x1 &lt;&lt; 5),
  mux_device_type_compiler = (0x1 &lt;&lt; 6),
  mux_device_type_all = 0xFFFFFFFF
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_device_type_cpu</code> - device is a CPU.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_gpu_integrated</code> - device is an integrated GPU.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_gpu_discrete</code> - device is a discrete GPU.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_gpu_virtual</code> - device is a virtualized GPU.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_accelerator</code> - device is an accelerator chip.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_custom</code> - device is a mysterious custom type.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_compiler</code> - device is a compiler, used for offline
and cross compilation.</p></li>
<li><p><code class="docutils literal notranslate">mux_device_type_all</code> - bit-mask to match all device types.</p></li>
</ul>
<p>An instance of <code class="docutils literal notranslate">mux_device_info_t</code> contains the information about a
device’s capabilities and related metadata, and <code class="docutils literal notranslate">mux_device_t</code> stores
an initialized device’s state. A device for which <code class="docutils literal notranslate">mux_device_info_t</code>
<strong>may</strong> not be initializable, for example if it’s not physically present
in the system, but it can still be useful as a target for compilation.</p>
<pre><code class="language-c">struct mux_device_info_s {
  mux_id_t id;
  uint32_t allocation_capabilities;
  uint32_t source_capabilities;
  uint32_t address_capabilities;
  uint32_t atomic_capabilities;
  uint32_t cache_capabilities;
  uint32_t half_capabilities;
  uint32_t float_capabilities;
  uint32_t double_capabilities;
  uint32_t integer_capabilities;
  uint32_t custom_buffer_capabilities;
  uint32_t endianness;
  uint32_t khronos_vendor_id;
  uint32_t shared_local_memory_type;
  uint32_t device_type;
  const char* builtin_kernel_declarations;
  const char* device_name;
  uint32_t max_concurrent_work_items;
  uint32_t max_work_group_size_x;
  uint32_t max_work_group_size_y;
  uint32_t max_work_group_size_z;
  uint32_t max_work_width;
  uint32_t clock_frequency;
  uint32_t compute_units;
  uint32_t buffer_alignment;
  uint64_t memory_size;
  uint64_t allocation_size;
  uint64_t cache_size;
  uint64_t cacheline_size;
  uint64_t shared_local_memory_size;
  uint32_t native_vector_width;
  uint32_t preferred_vector_width;
  bool image_support;
  bool image2d_array_writes;
  bool image3d_writes;
  uint32_t max_image_dimension_1d;
  uint32_t max_image_dimension_2d;
  uint32_t max_image_dimension_3d;
  uint32_t max_image_array_layers;
  uint32_t max_storage_images;
  uint32_t max_sampled_images;
  uint32_t max_samplers;
  uint32_t queue_types[mux_queue_type_total];
  int8_t device_priority;
  bool query_counter_support;
  bool descriptors_updatable;
  bool can_clone_command_buffers;
  bool supports_builtin_kernels;
  uint32_t max_sub_group_count;
  bool sub_groups_support_ifp;
  uint32_t max_hardware_counters;
  bool supports_work_group_collectives;
  bool supports_generic_address_space;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">id</code> - the ID of this device object.</p></li>
<li><p><code class="docutils literal notranslate">allocation_capabilities</code> - a bitfield of
<code class="docutils literal notranslate">mux_allocation_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">source_capabilities</code> - a bitfield of
<code class="docutils literal notranslate">mux_source_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">address_capabilities</code> - a bitfield of
<code class="docutils literal notranslate">mux_address_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">atomic_capabilities</code> - a bitfield of
<code class="docutils literal notranslate">mux_atomic_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">cache_capabilities</code> - a bitfield of <code class="docutils literal notranslate">mux_cache_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">half_capabilities</code> - half floating point support, a bitfield of
<code class="docutils literal notranslate">mux_floating_point_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">float_capabilities</code> - floating point support, a bitfield of
<code class="docutils literal notranslate">mux_floating_point_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">double_capabilities</code> - double floating point support, a bitfield
of <code class="docutils literal notranslate">mux_floating_point_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">integer_capabilities</code> - integer support, a bitfield of
<code class="docutils literal notranslate">mux_integer_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">custom_buffer_capabilities</code> - custom buffer support, a bitfield of
<code class="docutils literal notranslate">mux_custom_buffer_capabilities_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">endianness</code> - endianness of the device, one of
<code class="docutils literal notranslate">mux_endianness_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">khronos_vendor_id</code> - the Khronos vendor ID of this device.</p></li>
<li><p><code class="docutils literal notranslate">shared_local_memory_type</code> - the type of shared local memory this
device has, one of <code class="docutils literal notranslate">mux_shared_local_memory_type_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">device_type</code> - the type of this device, one of
<code class="docutils literal notranslate">mux_device_type_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">builtin_kernel_declarations</code> - a null-terminated C string of
semicolon-separated built-in kernel declarations.</p></li>
<li><p><code class="docutils literal notranslate">device_name</code> - the string name of this device, terminated by a
<code class="docutils literal notranslate">\0</code>.</p></li>
<li><p><code class="docutils literal notranslate">max_concurrent_work_items</code> - the maximum number of work items in a
work group that can run concurrently.</p></li>
<li><p><code class="docutils literal notranslate">max_work_group_size_x</code> - the maximum number of work items in the x
dimension of a work group.</p></li>
<li><p><code class="docutils literal notranslate">max_work_group_size_y</code> - the maximum number of work items in the y
dimension of a work group.</p></li>
<li><p><code class="docutils literal notranslate">max_work_group_size_z</code> - the maximum number of work items in the z
dimension of a work group.</p></li>
<li><p><code class="docutils literal notranslate">max_work_width</code> - the maximum number of work items of a work group allowed
to execute in one invocation of a kernel.</p></li>
<li><p><code class="docutils literal notranslate">clock_frequency</code> - the maximum normal clock frequency (in MHz) of
this device.</p></li>
<li><p><code class="docutils literal notranslate">compute_units</code> - the number of compute units this device has.</p></li>
<li><p><code class="docutils literal notranslate">buffer_alignment</code> the alignment (in bytes) of <code class="docutils literal notranslate">mux_buffer_t</code>’s
allocated by this device.</p></li>
<li><p><code class="docutils literal notranslate">memory_size</code> - the size (in bytes) of the memory on this device.</p></li>
<li><p><code class="docutils literal notranslate">allocation_size</code> - the maximum size (in bytes) of a single memory
allocation on this device.</p></li>
<li><p><code class="docutils literal notranslate">cache_size</code> - the size (in bytes) of the cache on this device.
<code class="docutils literal notranslate">cache_size</code> <strong>may</strong> be zero if the device does not support a
cache.</p></li>
<li><p><code class="docutils literal notranslate">cacheline_size</code> - the size (in bytes) of a line on the cache on
this device. <code class="docutils literal notranslate">cacheline_size</code> <strong>may</strong> be zero if the device does
not support a cache.</p></li>
<li><p><code class="docutils literal notranslate">shared_local_memory_size</code> - the size (in bytes) of the shared
local memory on this device.</p></li>
<li><p><code class="docutils literal notranslate">native_vector_width</code> - the native vector width (in bytes).</p></li>
<li><p><code class="docutils literal notranslate">preferred_vector_width</code> - the preferred vector width (in bytes).</p></li>
<li><p><code class="docutils literal notranslate">image_support</code> - Is true if the device supports images otherwise
false.</p></li>
<li><p><code class="docutils literal notranslate">image2d_array_writes</code> - If the device supports 2d image array
writes.</p></li>
<li><p><code class="docutils literal notranslate">image3d_writes</code> - If the device supports 3d image writes.</p></li>
<li><p><code class="docutils literal notranslate">max_image_dimension_1d</code> - The maximum dimension size in pixels for
a one dimensional image, zero if images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">max_image_dimension_2d</code> - The maximum dimension size in pixels for
a two dimensional image, zero if images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">max_image_dimension_3d</code> - The maximum dimension size in pixels for
a three dimensional image, zero if images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">max_image_array_layers</code> - The maximum array layers count for an
image array, zero if images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">max_storage_images</code> - The maximum number of bound images for image
storage (write), zero if images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">max_sampled_images</code> - The maximum number of bound images for image
sampling (read), zero if images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">max_samplers</code> - The maximum number of bound samplers, zero if
images are not supported.</p></li>
<li><p><code class="docutils literal notranslate">queue_types</code> - An array of queue types - one for each
<code class="docutils literal notranslate">mux_queue_type_e</code> member. Each element of the array specifies how
many queues of a specific type are supported by the device.</p></li>
<li><p><code class="docutils literal notranslate">device_priority</code> - This value is used for tracking device priority
when deciding which devices shall be returned if
<code class="docutils literal notranslate">CL_DEVICE_TYPE_DEFAULT</code> is requested. Host will have a value of
<code class="docutils literal notranslate">0</code> where higher priority devices will be in the positive range and
conversely a lower priority for the negative range.</p></li>
<li><p><code class="docutils literal notranslate">query_counter_support</code> - Is true if the device supports
<code class="docutils literal notranslate">mux_query_type_counter</code>.</p></li>
<li><p><code class="docutils literal notranslate">descriptors_updatable</code> -  Is true the device supports updating the
<code class="docutils literal notranslate">mux_device_info_t</code>  argument descriptors passed to a specialized
kernel in a <code class="docutils literal notranslate">muxCommandNDRange</code> command after the containing
<code class="docutils literal notranslate">mux_command_buffer</code> has been finalized.</p></li>
<li><p><code class="docutils literal notranslate">can_clone_command_buffers</code> - Is true if the device supports cloning
<code class="docutils literal notranslate">mux_command_buffers</code> via the <code class="docutils literal notranslate">muxCloneCommandBuffer</code> entry point.</p></li>
<li><p><code class="docutils literal notranslate">supports_builtin_kernels</code> - Is true if the device supports creating
built-in kernels via the <code class="docutils literal notranslate">muxCreateBuiltInKernel</code> entry point.</p></li>
<li><p><code class="docutils literal notranslate">max_sub_group_count</code> - The maximum number of sub-groups in a
work-group. A target not supporting sub-groups must set this to <cite>0</cite>.</p></li>
<li><p><code class="docutils literal notranslate">sub_groups_support_ifp</code> - Is true if the device supports independent
forward progress in its sub-groups. A target not supporting sub-groups
must set this to <cite>false</cite>.</p></li>
<li><p><code class="docutils literal notranslate">max_hardware_counters</code> - Maximum number of hardware counters that
can be active in query pools at one time.</p></li>
<li><p><code class="docutils literal notranslate">supports_work_group_collectives</code> - Is true if the device supports
work-group collective Mux builtins. A target not supporting work-group
collectives <strong>must</strong> set this to false.</p></li>
<li><p><code class="docutils literal notranslate">supports_generic_address_space</code> - Is true if the device supports the
Generic Address Space. A target not supporting the Generic Address Space
<strong>must</strong> set this to false.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">allocation_capabilities</code> <strong>must</strong> have at least one of
<code class="docutils literal notranslate">mux_allocation_capabilities_coherent_host</code> or
<code class="docutils literal notranslate">mux_allocation_capabilities_alloc_device</code> bits set.</p></li>
<li><p><code class="docutils literal notranslate">allocation_size</code> <strong>must</strong> be greater than <code class="docutils literal notranslate">0</code> if <code class="docutils literal notranslate">memory_size</code>
is greater than <code class="docutils literal notranslate">0</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocation_size</code> <strong>must</strong> be less than or equal to <code class="docutils literal notranslate">memory_size</code></p></li>
<li><p><code class="docutils literal notranslate">compute_units</code> <strong>must</strong> be greater than <code class="docutils literal notranslate">0</code>.</p></li>
<li><p>If the <code class="docutils literal notranslate">mux_source_capabilities_builtin_kernel</code> bit of
<code class="docutils literal notranslate">source_capabilities</code> is set, then <code class="docutils literal notranslate">builtin_kernel_declarations</code>
<strong>must</strong> point to a null-terminated C string of semicolon-separated
built-in kernel <em>declarations</em>.</p></li>
<li><p>Built-in kernel <em>declarations</em> <strong>must</strong> conform to the <a class="reference external" href="#built-in-kernel-declaration-syntax">built-in
kernel declaration syntax</a>,
defined below.</p></li>
</ul>
<div class="section" id="built-in-kernel-declaration-syntax">
<a class="header-link" href="#built-in-kernel-declaration-syntax"><h3 id="built-in-kernel-declaration-syntax">Built-In Kernel Declaration Syntax</h3><span class="material-icons">link</span></a>
<p>Built-in kernel <em>declarations</em> <strong>must</strong> be of the form
<code class="docutils literal notranslate">kernel_name(parameters)</code>. The declarations conform to the OpenCL 1.2
kernel declaration syntax with the following exceptions:</p>
<ol class="arabic simple">
<li><p>The leading <code class="docutils literal notranslate">__kernel</code> keyword <strong>must not</strong> be used</p></li>
<li><p>The return type (<code class="docutils literal notranslate">void</code>) <strong>must</strong> be omitted</p></li>
<li><p>Pointer parameters using <code class="docutils literal notranslate">[]</code> notation <strong>must not</strong> be used</p></li>
<li><p>Struct parameters and pointer-to-struct parameters <strong>must not</strong> be
used</p></li>
<li><p>Type and variable attributes (e.g., <code class="docutils literal notranslate">__attribute__*</code>) <strong>must not</strong>
be used</p></li>
<li><p>All whitespace <strong>must</strong> only be `` `` characters; other whitespace
characters (<code class="docutils literal notranslate">\t</code>, <code class="docutils literal notranslate">\n</code>, etc.) <strong>must not</strong> be used</p></li>
<li><p>The built-in kernel name including a trailing NUL character must not
exceed <code class="docutils literal notranslate">CL_NAME_VERSION_KHR</code> (64 characters).</p></li>
</ol>
<p>Also note that two OpenCL limitations are present for built-in kernel
parameter:</p>
<ol class="arabic simple">
<li><p>OpenCL kernels do not support pointer-to-pointer parameters</p></li>
<li><p>The OpenCL API ignores <code class="docutils literal notranslate">const</code> and <code class="docutils literal notranslate">volatile</code> qualifiers on value
parameters. These <strong>may</strong> or <strong>may not</strong> be reported. (The OpenCL C
compiler will not ignore the qualifiers.)</p></li>
</ol>
<p>This is an example of a valid list of built-in kernel declarations:</p>
<pre><code class="language-c">mux_device_info_s_ptr-&gt;builtin_kernel_declarations =
  "kernel1(global const int* in, global int* out);"
  "kernel2(read_only image3d_t in, read_write image2d_t out, float val);"
  "kernel3(local const float* restrict in, __global volatile float* out)";
};
</code>
</pre>
</div>
<div class="section" id="muxgetdeviceinfos">
<a class="header-link" href="#muxgetdeviceinfos"><h3 id="muxgetdeviceinfos">muxGetDeviceInfos</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxGetDeviceInfos()</code> calls into Mux to enumerate device for which
information is registered with Mux.</p>
<pre><code class="language-c">mux_result_t muxGetDeviceInfos(
    uint32_t device_types,
    uint64_t device_infos_length,
    mux_device_info_t *out_device_infos,
    uint64_t *out_device_infos_length);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device_types</code> - a bitfield of <code class="docutils literal notranslate">mux_device_type_e</code> specifying the
types of devices to retrieve the device information from,
<code class="docutils literal notranslate">mux_device_type_all</code> can be used to specify all devices.</p></li>
<li><p><code class="docutils literal notranslate">device_infos_length</code> - the length of <code class="docutils literal notranslate">out_device_infos</code>.</p></li>
<li><p><code class="docutils literal notranslate">out_device_infos</code> - an array of Mux devices information.</p></li>
<li><p><code class="docutils literal notranslate">out_device_infos_length</code> - the total number of devices for which
information was recorded in <code class="docutils literal notranslate">out_device_infos</code>.</p></li>
</ul>
<p><code class="docutils literal notranslate">muxGetDeviceInfos()</code> can be called in two configurations.</p>
<pre><code class="language-c">uint64_t device_infos_length = 0;
mux_result_t error =
    muxGetDeviceInfos(mux_device_type_all, 0, NULL, &amp;device_infos_length);
</code>
</pre>
<p>This first configuration sets <code class="docutils literal notranslate">device_infos_length</code> to 0,
<code class="docutils literal notranslate">out_device_infos</code> to NULL, and passes a valid pointer for
<code class="docutils literal notranslate">out_device_infos_length</code> - on success <code class="docutils literal notranslate">out_device_infos_length</code>
will contain the total number of devices for which information is
recorded in Mux.</p>
<pre><code class="language-c">mux_device_info_t *device_infos =
    malloc(sizeof(mux_device_info_t) * device_infos_length);
error = muxGetDeviceInfos(mux_device_type_all, device_infos_length,
                           device_infos, 0);
</code>
</pre>
<p>This second configuration sets <code class="docutils literal notranslate">device_infos_length</code> to a non-zero
number, <code class="docutils literal notranslate">out_device_infos</code> to a non-NULL pointer, and passes NULL for
<code class="docutils literal notranslate">out_device_infos_length</code> - on success <code class="docutils literal notranslate">out_device_infos</code> will
contain <code class="docutils literal notranslate">device_infos_length</code> number of valid Mux device information
entries to use.</p>
<p>The returned <code class="docutils literal notranslate">mux_device_info_t</code>s have static lifetimes, and <strong>must
not</strong> require any destruction logic.</p>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">device_types</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">device_infos_length</code> is 0 and <code class="docutils literal notranslate">out_device_infos</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">device_infos_length</code> is not 0 and <code class="docutils literal notranslate">out_device_infos</code> is NULL,
<code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned, all
<code class="docutils literal notranslate">out_device_infos</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetDeviceInfos()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxgetdeviceinfos-t-hook">
<a class="header-link" href="#muxgetdeviceinfos-t-hook"><h3 id="muxgetdeviceinfos-t-hook">muxGetDeviceInfos_t hook</h3><span class="material-icons">link</span></a>
<p>Related to <code class="docutils literal notranslate">muxGetDeviceInfos</code> is the device information hook, which
<strong>must</strong> be implemented by each of the target implementations in order
to support enumerating devices owned by that implementation. A function
signature for a target <code class="docutils literal notranslate">target</code> would look as follows:</p>
<pre><code class="language-c">mux_result_t targetGetDeviceInfos(
    uint32_t device_types,
    uint64_t device_infos_length,
    mux_device_info_t* out_device_infos,
    uint64_t* out_device_infos_length);
</code>
</pre>
<p>The arguments have a very similar meaning as the ones of
<code class="docutils literal notranslate">muxGetDeviceInfos</code>, with the difference that it only needs to handle
its own device list, it doesn’t know about other devices registered in
the system. The hook should support being called with a null
<code class="docutils literal notranslate">out_device_infos</code> argument to get the number of devices it wants to
register. It should also support being called with
<code class="docutils literal notranslate">device_infos_length</code> set to that number to populate the
<code class="docutils literal notranslate">out_device_infos</code> array.</p>
</div>
<div class="section" id="muxcreatedevices">
<a class="header-link" href="#muxcreatedevices"><h3 id="muxcreatedevices">muxCreateDevices</h3><span class="material-icons">link</span></a>
<pre><code class="language-c">struct mux_device_s {
  mux_id_t id;
  mux_device_info_t info;
};
</code>
</pre>
<p><code class="docutils literal notranslate">muxCreateDevices()</code> calls into Mux to create and initialize the list
of devices registered with Mux.</p>
<pre><code class="language-c">mux_result_t muxCreateDevices(
    uint64_t devices_length,
    mux_device_info_t *device_infos,
    mux_allocator_info_t allocator_info,
    mux_device_t *out_devices);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">devices_length</code> - the total number of devices to initialize, the
length of the <code class="docutils literal notranslate">device_infos</code> and <code class="docutils literal notranslate">out_devices</code> arrays.</p></li>
<li><p><code class="docutils literal notranslate">device_infos</code> - array of device information determining which
devices to create, the entries <strong>must</strong> have come from a
<code class="docutils literal notranslate">muxGetDeviceInfos()</code> call.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_devices</code> - the newly created devices.</p></li>
</ul>
<p>Example usage:</p>
<pre><code class="language-c">uint64_t chosen_devices_count = ...;
mux_device_info_t *chosen_device_infos = ...;
mux_allocator_info_t allocator = ...;
mux_device_t *devices = NULL;
error = muxCreateDevices(chosen_devices_count, chosen_device_infos,
                          allocator, devices);
</code>
</pre>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">devices_length</code> is greater than 0 and <code class="docutils literal notranslate">device_infos</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">devices_length</code> is greater than 0 and <code class="docutils literal notranslate">out_devices</code> is NULL,
<code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong> be returned.</p></li>
<li><p>If at least one of the <code class="docutils literal notranslate">device_infos</code> represents a device that is
not available for initialization (e.g. if it’s only a target for
cross-compilation), <code class="docutils literal notranslate">mux_error_feature_unsupported</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_devices</code> is <code class="docutils literal notranslate">NULL</code>, then <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned, all of
the <code class="docutils literal notranslate">out_devices</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetDeviceInfos()</code> <strong>shall not</strong> be considered
thread-safe.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">device_infos</code> did not originate from a call to
<code class="docutils literal notranslate">muxGetDeviceInfos()</code>, the behavior is undefined.</p></li>
<li><p>The <code class="docutils literal notranslate">device_infos</code> array can contain less elements than the one
provided by <code class="docutils literal notranslate">muxGetDeviceInfos()</code>, but their order <strong>must</strong> be
maintained. Otherwise the behavior is undefined.</p></li>
</ul>
</div>
<div class="section" id="muxcreatedevices-t-hook">
<a class="header-link" href="#muxcreatedevices-t-hook"><h3 id="muxcreatedevices-t-hook">muxCreateDevices_t hook</h3><span class="material-icons">link</span></a>
<p>Related to <code class="docutils literal notranslate">muxCreateDevices</code> is the device creation hook, which
<strong>must</strong> be implemented by each of the target implementations in order
to support creating devices owned by that implementation. A function
signature for a target <code class="docutils literal notranslate">target</code> would look as follows:</p>
<pre><code class="language-c">mux_result_t targetCreateDevices(
    uint64_t devices_length,
    mux_device_info_t* device_infos,
    mux_allocator_info_t allocator,
    mux_device_t* out_devices);
</code>
</pre>
<p>The arguments have the same meaning as the ones of <code class="docutils literal notranslate">muxCreateDevices</code>.
The hook should iterate over the <code class="docutils literal notranslate">device_infos</code> array, and create its
own device objects at the indices corresponding to info object entries
managed by that target. The hook can also return an error code to
signify failure.</p>
<p>The arguments have a very similar meaning as the ones of
<code class="docutils literal notranslate">muxCreateDevices</code>, with the difference that a hook only needs to
handle its own device list, it doesn’t know about other devices
registered in the system.</p>
<p>A device creation hook <strong>must</strong> not check for the errors described by
the <code class="docutils literal notranslate">muxCreateDevices</code> return code section as these are detected and
handled before the hook is called.</p>
</div>
<div class="section" id="muxdestroydevice">
<a class="header-link" href="#muxdestroydevice"><h3 id="muxdestroydevice">muxDestroyDevice</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroyDevice()</code> destroys a previously created <code class="docutils literal notranslate">mux_device_t</code>.
Note that <code class="docutils literal notranslate">muxDestroyDevice()</code> destroys a single device only - If
<code class="docutils literal notranslate">muxCreateDevices()</code> returned multiple devices, each has to be
destroyed individually.</p>
<pre><code class="language-c">void muxDestroyDevice(
    mux_device_t device,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - a device previously created by a call to
<code class="docutils literal notranslate">muxCreateDevices()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">device</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyDevice()</code> <strong>must</strong> be
the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateDevices()</code> that created <code class="docutils literal notranslate">device</code>.</p></li>
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyDevice()</code> with a given <code class="docutils literal notranslate">device</code> <strong>shall</strong> be
considered thread-safe.</p></li>
<li><p>All <code class="docutils literal notranslate">mux_queue_t</code>’s belonging to a given <code class="docutils literal notranslate">device</code> <strong>must not</strong>
be used once the call to <code class="docutils literal notranslate">muxDestroyDevice()</code> has completed.</p></li>
<li><p>All <code class="docutils literal notranslate">mux_command_buffer_t</code>’s dispatched to <code class="docutils literal notranslate">mux_queue_t</code>’s
that belong to a given <code class="docutils literal notranslate">device</code> <strong>must</strong> have completed before a
call to <code class="docutils literal notranslate">muxDestroyDevice()</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="executables">
<a class="header-link" href="#executables"><h2 id="executables">Executables</h2><span class="material-icons">link</span></a>
<p>Executables in Mux are created from a binary representation compatible with the
current device. Executables <strong>may</strong> contain multiple entry points.</p>
<p>A Mux executable will have one or more named kernels.</p>
<div class="section" id="muxcreateexecutable">
<a class="header-link" href="#muxcreateexecutable"><h3 id="muxcreateexecutable">muxCreateExecutable</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateExecutable()</code> creates an executable from a given binary.</p>
<pre><code class="language-c">mux_result_t muxCreateExecutable(
    mux_device_t device,
    const void* binary,
    uint64_t binary_length,
    mux_allocator_info_t allocator_info,
    mux_executable_t* out_executable);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device to create the executable with.</p></li>
<li><p><code class="docutils literal notranslate">binary</code> - an array containing the binary to load.</p></li>
<li><p><code class="docutils literal notranslate">binary_length</code> - the length, in bytes, of <code class="docutils literal notranslate">binary</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_executable</code> - the newly created executable.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">binary</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">binary_length</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_executable</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_executable</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateExecutable()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxdestroyexecutable">
<a class="header-link" href="#muxdestroyexecutable"><h3 id="muxdestroyexecutable">muxDestroyExecutable</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroyExecutable()</code> destroys a previously created
<code class="docutils literal notranslate">mux_executable_t</code>.</p>
<pre><code class="language-c">void muxDestroyExecutable(
    mux_device_t device,
    mux_executable_t executable,
    mux_allocator_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device the executable was created with.</p></li>
<li><p><code class="docutils literal notranslate">executable</code> - an executable previously created by a call to
<code class="docutils literal notranslate">muxCreateExecutable()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">executable</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyExecutable()</code> with a given <code class="docutils literal notranslate">executable</code>
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyExecutable()</code> <strong>must</strong>
be the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateExecutable()</code> that created <code class="docutils literal notranslate">executable</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">executable</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_executable_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code>, that was used in the creation of a
<code class="docutils literal notranslate">mux_executable_t</code> <strong>must not</strong> be destroyed before the executable
has been destroyed.</p></li>
<li><p>If the <code class="docutils literal notranslate">binary</code> that was used in the creation of a <code class="docutils literal notranslate">mux_executable_t</code> was
returned by <code class="docutils literal notranslate">compiler::Kernel::createSpecializedKernel</code>, the
<code class="docutils literal notranslate">compiler::Kernel</code> object <strong>must not</strong> be destroyed before the executable
has been destroyed.</p></li>
</ul>
</div>
</div>
<div class="section" id="descriptors">
<a class="header-link" href="#descriptors"><h2 id="descriptors">Descriptors</h2><span class="material-icons">link</span></a>
<p>Executables that run on a Mux device are passed data from the host via
<code class="docutils literal notranslate">mux_descriptor_info_t</code>’s. As the name suggests, descriptors specify
what the data for a given parameter is. When descriptors are passed to a
Mux device a copy is made of the data contained within, once the entry
point consuming the descriptors completes the storage can be reused or
freed.</p>
<pre><code class="language-c">struct mux_descriptor_info_s {
  uint32_t type;
  union {
    struct mux_descriptor_info_buffer_s buffer_descriptor;
    struct mux_descriptor_info_image_s image_descriptor;
    struct mux_descriptor_info_sampler_s sampler_descriptor;
    struct mux_descriptor_info_plain_old_data_s plain_old_data_descriptor;
    struct mux_descriptor_info_shared_local_buffer_s
        shared_local_buffer_descriptor;
    struct mux_descriptor_info_custom_buffer_s custom_buffer_descriptor;
  };
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">type</code> - the type of this descriptor, one of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code> - the description of the buffer.</p></li>
<li><p><code class="docutils literal notranslate">image_descriptor</code> - the description of the image.</p></li>
<li><p><code class="docutils literal notranslate">sampler_descriptor</code> - the description of the sampler.</p></li>
<li><p><code class="docutils literal notranslate">plain_old_data_descriptor</code> - the description of the plain old
data.</p></li>
<li><p><code class="docutils literal notranslate">shared_local_buffer_descriptor</code> - the description of the shared
local buffer.</p></li>
<li><p><code class="docutils literal notranslate">custom_buffer_descriptor</code> - the description of the custom buffer.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_buffer</code></p>
<ul>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code> <strong>must</strong> be initialized.</p></li>
<li><p><code class="docutils literal notranslate">image_descriptor</code>, <code class="docutils literal notranslate">sampler_descriptor</code>,
<code class="docutils literal notranslate">plain_old_data_descriptor</code>, <code class="docutils literal notranslate">shared_local_buffer_descriptor</code>,
and <code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_image</code></p>
<ul>
<li><p><code class="docutils literal notranslate">image_descriptor</code> <strong>must</strong> be initialized.</p></li>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code>, <code class="docutils literal notranslate">sampler_descriptor</code>,
<code class="docutils literal notranslate">plain_old_data_descriptor</code>, <code class="docutils literal notranslate">shared_local_buffer_descriptor</code>,
and <code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_sampler</code></p>
<ul>
<li><p><code class="docutils literal notranslate">sampler_descriptor</code> <strong>must</strong> be initialized.</p></li>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code>, <code class="docutils literal notranslate">image_descriptor</code>,
<code class="docutils literal notranslate">plain_old_data_descriptor</code>, <code class="docutils literal notranslate">shared_local_buffer_descriptor</code>,
and <code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_plain_old_data</code></p>
<ul>
<li><p><code class="docutils literal notranslate">plain_old_data_descriptor</code> <strong>must</strong> be initialized.</p></li>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code>, <code class="docutils literal notranslate">image_descriptor</code>,
<code class="docutils literal notranslate">sampler_descriptor</code>, <code class="docutils literal notranslate">shared_local_buffer_descriptor</code>, and
<code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_shared_local_buffer</code></p>
<ul>
<li><p><code class="docutils literal notranslate">shared_local_buffer_descriptor</code> <strong>must</strong> be initialized.</p></li>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code>, <code class="docutils literal notranslate">image_descriptor</code>,
<code class="docutils literal notranslate">sampler_descriptor</code>, <code class="docutils literal notranslate">plain_old_data_descriptor</code>, and
<code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_null_buffer</code></p>
<ul>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code>, <code class="docutils literal notranslate">image_descriptor</code>,
<code class="docutils literal notranslate">sampler_descriptor</code>, <code class="docutils literal notranslate">plain_old_data_descriptor</code>,
<code class="docutils literal notranslate">shared_local_buffer_descriptor</code>, and
<code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">type</code> is <code class="docutils literal notranslate">mux_descriptor_info_type_custom_buffer</code></p>
<ul>
<li><p><code class="docutils literal notranslate">custom_buffer_descriptor</code> <strong>must</strong> be initialized.</p></li>
<li><p><code class="docutils literal notranslate">buffer_descriptor</code>, <code class="docutils literal notranslate">image_descriptor</code>,
<code class="docutils literal notranslate">sampler_descriptor</code>, <code class="docutils literal notranslate">plain_old_data_descriptor</code>, and
<code class="docutils literal notranslate">shared_local_buffer_descriptor</code> <strong>must not</strong> be initialized.</p></li>
</ul>
</li>
</ul>
<div class="section" id="buffer-descriptors">
<a class="header-link" href="#buffer-descriptors"><h3 id="buffer-descriptors">Buffer Descriptors</h3><span class="material-icons">link</span></a>
<p>Buffer descriptors specify that a given <code class="docutils literal notranslate">mux_descriptor_info_t</code> is a
<code class="docutils literal notranslate">mux_descriptor_info_buffer_s</code>.</p>
<p>Buffer descriptors specify that the descriptor contains a
<code class="docutils literal notranslate">mux_buffer_t</code> for reading/writing on a device.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_buffer</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify a buffer descriptor.</p>
<pre><code class="language-c">struct mux_descriptor_info_buffer_s {
  mux_buffer_t buffer;
  uint64_t offset;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">buffer</code> - the buffer that this descriptor is <em>describing</em>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the offset into <code class="docutils literal notranslate">buffer</code> to begin indexing.</p></li>
</ul>
</div>
<div class="section" id="image-descriptors">
<a class="header-link" href="#image-descriptors"><h3 id="image-descriptors">Image Descriptors</h3><span class="material-icons">link</span></a>
<p>Image descriptors specify that a given <code class="docutils literal notranslate">mux_descriptor_info_t</code> is a
<code class="docutils literal notranslate">mux_descriptor_info_image_s</code>.</p>
<p>Image descriptors specify that the descriptor contains a <code class="docutils literal notranslate">mux_image_t</code>
for reading/writing on a device.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_image</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify an image descriptor.</p>
<pre><code class="language-c">struct mux_descriptor_info_image_s {
  mux_image_t image;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">image</code> - the image that this descriptor is <em>describing</em>.</p></li>
</ul>
</div>
<div class="section" id="sampler-descriptors">
<a class="header-link" href="#sampler-descriptors"><h3 id="sampler-descriptors">Sampler Descriptors</h3><span class="material-icons">link</span></a>
<p>Sampler descriptors specify that a given <code class="docutils literal notranslate">mux_descriptor_info_t</code> is a
<code class="docutils literal notranslate">mux_descriptor_info_sampler_s</code>.</p>
<p>Sampler descriptors specify that the descriptor contains a
<code class="docutils literal notranslate">mux_sampler_t</code> for using in conjunction with a <code class="docutils literal notranslate">mux_image_t</code> for
reading/writing on a device.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_sampler</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify a sampler descriptor.</p>
<pre><code class="language-c">struct mux_descriptor_info_sampler_s {
  mux_sampler_t sampler;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">sampler</code> - the sampler that this descriptor is <em>describing</em>.</p></li>
</ul>
</div>
<div class="section" id="plain-old-data-descriptors">
<a class="header-link" href="#plain-old-data-descriptors"><h3 id="plain-old-data-descriptors">Plain Old Data Descriptors</h3><span class="material-icons">link</span></a>
<p>Plain-old-data descriptors specify that a given
<code class="docutils literal notranslate">mux_descriptor_info_t</code> is a <code class="docutils literal notranslate">mux_descriptor_info_plain_old_data_s</code>.</p>
<p>Plain-old-data descriptors specify that the descriptor contains a C type
or struct that is being passed purely as data on a device.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_plain_old_data</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify a buffer descriptor.</p>
<pre><code class="language-c">struct mux_descriptor_info_plain_old_data_s {
  const void* data;
  size_t length;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">data</code> - the data that this descriptor is <em>describing</em>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the length (in bytes) of <code class="docutils literal notranslate">data</code>.</p></li>
</ul>
</div>
<div class="section" id="shared-local-buffer-descriptors">
<a class="header-link" href="#shared-local-buffer-descriptors"><h3 id="shared-local-buffer-descriptors">Shared Local Buffer Descriptors</h3><span class="material-icons">link</span></a>
<p>Shared local buffer descriptors specify that a given
<code class="docutils literal notranslate">mux_descriptor_info_t</code> is a
<code class="docutils literal notranslate">mux_descriptor_info_shared_local_buffer_s</code>.</p>
<p>Shared local buffer descriptors specify that the descriptor is
specifying that a buffer should be created solely for sharing data
between work-items in a workgroup.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_shared_local_buffer</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify a buffer descriptor.</p>
<pre><code class="language-c">struct mux_descriptor_info_shared_local_buffer_s {
  size_t size;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) of shared local memory being
requested.</p></li>
</ul>
</div>
<div class="section" id="null-descriptors">
<a class="header-link" href="#null-descriptors"><h3 id="null-descriptors">Null Descriptors</h3><span class="material-icons">link</span></a>
<p>Null descriptors specify that a given <code class="docutils literal notranslate">mux_descriptor_info_t</code>
specifies a NULL pointer.</p>
<p>Null descriptors specify that the descriptor is specifying that some
pointer is NULL.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_null_buffer</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify a null descriptor.</p>
</div>
<div class="section" id="custom-buffer-descriptors">
<a class="header-link" href="#custom-buffer-descriptors"><h3 id="custom-buffer-descriptors">Custom Buffer Descriptors</h3><span class="material-icons">link</span></a>
<p>Custom buffer descriptors specify that a given <code class="docutils literal notranslate">mux_descriptor_info_t</code>
is a <code class="docutils literal notranslate">mux_descriptor_info_custom_buffer_s</code>.</p>
<p>Custom buffer descriptors specify that the descriptor contains data to
enable targets to support additional information which <strong>may</strong> be used
to implement target specific extensions.</p>
<p>The <code class="docutils literal notranslate">mux_descriptor_info_type_custom_buffer</code> enumeration of
<code class="docutils literal notranslate">mux_descriptor_info_type_e</code> is used to specify a custom buffer
descriptor.</p>
<pre><code class="language-c">struct mux_descriptor_info_custom_buffer_s {
  void *data;
  size_t size;
  uint32_t address_space;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">data</code> - the optional pointer to arbitrary custom buffer data,
<strong>must</strong> be set when
<code class="docutils literal notranslate">mux_device_info_s::custom_buffer_capabilities</code> contains the
<code class="docutils literal notranslate">mux_custom_buffer_capabilities_data</code> flag.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the optional size in bytes of the memory pointed to by
<code class="docutils literal notranslate">data</code>, <strong>must</strong> be set when
<code class="docutils literal notranslate">mux_device_info_s::custom_buffer_capabilities</code> contains the
<code class="docutils literal notranslate">mux_custom_buffer_capabilities_data</code> flag.</p></li>
<li><p><code class="docutils literal notranslate">address_space</code> - the optional address space of the custom buffer,
<strong>must</strong> be set when
<code class="docutils literal notranslate">mux_device_info_s::custom_buffer_capabilities</code> contains the
<code class="docutils literal notranslate">mux_custom_buffer_capabilities_address_space</code> flag.</p></li>
</ul>
</div>
</div>
<div class="section" id="kernels">
<a class="header-link" href="#kernels"><h2 id="kernels">Kernels</h2><span class="material-icons">link</span></a>
<p>Kernels in Mux are created from a <code class="docutils literal notranslate">mux_executable_t</code>. Kernels
represent a single, named, entry point into an executable. Kernels
contain fields called <code class="docutils literal notranslate">preferred_local_size_x</code>,
<code class="docutils literal notranslate">preferred_local_size_y</code>, and <code class="docutils literal notranslate">preferred_local_size_z</code> which can be
used by the implementation to signal preferred defaults for when a kernel is
compiled.</p>
<pre><code class="language-c">struct mux_kernel_s {
  mux_id_t id;
  mux_device_t device;
  size_t preferred_local_size_x;
  size_t preferred_local_size_y;
  size_t preferred_local_size_z;
  size_t local_memory_size;
  size_t max_sub_group_count;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">id</code> - the ID of this kernel object.</p></li>
<li><p><code class="docutils literal notranslate">device</code> - the device this kernel object was created from</p></li>
<li><p><code class="docutils literal notranslate">preferred_local_size_x</code> - the preferred local size in the x
dimension for this kernel object</p></li>
<li><p><code class="docutils literal notranslate">preferred_local_size_y</code> - the preferred local size in the y
dimension for this kernel object</p></li>
<li><p><code class="docutils literal notranslate">preferred_local_size_z</code> - the preferred local size in the z
dimension for this kernel object</p></li>
<li><p><code class="docutils literal notranslate">local_memory_size</code> - the amount of local memory used by this
kernel object</p></li>
<li><p><code class="docutils literal notranslate">max_sub_group_count</code> - the maximum number of sub-groups this kernel can
support when enqueued.</p></li>
</ul>
<div class="section" id="muxcreatekernel">
<a class="header-link" href="#muxcreatekernel"><h3 id="muxcreatekernel">muxCreateKernel</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateKernel()</code> creates a kernel from a given Mux executable.</p>
<pre><code class="language-c">mux_result_t muxCreateKernel(
    mux_device_t device,
    mux_executable_t executable,
    const char* name,
    uint64_t name_length,
    mux_allocator_info_t allocator_info,
    mux_kernel_t* out_kernel);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device to create the kernel with.</p></li>
<li><p><code class="docutils literal notranslate">executable</code> - the <code class="docutils literal notranslate">mux_executable_t</code> to find our kernel within.</p></li>
<li><p><code class="docutils literal notranslate">name</code> - the name of the kernel-function to select from the
<code class="docutils literal notranslate">executable</code>.</p></li>
<li><p><code class="docutils literal notranslate">name_length</code> - the string length of <code class="docutils literal notranslate">name</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_kernel</code> - the newly created kernel.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">name</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If a kernel called <code class="docutils literal notranslate">name</code> was not found in <code class="docutils literal notranslate">executable</code>,
<code class="docutils literal notranslate">mux_error_missing_kernel</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">name_length</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_kernel</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_kernel</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateKernel()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxcreatebuiltinkernel">
<a class="header-link" href="#muxcreatebuiltinkernel"><h3 id="muxcreatebuiltinkernel">muxCreateBuiltInKernel</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateBuiltInKernel()</code> creates a kernel from a given built-in kernel name.</p>
<pre><code class="language-c">mux_result_t muxCreateBuiltInKernel(
    mux_device_t device,
    const char* name,
    uint64_t name_length,
    mux_allocator_info_t allocator_info,
    mux_kernel_t* out_kernel);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device to create the kernel with.</p></li>
<li><p><code class="docutils literal notranslate">name</code> - the name of the built-in kernel-function to select from the
<code class="docutils literal notranslate">device</code>.</p></li>
<li><p><code class="docutils literal notranslate">name_length</code> - the string length of <code class="docutils literal notranslate">name</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_kernel</code> - the newly created kernel.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">name</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If a built-in kernel called <code class="docutils literal notranslate">name</code> is not in
<code class="docutils literal notranslate">mux_device_info_s::builtin_kernel_declarations</code>, then
<code class="docutils literal notranslate">mux_error_missing_kernel</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">name_length</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_kernel</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_kernel</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateBuiltInKernel()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxquerysubgroupsizeforlocalsize">
<a class="header-link" href="#muxquerysubgroupsizeforlocalsize"><h3 id="muxquerysubgroupsizeforlocalsize">muxQuerySubGroupSizeForLocalSize</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxQuerySubGroupSizeForLocalSize</code> queries a <code class="docutils literal notranslate">mux_kernel_t</code> for the
sub-group size that would result from an enqueue of the kernel with the given
local size.</p>
<p>Entry point is optional and <strong>must</strong> return <code class="docutils literal notranslate">mux_error_feature_unsupported</code> if
it is not supported.</p>
<pre><code class="language-c">mux_result_t muxQuerySubGroupSizeForLocalSize(mux_kernel_t kernel,
                                              size_t local_size_x,
                                              size_t local_size_y,
                                              size_t local_size_z,
                                              size_t *out_sub_group_size);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">kernel</code> - the kernel to query the sub-group size for.</p></li>
<li><p><code class="docutils literal notranslate">local_size_x</code> - the local size in the x dimension of the potential enqueue.</p></li>
<li><p><code class="docutils literal notranslate">local_size_y</code> - the local size in the y dimension of the potential enqueue.</p></li>
<li><p><code class="docutils literal notranslate">local_size_z</code> - the local size in the z dimension of the potential enqueue.</p></li>
<li><p><code class="docutils literal notranslate">out_sub_group_size</code> - the sub-group size that would result from a kernel
enqueue with the specified local size.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">kernel</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">local_size_x</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">local_size_y</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">local_size_y</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_sub_group_size</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>If the device to which the kernel will be enqueued does not support
sub-groups i.e. <code class="docutils literal notranslate">kernel-&gt;device-&gt;info-&gt;max_sub_group_count == 0</code>,
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> <strong>must</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned, the value at
<code class="docutils literal notranslate">out_sub_group_size</code> <strong>must not</strong> be considered valid.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxQuerySubGroupSizeForLocalSize()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
<li><p>Enqueuing <code class="docutils literal notranslate">kernel</code> with the specified local size <strong>shall</strong> result in at
least one sub-group of the size returned in <code class="docutils literal notranslate">out_sub_group_size</code> and <strong>may</strong>
additionally result in exactly one sub-group of size less than the returned
when the local size is not evenly divisible by the sub-group size.</p></li>
</ul>
</div>
<div class="section" id="muxquerylocalsizeforsubgroupcount">
<a class="header-link" href="#muxquerylocalsizeforsubgroupcount"><h3 id="muxquerylocalsizeforsubgroupcount">muxQueryLocalSizeForSubGroupCount</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxQueryLocalSizeForSubGroupCount()</code> queries the local size that would
specified for an enqueue of the given kernel would result in the given number
of sub-groups.</p>
<p>Entry point is optional and <strong>must</strong> return <code class="docutils literal notranslate">mux_error_feature_unsupported</code> if
it is not supported.</p>
<pre><code class="language-c">mux_result_t muxQueryLocalSizeForSubGroupCount(mux_kernel_t kernel,
                                               size_t sub_group_count,
                                               size_t *out_local_size_x,
                                               size_t *out_local_size_y,
                                               size_t *out_local_size_z);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">kernel</code> - the kernel to query the local size for.</p></li>
<li><p><code class="docutils literal notranslate">sub_group_count</code> - the requested number of sub-groups for the kernel enqueue.</p></li>
<li><p><code class="docutils literal notranslate">out_local_size_x</code> - the local size in the x dimension that would result
in <code class="docutils literal notranslate">sub_group_count</code> sub-groups.</p></li>
<li><p><code class="docutils literal notranslate">out_local_size_y</code> - the local size in the y dimension that would result
in <code class="docutils literal notranslate">sub_group_count</code> sub-groups.</p></li>
<li><p><code class="docutils literal notranslate">out_local_size_z</code> - the local size in the z dimension that would result
in <code class="docutils literal notranslate">sub_group_count</code> sub-groups.</p></li>
</ul>
<p>The local size returned through the output <strong>must</strong> be 1 dimensional, that is
at least two of <code class="docutils literal notranslate">out_local_size_x</code>, <code class="docutils literal notranslate">out_local_size_y</code> and
<code class="docutils literal notranslate">out_local_size_z</code> must be 1. The local size <strong>must</strong> be exactly divisible by
the sub-group size for <code class="docutils literal notranslate">kernel</code> with returned local size with no remainder.
The local size returned may be zero, indicating no local size can support the
requested number of sub-groups.</p>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">kernel</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_local_size_x</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_local_size_y</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_local_size_z</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>If the device to which the kernel will be enqueued does not support
sub-groups i.e. <code class="docutils literal notranslate">kernel-&gt;device-&gt;info-&gt;max_sub_group_count == 0</code>,
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> <strong>must</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned, the values at
<code class="docutils literal notranslate">out_local_size_x</code>, <code class="docutils literal notranslate">out_local_size_y</code> and <code class="docutils literal notranslate">out_local_size_z</code> <strong>must
not</strong> be considered valid.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxQueryLocalSizeForSubGroupCount()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxquerywfvinfoforlocalsize">
<a class="header-link" href="#muxquerywfvinfoforlocalsize"><h3 id="muxquerywfvinfoforlocalsize">muxQueryWFVInfoForLocalSize</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxQueryWFVInfoForLocalSize</code> queries a <code class="docutils literal notranslate">mux_kernel_t</code> for the whole
function vectorization status and dimension work widths that would result from
an enqueue of the kernel with the given local size.</p>
<p>Entry point is optional and <strong>must</strong> return <code class="docutils literal notranslate">mux_error_feature_unsupported</code>
if it is not supported.</p>
<pre><code class="language-c">mux_result_t muxQueryWFVInfoForLocalSize(mux_kernel_t kernel,
                                         size_t local_size_x,
                                         size_t local_size_y,
                                         size_t local_size_z,
                                         mux_wfv_status_e *out_wfv_status,
                                         size_t *out_work_width_x,
                                         size_t *out_work_width_y,
                                         size_t *out_work_width_z);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">kernel</code> - the kernel to query the WFV info for.</p></li>
<li><p><code class="docutils literal notranslate">local_size_x</code> - the local size in the x dimension of the potential
enqueue.</p></li>
<li><p><code class="docutils literal notranslate">local_size_y</code> - the local size in the y dimension of the potential
enqueue.</p></li>
<li><p><code class="docutils literal notranslate">local_size_z</code> - the local size in the z dimension of the potential
enqueue.</p></li>
<li><p><code class="docutils literal notranslate">out_wfv_status</code> - the whole function vectorization status that would
result from a kernel enqueue with the specified local size (one of the
values in the enum <a class="reference internal" href="#mux-wfv-status-e">mux_wfv_status_e</a>).</p></li>
<li><p><code class="docutils literal notranslate">out_work_width_x</code> - the work width in the x dimension that would result
from a kernel enqueue with the specified local size.</p></li>
<li><p><code class="docutils literal notranslate">out_work_width_y</code> - the work width in the y dimension that would result
from a kernel enqueue with the specified local size.</p></li>
<li><p><code class="docutils literal notranslate">out_work_width_z</code> - the work width in the z dimension that would result
from a kernel enqueue with the specified local size.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">kernel</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">local_size_x</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">local_size_y</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">local_size_y</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_wfv_status</code> is NULL and any of <code class="docutils literal notranslate">out_work_width_x</code>,
<code class="docutils literal notranslate">out_work_width_y</code>, and <code class="docutils literal notranslate">out_work_width_z</code> are NULL,
<code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong> be returned.</p></li>
<li><p>If the device to which the kernel will be enqueued does not support whole
function vectorization <code class="docutils literal notranslate">mux_error_feature_unsupported</code> <strong>must</strong> be
returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned, the values at
<code class="docutils literal notranslate">out_wfv_status</code>, <code class="docutils literal notranslate">out_work_width_x</code>, <code class="docutils literal notranslate">out_work_width_y</code>, and
<code class="docutils literal notranslate">out_work_width_z</code> <strong>must not</strong> be considered valid.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxQueryWFVInfoForLocalSize()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
<li><p>Enqueueing <code class="docutils literal notranslate">kernel</code> with the specified local size <strong>shall</strong> result in the
number of work-items executing for each dimension in one invocation of the
kernel being equal to the dimension work widths returned in
<code class="docutils literal notranslate">out_work_width_x</code>, <code class="docutils literal notranslate">out_work_width_y</code>, and <code class="docutils literal notranslate">out_work_width_z</code>.</p></li>
</ul>
<div class="section" id="mux-wfv-status-e">
<a class="header-link" href="#mux-wfv-status-e"><h4 id="mux-wfv-status-e">mux_wfv_status_e</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">typedef enum mux_wfv_status_e {
  mux_wfv_status_none,
  mux_wfv_status_error,
  mux_wfv_status_success
} mux_wfv_status_e;
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_wfv_status_none</code> - whole function vectorization has not been
performed on the specified kernel.</p></li>
<li><p><code class="docutils literal notranslate">mux_wfv_status_error</code> - an error was encountered while trying to perform
perform whole function vectorization on the specified kernel.</p></li>
<li><p><code class="docutils literal notranslate">mux_wfv_status_success</code> - whole function vectorization has been
successfully performed on the specified kernel.</p></li>
</ul>
</div>
</div>
<div class="section" id="muxdestroykernel">
<a class="header-link" href="#muxdestroykernel"><h3 id="muxdestroykernel">muxDestroyKernel</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroyKernel()</code> destroys a previously created <code class="docutils literal notranslate">mux_kernel_t</code>.</p>
<pre><code class="language-c">void muxDestroyKernel(
    mux_device_t device,
    mux_kernel_t kernel,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device used to create the kernel.</p></li>
<li><p><code class="docutils literal notranslate">kernel</code> - a kernel previously created by a call to
<code class="docutils literal notranslate">muxCreateKernel()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">kernel</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyKernel()</code> with a given <code class="docutils literal notranslate">kernel</code> <strong>shall</strong> be
considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyKernel()</code> <strong>must</strong> be
the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateKernel()</code> that created <code class="docutils literal notranslate">kernel</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">kernel</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_kernel_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_executable_t</code> used in the creation of a <code class="docutils literal notranslate">mux_kernel_t</code>
<strong>must not</strong> be destroyed before the kernel has been destroyed.</p></li>
<li><p>The <code class="docutils literal notranslate">mux_device_t</code>, that was used in the creation of a
<code class="docutils literal notranslate">mux_kernel_t</code> <strong>must not</strong> be destroyed before the kernel has been
destroyed.</p></li>
<li><p>The <code class="docutils literal notranslate">preferred_local_size_x</code> field of <code class="docutils literal notranslate">mux_kernel_t</code> <strong>must</strong> be
at least 1.</p></li>
<li><p>The <code class="docutils literal notranslate">preferred_local_size_y</code> field of <code class="docutils literal notranslate">mux_kernel_t</code> <strong>must</strong> be
at least 1.</p></li>
<li><p>The <code class="docutils literal notranslate">preferred_local_size_z</code> field of <code class="docutils literal notranslate">mux_kernel_t</code> <strong>must</strong> be
at least 1.</p></li>
<li><p>The <code class="docutils literal notranslate">preferred_local_size_x</code> field of <code class="docutils literal notranslate">mux_kernel_t</code> <strong>must not</strong>
exceed the value of the <code class="docutils literal notranslate">max_work_group_size_x</code> field of the
<code class="docutils literal notranslate">mux_device_t</code> that was used to create the <code class="docutils literal notranslate">mux_kernel_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">preferred_local_size_y</code> field of <code class="docutils literal notranslate">mux_kernel_t</code> <strong>must not</strong>
exceed the value of the <code class="docutils literal notranslate">max_work_group_size_y</code> field of the
<code class="docutils literal notranslate">mux_device_t</code> that was used to create the <code class="docutils literal notranslate">mux_kernel_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">preferred_local_size_z</code> field of <code class="docutils literal notranslate">mux_kernel_t</code> <strong>must not</strong>
exceed the value of the <code class="docutils literal notranslate">max_work_group_size_z</code> field of the
<code class="docutils literal notranslate">mux_device_t</code> that was used to create the <code class="docutils literal notranslate">mux_kernel_t</code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="memory">
<a class="header-link" href="#memory"><h2 id="memory">Memory</h2><span class="material-icons">link</span></a>
<p>Memory in Mux represents physical memory allocations that are accessible
on a device.</p>
<pre><code class="language-c">struct mux_memory_s {
  uint64_t size;
  uint32_t properties;
  uint64_t handle;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) that this memory has allocated to it.</p></li>
<li><p><code class="docutils literal notranslate">properties</code> - the memory properties of the allocated device
memory.</p></li>
<li><p><code class="docutils literal notranslate">handle</code> - a handle to the allocated memory. For memory objects
with the <code class="docutils literal notranslate">mux_memory_property_host_visible</code> property this <strong>must</strong>
be a host accessible pointer.</p></li>
</ul>
<div class="section" id="muxallocatememory">
<a class="header-link" href="#muxallocatememory"><h3 id="muxallocatememory">muxAllocateMemory</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxAllocateMemory()</code> allocates some physical device memory on the
given Mux device.</p>
<pre><code class="language-c">mux_result_t muxAllocateMemory(
    mux_device_t device,
    size_t size,
    uint32_t heap,
    uint32_t memory_properties,
    mux_allocation_type_e allocation_type,
    uint32_t alignment,
    mux_allocator_info_t allocator_info,
    mux_memory_t* out_memory);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to allocate this memory for.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size in bytes of memory to allocate.</p></li>
<li><p><code class="docutils literal notranslate">heap</code> - value of a single set bit in the
<code class="docutils literal notranslate">mux_memory_requirements_s::supported_heaps</code> bitfield of the buffer
or image the device memory is being allocated for.</p></li>
<li><p><code class="docutils literal notranslate">memory_properties</code> - bitfield of memory properties this allocation
should support:</p>
<ul>
<li><p><code class="docutils literal notranslate">mux_memory_property_device_local</code> - Memory is visible only on
the device and can not be mapped. Must not be used in combination
with <code class="docutils literal notranslate">mux_memory_property_host_visible</code>,
<code class="docutils literal notranslate">mux_memory_property_host_coherent</code>, or
<code class="docutils literal notranslate">mux_memory_property_host_cached</code>.</p></li>
<li><p><code class="docutils literal notranslate">mux_memory_property_host_visible</code> - Memory is visible on host
and device, can be mapped using <code class="docutils literal notranslate">muxMapMemory()</code>. Can be used
with <code class="docutils literal notranslate">mux_memory_property_host_coherent</code> or
<code class="docutils literal notranslate">mux_memory_property_host_cached</code>.</p></li>
<li><p><code class="docutils literal notranslate">mux_memory_property_host_coherent</code> - Memory caches are coherent
between host and device. No explicit synchronization is required.
Can be used with <code class="docutils literal notranslate">mux_memory_property_host_visible</code>, is mutually
exclusive with <code class="docutils literal notranslate">mux_memory_property_host_cached</code>.</p></li>
<li><p><code class="docutils literal notranslate">mux_memory_property_host_cached</code> - Memory caches are not
coherent between host and device. Explicit synchronization is
required, using <code class="docutils literal notranslate">muxMapMemory()</code> and <code class="docutils literal notranslate">muxUnmapMemory()</code>,
before updates are visible on host or device. Can be used with
<code class="docutils literal notranslate">mux_memory_property_host_visible</code>, is mutually exclusive with
<code class="docutils literal notranslate">mux_memory_property_host_coherent</code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate">allocation_type</code> - the type of allocation.</p>
<ul>
<li><p><code class="docutils literal notranslate">mux_allocation_type_alloc_host</code> - Allocate pinned memory
visible on both host and device. Used in combination with
<code class="docutils literal notranslate">mux_memory_property_host_coherent</code> or
<code class="docutils literal notranslate">mux_memory_property_host_cached</code>.</p></li>
<li><p><code class="docutils literal notranslate">mux_allocation_type_alloc_device</code> - Allocate device memory. Can
be used with <code class="docutils literal notranslate">mux_memory_property_device_local</code> or
<code class="docutils literal notranslate">mux_memory_property_host_visible</code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate">alignment</code> - minimum alignment in bytes to allocate to, may be
<code class="docutils literal notranslate">0</code> to indicate no alignment requirement.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_memory</code> - the created memory, or uninitialized if an error
occurred.</p></li>
</ul>
<blockquote>
<div><p>Note that <code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be used for any allocations
required for the host-side implementation of this API entry point.
There is no requirement for it to be used for the allocation of
physical device memory.</p>
</div></blockquote>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">heap</code> is 0 <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">memory_properties</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">alignment</code> is not <code class="docutils literal notranslate">0</code> and not a power of two
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_memory</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_memory</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxAllocateMemory()</code> <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The value of <code class="docutils literal notranslate">size</code> <strong>must not</strong> exceed the <code class="docutils literal notranslate">allocation_size</code>
member of <code class="docutils literal notranslate">device</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">heap</code> is 1 a successful allocation <strong>must</strong> occur, assuming
other valid usage conditions are met.</p></li>
<li><p><code class="docutils literal notranslate">memory_properties</code> <strong>must not</strong> contain any set bits that are not
specified in <code class="docutils literal notranslate">mux_memory_property_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocation_type</code> <strong>must</strong> be one of the allocation types specified
in <code class="docutils literal notranslate">mux_allocation_type_e</code>.</p></li>
<li><p>If the <code class="docutils literal notranslate">allocation_capabilities</code> member of <code class="docutils literal notranslate">device</code> does not have
the <code class="docutils literal notranslate">mux_allocation_capabilities_coherent_host</code> bit set,
<code class="docutils literal notranslate">allocation_type</code> <strong>must not</strong> be
<code class="docutils literal notranslate">mux_allocation_type_alloc_host</code>.</p></li>
<li><p>If the <code class="docutils literal notranslate">allocation_capabilities</code> member of <code class="docutils literal notranslate">device</code> does not have
the <code class="docutils literal notranslate">mux_allocation_capabilities_alloc_device</code> bit set,
<code class="docutils literal notranslate">allocation_type</code> <strong>must not</strong> be
<code class="docutils literal notranslate">mux_allocation_type_alloc_device</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcreatememoryfromhost">
<a class="header-link" href="#muxcreatememoryfromhost"><h3 id="muxcreatememoryfromhost">muxCreateMemoryFromHost</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateMemoryFromHost()</code> assigns Mux device visible memory from
pre-allocated host side memory. The device visible memory assigned is
cache coherent with the host allocation, therefore the <code class="docutils literal notranslate">properties</code>
member of the returned <code class="docutils literal notranslate">mux_memory_t</code> object <strong>must</strong> be set to
<code class="docutils literal notranslate">mux_memory_property_host_visible</code> and
<code class="docutils literal notranslate">mux_memory_property_host_coherent</code>.</p>
<p><code class="docutils literal notranslate">muxFreeMemory()</code> should be used to release the created
<code class="docutils literal notranslate">mux_memory_t</code> object at the end of its lifetime, but will not
deallocate the underlying host memory.</p>
<p>Mapping the created <code class="docutils literal notranslate">mux_memory_t</code> object with <code class="docutils literal notranslate">muxMapMemory()</code>
<strong>must</strong> return a pointer in <code class="docutils literal notranslate">out_data</code> based on the <code class="docutils literal notranslate">host_pointer</code>
argument used to create the memory object.</p>
<p>Entry point is optional as it requires device support for
<code class="docutils literal notranslate">mux_allocation_capabilities_cached_host</code> and <strong>must</strong> return
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> if this is not the case.</p>
<pre><code class="language-c">mux_result_t muxCreateMemoryFromHost(
    mux_device_t device,
    size_t size,
    void* host_pointer,
    mux_allocator_info_t allocator_info,
    mux_memory_t* out_memory);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to create this memory for.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size in bytes of allocated memory.</p></li>
<li><p><code class="docutils literal notranslate">host_pointer</code> - pointer to pre-allocated host addressable memory,
<strong>must not</strong> be NULL.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_memory</code> - the created memory, or uninitialized if an error
occurred.</p></li>
</ul>
<blockquote>
<div><p>Note that <code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be used for any allocations
required for the host-side implementation of this API entry point.
There is no requirement for it to be used for the allocation of
physical device memory.</p>
</div></blockquote>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">device</code> does not report
<code class="docutils literal notranslate">mux_allocation_capabilities_cached_host</code> in
<code class="docutils literal notranslate">mux_device_info_s::allocation_capabilities</code>,
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> must be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">memory_properties</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">host_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_memory</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_memory</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateMemoryFromHost()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
<li><p>The value of <code class="docutils literal notranslate">size</code> <strong>must not</strong> exceed the <code class="docutils literal notranslate">allocation_size</code>
member of <code class="docutils literal notranslate">device</code>.</p></li>
</ul>
</div>
<div class="section" id="muxfreememory">
<a class="header-link" href="#muxfreememory"><h3 id="muxfreememory">muxFreeMemory</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxFreeMemory()</code> frees a previously allocated memory object from a
given Mux device. If <code class="docutils literal notranslate">memory</code> was created by a call to
<code class="docutils literal notranslate">muxAllocateMemory()</code> then the underlying memory <strong>may</strong> be
deallocated. Otherwise, if <code class="docutils literal notranslate">memory</code> was created by a call to
<code class="docutils literal notranslate">muxCreateMemoryFromHost()</code> then the underlying host memory <strong>must
not</strong> be deallocated.</p>
<pre><code class="language-c">void muxFreeMemory(
    mux_device_t device,
    mux_memory_t memory,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to free memory for.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> - a memory object previously created by a call to
<code class="docutils literal notranslate">muxAllocateMemory()</code> or <code class="docutils literal notranslate">muxCreateMemoryFromHost()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">memory</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxFreeMemory()</code> with a given <code class="docutils literal notranslate">memory</code> <strong>shall</strong> be
considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">device</code> passed to <code class="docutils literal notranslate">muxFreeMemory()</code> <strong>must</strong> be the same
<code class="docutils literal notranslate">mux_device_t</code> as was used in the call to <code class="docutils literal notranslate">muxAllocateMemory()</code>
or <code class="docutils literal notranslate">muxCreateMemoryFromHost()</code> that created <code class="docutils literal notranslate">memory</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxFreeMemory()</code> <strong>must</strong> be the
same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxAllocateMemory()</code> or <code class="docutils literal notranslate">muxCreateMemoryFromHost()</code> that created
<code class="docutils literal notranslate">memory</code>.</p></li>
<li><p><code class="docutils literal notranslate">muxFreeMemory()</code> <strong>must not</strong> be called on a <code class="docutils literal notranslate">mux_memory_t</code> that
is currently mapped via <code class="docutils literal notranslate">muxMapMemory()</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxmapmemory">
<a class="header-link" href="#muxmapmemory"><h3 id="muxmapmemory">muxMapMemory</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxMapMemory()</code> maps a <code class="docutils literal notranslate">mux_memory_t</code> to a host accessible address.
Use <code class="docutils literal notranslate">muxFlushMappedMemoryToDevice()</code> and
<code class="docutils literal notranslate">muxFlushMappedMemoryFromDevice()</code> to explicitly synchronize mapped
memory.</p>
<pre><code class="language-c">mux_result_t muxMapMemory(
    mux_device_t device,
    mux_memory_t memory,
    uint64_t offset,
    uint64_t size,
    void** out_data);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to map memory with.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> - the <code class="docutils literal notranslate">mux_memory_t</code> to map.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the offset (in bytes) into the <code class="docutils literal notranslate">memory</code> to map.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) of the <code class="docutils literal notranslate">memory</code> to map.</p></li>
<li><p><code class="docutils literal notranslate">out_data</code> - the host accessible address.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">offset</code> is greater than the size of <code class="docutils literal notranslate">memory</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">memory</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">offset</code> plus <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">memory</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">flags</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_data</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">mux_memory_property_device_local</code> is set in
<code class="docutils literal notranslate">memory-&gt;properties</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_data</code> <strong>must not</strong> be used, and the <code class="docutils literal notranslate">mux_memory_t</code> <strong>shall
not</strong> be mapped.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxMapMemory()</code> <strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> <strong>must</strong> not already be an object mapped with
<code class="docutils literal notranslate">muxMapMemory</code>.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> <strong>must</strong> have property
<code class="docutils literal notranslate">mux_memory_property_host_visible</code> set.</p></li>
</ul>
</div>
<div class="section" id="muxflushmappedmemorytodevice">
<a class="header-link" href="#muxflushmappedmemorytodevice"><h3 id="muxflushmappedmemorytodevice">muxFlushMappedMemoryToDevice</h3><span class="material-icons">link</span></a>
<p>Explicitly update device memory with data residing in host memory.</p>
<p><code class="docutils literal notranslate">muxFlushMappedMemoryToDevice</code> is intended to be used with
<code class="docutils literal notranslate">mux_memory_t</code>’s allocated with the
<code class="docutils literal notranslate">mux_memory_property_host_cached</code> flag set. It updates device memory
with the content currently residing in host memory.</p>
<pre><code class="language-c">mux_result_t muxFlushMappedMemoryToDevice(
    mux_device_t device,
    mux_memory_t memory,
    uint64_t offset,
    uint64_t size);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - The device where the memory is allocated.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> - The device memory to be flushed.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - The offset in bytes into the device memory to begin the
range.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - The size in bytes of the range to flush.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> but returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">device</code> is not a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> is not a valid <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> combined with <code class="docutils literal notranslate">size</code> is greater than <code class="docutils literal notranslate">memory</code> size.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>shall</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">memory</code> <strong>must</strong> be previously mapped using <code class="docutils literal notranslate">muxMapMemory()</code> or
have been created using <code class="docutils literal notranslate">muxCreateMemoryFromHost()</code>.</p></li>
<li><p>Flushing <code class="docutils literal notranslate">memory</code> with the <code class="docutils literal notranslate">mux_memory_property_host_coherent</code>
flag <strong>must</strong> return <code class="docutils literal notranslate">mux_success</code>, as cache coherency makes
flushing a nop.</p></li>
</ul>
</div>
<div class="section" id="muxflushmappedmemoryfromdevice">
<a class="header-link" href="#muxflushmappedmemoryfromdevice"><h3 id="muxflushmappedmemoryfromdevice">muxFlushMappedMemoryFromDevice</h3><span class="material-icons">link</span></a>
<p>Explicitly update host memory with data residing in device memory.</p>
<p><code class="docutils literal notranslate">muxFlushMappedMemoryFromDevice</code> is intended to be used with
<code class="docutils literal notranslate">mux_memory_t</code>’s allocated with the
<code class="docutils literal notranslate">mux_memory_property_host_cached</code> flag set. It updates host memory
with the content currently residing in device memory.</p>
<pre><code class="language-c">mux_result_t muxFlushMappedMemoryFromDevice(
    mux_device_t device,
    mux_memory_t memory,
    uint64_t offset,
    uint64_t size);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - The device where the memory is allocated.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> - The device memory to be flushed.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - The offset in bytes into the device memory to begin the
range.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - The size in bytes of the range to flush.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">device</code> is not a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> is not a valid <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> combined with <code class="docutils literal notranslate">size</code> is greater than <code class="docutils literal notranslate">memory</code> size.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>shall</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">memory</code> <strong>must</strong> be previously mapped using <code class="docutils literal notranslate">muxMapMemory()</code> or
have been created using <code class="docutils literal notranslate">muxCreateMemoryFromHost()</code>.</p></li>
</ul>
</div>
<div class="section" id="muxunmapmemory">
<a class="header-link" href="#muxunmapmemory"><h3 id="muxunmapmemory">muxUnmapMemory</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxUnmapMemory()</code> invalidates the host pointer returned from
<code class="docutils literal notranslate">muxMapMemory()</code> meaning <code class="docutils literal notranslate">mux_memory_t</code> is no longer addressable
from the host.</p>
<pre><code class="language-c">mux_result_t muxUnmapMemory(
    mux_device_t device,
    mux_memory_t memory);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to unmap memory with.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> - the <code class="docutils literal notranslate">mux_memory_t</code> to unmap.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxUnmapMemory()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code>, that was used in the creation of the
<code class="docutils literal notranslate">mux_memory_t</code>, <strong>must not</strong> be destroyed before the memory has
been destroyed.</p></li>
</ul>
</div>
</div>
<div class="section" id="buffers">
<a class="header-link" href="#buffers"><h2 id="buffers">Buffers</h2><span class="material-icons">link</span></a>
<p>Buffers in Mux are a C-style array on a device.</p>
<div class="section" id="muxcreatebuffer">
<a class="header-link" href="#muxcreatebuffer"><h3 id="muxcreatebuffer">muxCreateBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateBuffer()</code> creates a buffer from a given Mux device.</p>
<pre><code class="language-c">mux_result_t muxCreateBuffer(
    mux_device_t device,
    size_t size,
    mux_allocator_info_t allocator_info,
    mux_buffer_t* out_buffer);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to create this buffer with.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) of this buffer.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_buffer</code> - the newly created buffer.</p></li>
</ul>
<blockquote>
<div><p>Note that <code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be used for any allocations
required for the host-side implementation of this API entry point.
There is no requirement for it to be used for the allocation of
physical device memory.</p>
</div></blockquote>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_buffer</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_buffer</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateBuffer()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxdestroybuffer">
<a class="header-link" href="#muxdestroybuffer"><h3 id="muxdestroybuffer">muxDestroyBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroyBuffer()</code> destroys a buffer using a given Mux device.</p>
<pre><code class="language-c">void muxDestroyBuffer(
    mux_device_t device,
    mux_buffer_t buffer,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to destroy this buffer with.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">buffer</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyBuffer()</code> with a given <code class="docutils literal notranslate">buffer</code> <strong>shall</strong> be
considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">device</code> passed to <code class="docutils literal notranslate">muxDestroyBuffer()</code> <strong>must</strong> be the same
<code class="docutils literal notranslate">mux_device_t</code> as was used in the call to <code class="docutils literal notranslate">muxCreateBuffer()</code>
that created <code class="docutils literal notranslate">buffer</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyBuffer()</code> <strong>must</strong> be
the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that created <code class="docutils literal notranslate">buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_buffer_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxbindbuffermemory">
<a class="header-link" href="#muxbindbuffermemory"><h3 id="muxbindbuffermemory">muxBindBufferMemory</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxBindBufferMemory()</code> binds a <code class="docutils literal notranslate">mux_buffer_t</code> to a <code class="docutils literal notranslate">mux_memory_t</code>
memory location using a given Mux device.</p>
<pre><code class="language-c">mux_result_t muxBindBufferMemory(
    mux_device_t device,
    mux_memory_t memory,
    mux_buffer_t buffer,
    uint64_t offset);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to bind the memory and buffer with.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> - a memory previously created by a call to
<code class="docutils literal notranslate">muxAllocateMemory()</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the offset (in bytes) into <code class="docutils literal notranslate">memory</code> to bind <code class="docutils literal notranslate">buffer</code>
to.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">offset</code> would specify a byte offset greater than the size of
<code class="docutils literal notranslate">memory</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">buffer</code>’s size is greater than the size of <code class="docutils literal notranslate">memory</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">buffer</code>’s size plus <code class="docutils literal notranslate">offset</code> is greater than the size of
<code class="docutils literal notranslate">memory</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">memory</code> is not a valid <code class="docutils literal notranslate">mux_memory_t</code> instance,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">buffer</code> <strong>must</strong> be re-bound to a <code class="docutils literal notranslate">mux_memory_t</code> successfully
before being used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxBindBufferMemory()</code> for a given <code class="docutils literal notranslate">memory</code> and a given
<code class="docutils literal notranslate">buffer</code>, <strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">mux_buffer_t</code>’s are allowed to alias the same memory, but <strong>must
not</strong> be being executed upon within a <code class="docutils literal notranslate">mux_queue_t</code> simultaneously.</p></li>
<li><p><code class="docutils literal notranslate">mux_buffer_t</code> <strong>may</strong> be re-bound (via a call to
<code class="docutils literal notranslate">muxBindBufferMemory()</code>) any number of times.</p></li>
<li><p>A <code class="docutils literal notranslate">mux_memory_t</code> that is currently being bound to a
<code class="docutils literal notranslate">mux_buffer_t</code>, <strong>must not</strong> be destroyed before the buffer has
been destroyed.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code>, that was used in the creation of the
<code class="docutils literal notranslate">mux_buffer_t</code>, <strong>must not</strong> be destroyed before the buffer has
been destroyed.</p></li>
</ul>
</div>
</div>
<div class="section" id="images">
<a class="header-link" href="#images"><h2 id="images">Images</h2><span class="material-icons">link</span></a>
<p>Images are represented by the <code class="docutils literal notranslate">mux_image_t</code> handle which contains
metadata about images. <code class="docutils literal notranslate">mux_image_t</code> objects do not hold ownership of
physical device memory, this delegated to <code class="docutils literal notranslate">mux_memory_t</code> objects.
Images are acted upon by a number of entry points as defined below.</p>
<p>A Mux implementation <strong>must</strong> populate the following attributes of the
<code class="docutils literal notranslate">mux_image_s</code> structure so that the application can use this
information to correctly use <code class="docutils literal notranslate">mux_image_t</code> objects.</p>
<pre><code class="language-c">struct mux_image_s {
  mux_memory_requirements_s memory_requirements;
  mux_image_type_e type;
  mux_image_format_e format;
  uint32_t pixel_size;
  mux_extent_3d_t size;
  uint32_t array_layers;
  uint64_t row_size;
  uint64_t slice_size;
  mux_image_tiling_e tiling;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">memory_requirements</code> - the device memory requirements for the
image.</p></li>
<li><p><code class="docutils literal notranslate">type</code> - the type of this image.</p></li>
<li><p><code class="docutils literal notranslate">format</code> - the pixel format of this image.</p></li>
<li><p><code class="docutils literal notranslate">pixel_size</code> - the size in bytes of a single pixel.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the width, height, depth of this image.</p></li>
<li><p><code class="docutils literal notranslate">array_layers</code> - the number of array layers in the image.</p></li>
<li><p><code class="docutils literal notranslate">row_size</code> - the size in bytes of an image row.</p></li>
<li><p><code class="docutils literal notranslate">slice_size</code> - the size in bytes of an image slice.</p></li>
<li><p><code class="docutils literal notranslate">tiling</code> - the current image tiling mode of this image.</p></li>
</ul>
<div class="section" id="muxcreateimage">
<a class="header-link" href="#muxcreateimage"><h3 id="muxcreateimage">muxCreateImage</h3><span class="material-icons">link</span></a>
<p>The <code class="docutils literal notranslate">muxCreateImage()</code> function is used to create a <code class="docutils literal notranslate">mux_image_t</code>
object, it describes the images type and dimensions. This does not
allocate physical device memory to store the image data, to do this
<code class="docutils literal notranslate">muxAllocateMemory()</code> must be used, the <code class="docutils literal notranslate">mux_memory_t</code> can then be
bound to the <code class="docutils literal notranslate">mux_image_t</code> using <code class="docutils literal notranslate">muxBindImageMemory()</code>.</p>
<pre><code class="language-c">mux_result_t muxCreateImage(
    mux_device_t device,
    mux_image_type_e type,
    mux_image_format_e format,
    uint32_t width,
    uint32_t height,
    uint32_t depth,
    uint32_t array_layers,
    uint64_t row_size,
    uint64_t slice_size,
    mux_allocator_info_t allocator_info,
    mux_image_t* out_image);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - The device where the image will be used.</p></li>
<li><p><code class="docutils literal notranslate">type</code> - The type of image to create, one of <code class="docutils literal notranslate">mux_image_type_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">format</code> - The pixel data format of the image to create, one of
<code class="docutils literal notranslate">mux_image_format_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">width</code> - The width of the image in pixels, must be greater than
one and less than max width.</p></li>
<li><p><code class="docutils literal notranslate">height</code> - The height of the image in pixels, must be zero for 1d
images, must be greater than one and less than max height for 2d and
3d images.</p></li>
<li><p><code class="docutils literal notranslate">depth</code> - The depth of the image in pixels, must be zero for 1d and
2d images, must be greater than one and less than max depth for 3d
images.</p></li>
<li><p><code class="docutils literal notranslate">array_layers</code> - The number of layers in an image array, must be
<code class="docutils literal notranslate">0</code> for non image arrays, must be less than max array layers for
image arrays.</p></li>
<li><p><code class="docutils literal notranslate">row_size</code> - The size of an image row in bytes.</p></li>
<li><p><code class="docutils literal notranslate">slice_size</code> - The size on an image slice in bytes.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_image</code> - The created image, or uninitialized if an error
occurred.</p></li>
</ul>
<blockquote>
<div><p>Note that <code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be used for any allocations
required for the host-side implementation of this API entry point.
There is no requirement for it to be used for the allocation of
physical device memory.</p>
</div></blockquote>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">device</code> is <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>shall</strong> be returned.</p></li>
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>shall</strong> be returned if any of the
following conditions are met</p>
<ul>
<li><p>For <code class="docutils literal notranslate">image_type</code> of <code class="docutils literal notranslate">mux_image_type_1d</code></p>
<ul>
<li><p>If <code class="docutils literal notranslate">width</code> is equal to <code class="docutils literal notranslate">0</code> or is greater than
<code class="docutils literal notranslate">max_image_dimension_1d</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">height</code> is not equal to <code class="docutils literal notranslate">1</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">depth</code> is not equal to <code class="docutils literal notranslate">1</code>.</p></li>
</ul>
</li>
<li><p>For <code class="docutils literal notranslate">image_type</code> of <code class="docutils literal notranslate">mux_image_type_2d</code></p>
<ul>
<li><p>If <code class="docutils literal notranslate">width</code> is equal to <code class="docutils literal notranslate">0</code> or is greater than
<code class="docutils literal notranslate">max_image_dimension_2d</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">height</code> is equal to <code class="docutils literal notranslate">0</code> or is greater than
<code class="docutils literal notranslate">max_image_dimension_2d</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">depth</code> is not equal to <code class="docutils literal notranslate">1</code>.</p></li>
</ul>
</li>
<li><p>For <code class="docutils literal notranslate">image_type</code> of <code class="docutils literal notranslate">mux_image_type_3d</code></p>
<ul>
<li><p>If <code class="docutils literal notranslate">width</code> is equal to <code class="docutils literal notranslate">0</code> or is greater than
<code class="docutils literal notranslate">max_image_dimension_3d</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">height</code> is equal to <code class="docutils literal notranslate">0</code> or is greater than
<code class="docutils literal notranslate">max_image_dimension_3d</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">depth</code> is equal to <code class="docutils literal notranslate">0</code> or is greater than
<code class="docutils literal notranslate">max_image_dimension_3d</code>.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">array_layers</code> is greater than
<code class="docutils literal notranslate">mux_device_s::max_image_array_layers</code>.</p></li>
<li><p>If <code class="docutils literal notranslate">out_image</code> is <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>shall</strong> be returned.</p></li>
<li><p>If an allocation failed <code class="docutils literal notranslate">mux_error_out_of_memory</code> <strong>shall</strong> be
returned.</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateImage()</code> for a given <code class="docutils literal notranslate">device</code>, <strong>shall</strong> be
considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">mux_image_t</code>’s are allowed to alias the same memory, but the
aliased <code class="docutils literal notranslate">mux_memory_t</code> <strong>must not</strong> be accessed simultaneously.</p></li>
<li><p>A <code class="docutils literal notranslate">mux_memory_t</code> that is currently bound to a <code class="docutils literal notranslate">mux_buffer_t</code>
<strong>must not</strong> be destroyed before the <code class="docutils literal notranslate">mux_image_t</code> has been
destroyed.</p></li>
</ul>
</div>
<div class="section" id="muxdestroyimage">
<a class="header-link" href="#muxdestroyimage"><h3 id="muxdestroyimage">muxDestroyImage</h3><span class="material-icons">link</span></a>
<p>Destroy a <code class="docutils literal notranslate">mux_image_t</code> object using <code class="docutils literal notranslate">muxDestroyImage()</code>, destroying
an image unbinds a bound <code class="docutils literal notranslate">mux_memory_t</code>.</p>
<pre><code class="language-c">void muxDestroyImage(
    mux_device_t device,
    mux_image_t image,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to destroy this image with.</p></li>
<li><p><code class="docutils literal notranslate">image</code> - an image previously created by a call to
<code class="docutils literal notranslate">muxCreateImage()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">image</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyImage()</code>, for a given <code class="docutils literal notranslate">mux_device_t</code>,
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">device</code> instance used for <code class="docutils literal notranslate">muxCreateImage()</code> <strong>must</strong> be the
same <code class="docutils literal notranslate">device</code> passed to <code class="docutils literal notranslate">muxDestroyImage()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyImage()</code> <strong>must</strong> be
the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateImage()</code> that created <code class="docutils literal notranslate">image</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_image_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxbindimagememory">
<a class="header-link" href="#muxbindimagememory"><h3 id="muxbindimagememory">muxBindImageMemory</h3><span class="material-icons">link</span></a>
<p>To provide physical device memory backing to a <code class="docutils literal notranslate">mux_image_t</code> object,
the <code class="docutils literal notranslate">muxBindImageMemory()</code> function is provided. This is used to
specify the region of the <code class="docutils literal notranslate">mux_memory_t</code> that should be used to store
the <code class="docutils literal notranslate">mux_image_t</code>’s data on the device.</p>
<pre><code class="language-c">mux_result_t muxBindImageMemory(
    mux_device_t device,
    mux_memory_t memory,
    mux_image_t image,
    uint64_t offset);
</code>
</pre>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when any of
the</p></li>
<li><p>following conditions are met</p>
<ul>
<li><p><code class="docutils literal notranslate">device</code> is not a valid <code class="docutils literal notranslate">mux_device_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">memory</code> is not a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">image</code> is not a valid <code class="docutils literal notranslate">mux_image_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">offset + image-&gt;memory_requirements.size</code> is greater than
<code class="docutils literal notranslate">memory-&gt;size</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> is not a multiple of
<code class="docutils literal notranslate">image-&gt;memory_requirements.alignment</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxBindImageMemory()</code> for the given <code class="docutils literal notranslate">device</code> and
<code class="docutils literal notranslate">memory</code>, <strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">mux_image_t</code>’s <strong>may</strong> alias the same memory, but the aliased
<code class="docutils literal notranslate">mux_memory_t</code> <strong>must not</strong> be executed simultaneously.</p></li>
<li><p><code class="docutils literal notranslate">mux_image_t</code>’s <strong>may</strong> be re-bound (via a call to
<code class="docutils literal notranslate">muxBindImageMemory()</code>) any number of times.</p></li>
<li><p>A <code class="docutils literal notranslate">mux_memory_t</code> that is currently bound to a <code class="docutils literal notranslate">mux_image_t</code>
<strong>must not</strong> be destroyed before the image has been destroyed.</p></li>
</ul>
</div>
<div class="section" id="muxgetsupportedimageformats">
<a class="header-link" href="#muxgetsupportedimageformats"><h3 id="muxgetsupportedimageformats">muxGetSupportedImageFormats</h3><span class="material-icons">link</span></a>
<p>Query the Mux device for a list of supported image formats.</p>
<pre><code class="language-c">mux_result_t muxGetSupportedImageFormats(
    mux_device_t device,
    mux_image_type_e image_type,
    mux_allocation_type_e allocation_type,
    uint32_t count,
    mux_image_format_e* out_formats,
    uint32_t* out_count);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - The device to query for supported image formats.</p></li>
<li><p><code class="docutils literal notranslate">image_type</code> - The type of the image.</p></li>
<li><p><code class="docutils literal notranslate">allocation_type</code> - The required allocation capabilities of the
image.</p></li>
<li><p><code class="docutils literal notranslate">count</code> - The element count of the <code class="docutils literal notranslate">out_formats</code> array, must be
greater than zero if <code class="docutils literal notranslate">out_formats</code> is not null, and zero otherwise.</p></li>
<li><p><code class="docutils literal notranslate">out_formats</code> - Return the list of supported formats, may be null.
Storage must be an array of <code class="docutils literal notranslate">out_count</code> elements.</p></li>
<li><p><code class="docutils literal notranslate">out_count</code> - Return the number of supported formats, may be null.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when any of
the following conditions are met</p>
<ul>
<li><p><code class="docutils literal notranslate">device</code> is not a valid <code class="docutils literal notranslate">mux_device_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">image_type</code> is not a valid <code class="docutils literal notranslate">mux_image_type_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocation_type</code> is not a valid <code class="docutils literal notranslate">mux_allocation_type_e</code>.</p></li>
<li><p><code class="docutils literal notranslate">count</code> is <code class="docutils literal notranslate">0</code> and <code class="docutils literal notranslate">out_formats</code> is not <code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetSupportedImageFormats()</code> for a given <code class="docutils literal notranslate">device</code>
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>When <code class="docutils literal notranslate">out_formats</code> is <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">count</code> <strong>must</strong> be <code class="docutils literal notranslate">0</code>.</p></li>
<li><p>When <code class="docutils literal notranslate">out_formats</code> is not <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">count</code> <strong>must not</strong> be
<code class="docutils literal notranslate">0</code>.</p></li>
<li><p><code class="docutils literal notranslate">out_count</code> <strong>may</strong> be <code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="queries">
<a class="header-link" href="#queries"><h2 id="queries">Queries</h2><span class="material-icons">link</span></a>
<p>Queries allow the application to query the implementation about runtime
behavior by providing a mechanism to report performance data. Multiple
queries <strong>may</strong> be active at one time, a query is considered to be
active as long as there is an existing query pool to which its
corresponding <code class="docutils literal notranslate">mux_query_type_e</code> (and its specific <code class="docutils literal notranslate">uuid</code> in the
case of <code class="docutils literal notranslate">mux_query_type_counter</code>) was passed during creation. Note
that in the case of counter queries, each active query takes a number
of hardware counters to support, as denoted by
<code class="docutils literal notranslate">mux_query_counter_s::hardware_counters</code>. The number of hardware
counters needed to support all active counter queries <strong>must</strong> not
exceed the device’s limit, as defined by
<code class="docutils literal notranslate">mux_device_info_s::max_active_hardware_counters</code>. The storage for
the query data resides in a <code class="docutils literal notranslate">mux_query_pool_t</code> object.</p>
<pre><code class="language-c">struct mux_query_pool_s {
  mux_id_t id;
  mux_query_type_e type;
  uint32_t count;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">id</code> - the ID of this query pool object.</p></li>
<li><p><code class="docutils literal notranslate">type</code> - the type of the query pool (one of the values in the enum
<code class="docutils literal notranslate">mux_query_type_e</code>).</p></li>
<li><p><code class="docutils literal notranslate">count</code> - the total number of queries that can be stored in the
query pool.</p></li>
</ul>
<div class="section" id="muxcreatequerypool">
<a class="header-link" href="#muxcreatequerypool"><h3 id="muxcreatequerypool">muxCreateQueryPool</h3><span class="material-icons">link</span></a>
<p>Create a query pool into which data can be stored about the runtime
behavior of commands on a queue.</p>
<pre><code class="language-c">mux_result_t muxCreateQueryPool(
    mux_queue_t queue,
    mux_query_type_e query_type,
    uint32_t query_count,
    const mux_query_counter_config_t* query_counter_configs,
    mux_allocator_info_t allocator_info,
    mux_query_pool_t* out_query_pool);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - the Mux queue to create the query pool with.</p></li>
<li><p><code class="docutils literal notranslate">query_type</code> - the type of query pool to create (one of the values
in the enum <a class="reference internal" href="#mux-query-type-e">mux_query_type_e</a>).</p></li>
<li><p><code class="docutils literal notranslate">query_count</code> - the number of queries to allocate storage for.</p></li>
<li><p><code class="docutils literal notranslate">query_counter_configs</code> - array of query counter configuration data
with length <code class="docutils literal notranslate">query_count</code>, <strong>must</strong> be provided when <code class="docutils literal notranslate">query_type</code>
is <code class="docutils literal notranslate">mux_query_type_counter</code>, see <a class="reference internal" href="#mux-query-counter-config-s">mux_query_counter_config_s</a>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - allocator information.</p></li>
<li><p><code class="docutils literal notranslate">out_query_pool</code> - the newly created query pool, or uninitialized
if an error occurred.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">queue</code> is not a valid <code class="docutils literal notranslate">mux_queue_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_type</code> is not a value defined in <code class="docutils literal notranslate">mux_query_type_e</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>should</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_count</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_query_pool</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
<li><p>If an allocation failed <code class="docutils literal notranslate">mux_error_out_of_memory</code> <strong>shall</strong> be
returned.</p></li>
<li><p>If the number of hardware counters needed to accomodate the query
counters in <code class="docutils literal notranslate">query_counter_configs</code> would bring the number needed
to support all active counters above the maximum supported by the
device, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<blockquote>
<div><p>Note: <code class="docutils literal notranslate">query_type</code> validation <strong>should</strong> be performed by the
target.</p>
</div></blockquote>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateQueryPool</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
<div class="section" id="mux-query-type-e">
<a class="header-link" href="#mux-query-type-e"><h4 id="mux-query-type-e">mux_query_type_e</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">typedef enum mux_query_type_e {
  mux_query_type_duration
  mux_query_type_counter
} mux_query_type_e;
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_query_type_duration</code> - query the command duration with
<code class="docutils literal notranslate">start</code> and <code class="docutils literal notranslate">end</code> timestamps, results are stored in an array of
<code class="docutils literal notranslate">mux_query_duration_result_s</code>, the <code class="docutils literal notranslate">start</code> and <code class="docutils literal notranslate">end</code> timestamps
<strong>must</strong> be CPU timestamps which <strong>may</strong> require interpolation of
device timestamps, only a single command duration query <strong>shall</strong> be
enabled in a command buffer at one time.</p></li>
<li><p><code class="docutils literal notranslate">mux_query_type_counter</code> - query the values of an enabled set of
hardware counters, results are stored in an array of
<code class="docutils literal notranslate">mux_query_counter_result_s</code>, the union member which contains the
result is defined by the <code class="docutils literal notranslate">mux_query_counter_s</code> struct’s <code class="docutils literal notranslate">storage</code>
member with a matching <code class="docutils literal notranslate">uuid</code> to the enabled counter.</p></li>
</ul>
</div>
<div class="section" id="mux-query-counter-config-s">
<a class="header-link" href="#mux-query-counter-config-s"><h4 id="mux-query-counter-config-s">mux_query_counter_config_s</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">struct mux_query_counter_config_s {
  uint32_t uuid;
  void* data;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">uuid</code> - the unique ID of the query counter, see
<a class="reference external" href="#muxgetsupportedquerycounters">muxGetSupportedQueryCounters</a>.</p></li>
<li><p><code class="docutils literal notranslate">data</code> - data used to specify how a counter is to be configured,
<strong>may</strong> be NULL.</p></li>
</ul>
</div>
</div>
<div class="section" id="muxdestroyquerypool">
<a class="header-link" href="#muxdestroyquerypool"><h3 id="muxdestroyquerypool">muxDestroyQueryPool</h3><span class="material-icons">link</span></a>
<p>Destroy a query pool previously created with <code class="docutils literal notranslate">muxCreateQueryPool</code>.</p>
<pre><code class="language-c">void muxDestroyQueryPool(
    mux_queue_t queue,
    mux_query_pool_t query_pool,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - the Mux queue the query pool was created with.</p></li>
<li><p><code class="docutils literal notranslate">query_pool</code> - the Mux query pool to destroy.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - allocator information.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyQueryPool()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> passed to <code class="docutils literal notranslate">muxDestroyQueryPool()</code> <strong>must</strong> be the
same <code class="docutils literal notranslate">mux_queue_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateQueryPool()</code> that created <code class="docutils literal notranslate">query_pool</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyQueryPool</code> <strong>must</strong> be
the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateQueryPool()</code> that created <code class="docutils literal notranslate">query_pool</code>.</p></li>
<li><p><code class="docutils literal notranslate">queue</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_queue_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">query_pool</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_query_pool_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxgetquerypoolresults">
<a class="header-link" href="#muxgetquerypoolresults"><h3 id="muxgetquerypoolresults">muxGetQueryPoolResults</h3><span class="material-icons">link</span></a>
<p>Get query results previously written to the query pool, it copies the
requested query pool results previously written during runtime on the
Mux queue into the user provided storage.</p>
<pre><code class="language-c">mux_result_t muxGetQueryPoolResults(
    mux_queue_t queue,
    mux_query_pool_t query_pool,
    uint32_t query_index,
    uint32_t query_count,
    size_t size,
    void* data,
    size_t stride);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - the Mux queue the query pool was created with.</p></li>
<li><p><code class="docutils literal notranslate">query_pool</code> - the Mux query pool to get the results from.</p></li>
<li><p><code class="docutils literal notranslate">query_index</code> - the query index of the first query to get the
result of.</p></li>
<li><p><code class="docutils literal notranslate">query_count</code> - the number of queries to get the results of.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size in bytes of the memory pointed to by <code class="docutils literal notranslate">data</code>.</p></li>
<li><p><code class="docutils literal notranslate">data</code> - a pointer to the memory to write the query results into,
if <code class="docutils literal notranslate">query_pool-&gt;type</code> is <code class="docutils literal notranslate">mux_query_type_duration</code> then <code class="docutils literal notranslate">data</code>
<strong>shall</strong> point to an array of <a class="reference internal" href="#mux-query-duration-result-s">mux_query_duration_result_s</a>, if
<code class="docutils literal notranslate">query_qool-&gt;type</code> is <code class="docutils literal notranslate">mux_query_type_counter</code> then <code class="docutils literal notranslate">data</code>
<strong>shall</strong> point to an array of <a class="reference internal" href="#mux-query-counter-result-s">mux_query_counter_result_s</a>.</p></li>
<li><p><code class="docutils literal notranslate">stride</code> - the stride in bytes between query results to be written
into <code class="docutils literal notranslate">data</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">queue</code> is not a valid <code class="docutils literal notranslate">mux_queue_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_pool</code> is not a valid <code class="docutils literal notranslate">mux_query_pool_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index</code> is greater than or equal to <code class="docutils literal notranslate">query_pool-&gt;count</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_count + query_index</code> is greater than
<code class="docutils literal notranslate">query_pool-&gt;count</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is smaller than the storage required for the requested
query results, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">data</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">stride</code> is smaller than the storage required for a single query
result, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetQueryPoolResults()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">muxGetQueryPoolResults()</code> <strong>must not</strong> be called when the
<code class="docutils literal notranslate">query_pool</code> is currently being used in a <code class="docutils literal notranslate">mux_command_buffer_t</code>
that has been dispatched but is not complete.</p></li>
<li><p>Results returned by <code class="docutils literal notranslate">muxGetQueryPoolResults()</code> <strong>must</strong> be
available as soon as a dispatched <code class="docutils literal notranslate">mux_command_buffer_t</code> which uses
the <code class="docutils literal notranslate">query_pool</code> has completed.</p></li>
</ul>
<div class="section" id="mux-query-duration-result-s">
<a class="header-link" href="#mux-query-duration-result-s"><h4 id="mux-query-duration-result-s">mux_query_duration_result_s</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">struct mux_query_duration_result_s {
  uint64_t start;
  uint64_t end;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">start</code> - the CPU timestamp at the start of the command, in
nanoseconds.</p></li>
<li><p><code class="docutils literal notranslate">end</code> - the CPU timestamp at the end of the command, in
nanoseconds.</p></li>
</ul>
</div>
<div class="section" id="mux-query-counter-result-s">
<a class="header-link" href="#mux-query-counter-result-s"><h4 id="mux-query-counter-result-s">mux_query_counter_result_s</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">struct mux_query_counter_result_s {
  union {
    int32_t int32;
    int64_t int64;
    uint32_t uint32;
    uint64_t uint64;
    float float32;
    double float64;
  };
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">int32</code> - contains the result when the associated enabled counter’s
<code class="docutils literal notranslate">storage</code> is <code class="docutils literal notranslate">mux_query_counter_storage_int32</code>.</p></li>
<li><p><code class="docutils literal notranslate">int64</code> - contains the result when the associated enabled counter’s
<code class="docutils literal notranslate">storage</code> is <code class="docutils literal notranslate">mux_query_counter_storage_int64</code>.</p></li>
<li><p><code class="docutils literal notranslate">uint32</code> - contains the result when the associated enabled
counter’s <code class="docutils literal notranslate">storage</code> is <code class="docutils literal notranslate">mux_query_counter_storage_uint32</code>.</p></li>
<li><p><code class="docutils literal notranslate">uint64</code> - contains the result when the associated enabled
counter’s <code class="docutils literal notranslate">storage</code> is <code class="docutils literal notranslate">mux_query_counter_storage_uint64</code>.</p></li>
<li><p><code class="docutils literal notranslate">float32</code> - contains the result when the associated enabled
counter’s <code class="docutils literal notranslate">storage</code> is <code class="docutils literal notranslate">mux_query_counter_storage_float32</code>.</p></li>
<li><p><code class="docutils literal notranslate">float64</code> - contains the result when the associated enabled
counter’s <code class="docutils literal notranslate">storage</code> is <code class="docutils literal notranslate">mux_query_counter_storage_float64</code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="muxgetsupportedquerycounters">
<a class="header-link" href="#muxgetsupportedquerycounters"><h3 id="muxgetsupportedquerycounters">muxGetSupportedQueryCounters</h3><span class="material-icons">link</span></a>
<p>Get the list of supported query counters for a device’s queue type.</p>
<pre><code class="language-c">mux_result_t muxGetSupportedQueryCounters(
    mux_device_t device,
    mux_queue_type_e queue_type,
    uint32_t count,
    mux_query_counter_t* out_counters,
    mux_query_counter_description_t* out_descriptions,
    uint32_t* out_count);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - a Mux device.</p></li>
<li><p><code class="docutils literal notranslate">queue_type</code> - the type of queue to get the supported query
counters list for.</p></li>
<li><p><code class="docutils literal notranslate">count</code> - the element count of the <code class="docutils literal notranslate">out_counters</code> and
<code class="docutils literal notranslate">out_descriptions</code> arrays, <strong>must</strong> be greater than zero if
<code class="docutils literal notranslate">out_counters</code> is not NULL and zero otherwise.</p></li>
<li><p><code class="docutils literal notranslate">out_counters</code> - return the list of supported query counters,
<strong>may</strong> be NULL. Storage <strong>must</strong> be an array of <code class="docutils literal notranslate">count</code> elements,
see <a class="reference internal" href="#mux-query-counter-s">mux_query_counter_s</a>.</p></li>
<li><p><code class="docutils literal notranslate">out_descriptions</code> - return the list of descriptions of support
query counters, <strong>may</strong> be NULL. Storage <strong>must</strong> be an array of
<code class="docutils literal notranslate">count</code> elements, see <a class="reference internal" href="#mux-query-counter-description-s">mux_query_counter_description_s</a>.</p></li>
<li><p><code class="docutils literal notranslate">out_count</code> - return the total count of supported query counters.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">device</code> is not a valid <code class="docutils literal notranslate">mux_device_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">device-&gt;info-&gt;query_counter_support</code> is false,
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">queue_type</code> is not a value defined in <code class="docutils literal notranslate">mux_queue_type_e</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">count</code> is zero and <code class="docutils literal notranslate">out_counters</code> or <code class="docutils literal notranslate">out_descriptions</code> are
not NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">count</code> is not zero and <code class="docutils literal notranslate">out_counters</code> and
<code class="docutils literal notranslate">out_descriptions</code> are NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetSupportedQueryCounters</code> <strong>shall</strong> be considered
thread-safe.</p></li>
</ul>
<div class="section" id="mux-query-counter-s">
<a class="header-link" href="#mux-query-counter-s"><h4 id="mux-query-counter-s">mux_query_counter_s</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">struct mux_query_counter_s {
  mux_query_counter_unit_e unit;
  mux_query_counter_storage_e storage;
  uint32_t uuid;
  uint32_t hardware_counters;
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">unit</code> - the unit of the query counter result.</p></li>
<li><p><code class="docutils literal notranslate">storage</code> - the storage type of the query counter result.</p></li>
<li><p><code class="docutils literal notranslate">uuid</code> - the unique ID of the query counter, this is used to enable
a counter.</p></li>
<li><p><code class="docutils literal notranslate">hardware_counters</code> - the number of hardware counters required to
support this query counter while it’s active.</p></li>
</ul>
</div>
<div class="section" id="mux-query-counter-description-s">
<a class="header-link" href="#mux-query-counter-description-s"><h4 id="mux-query-counter-description-s">mux_query_counter_description_s</h4><span class="material-icons">link</span></a>
<pre><code class="language-c">struct mux_query_counter_description_s {
  char name[256];
  char category[256];
  char description[256];
};
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">name</code> - the counter name stored in a UTF-8 encoded null terminated
array of 256 characters.</p></li>
<li><p><code class="docutils literal notranslate">category</code> - the counter category stored in a UTF-8 encoded null
terminated array of 256 characters.</p></li>
<li><p><code class="docutils literal notranslate">description</code> - the counter description stored in a UTF-8 encoded
null terminated array of 256 characters.</p></li>
</ul>
</div>
</div>
<div class="section" id="muxgetquerycounterrequiredpasses">
<a class="header-link" href="#muxgetquerycounterrequiredpasses"><h3 id="muxgetquerycounterrequiredpasses">muxGetQueryCounterRequiredPasses</h3><span class="material-icons">link</span></a>
<p>Get the number of passes required for valid query counter results.</p>
<pre><code class="language-c">mux_result_t muxGetQueryCounterRequiredPasses(
    mux_queue_t queue,
    uint32_t query_count,
    const mux_query_counter_config_t* query_counter_configs,
    uint32_t* out_pass_count);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - a mux queue.</p></li>
<li><p><code class="docutils literal notranslate">query_count</code> - the number of elements in the array pointed to by
<code class="docutils literal notranslate">query_counter_configs</code>.</p></li>
<li><p><code class="docutils literal notranslate">query_counter_configs</code> - array of query counter configuration data
with length <code class="docutils literal notranslate">query_count</code>, <strong>must</strong> be provided when <code class="docutils literal notranslate">query_type</code>
is <code class="docutils literal notranslate">mux_query_type_counter</code>, otherwise <strong>must</strong> be NULL.</p></li>
<li><p><code class="docutils literal notranslate">out_pass_count</code> - return the number of passes required to produce
valid results for the given list of query counters.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">queue</code> is not a valid <code class="docutils literal notranslate">mux_queue_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_count</code> is zero, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_counter_configs</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_pass_count</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetQueryCounterRequiredPasses</code> <strong>shall</strong> be considered
thread-safe.</p></li>
</ul>
</div>
</div>
<div class="section" id="command-buffers">
<a class="header-link" href="#command-buffers"><h2 id="command-buffers">Command Buffers</h2><span class="material-icons">link</span></a>
<p>Command buffers in Mux are a collection of commands that will be
dispatched and executed on a device. Commands within a command buffer
<strong>must</strong> be executed <em>as if</em> in the order they are pushed onto the
command buffer.</p>
<blockquote>
<div><p>Command buffer implementations <strong>must not</strong> access Mux semaphores of
completed command buffers they wait on, otherwise code using Mux
<strong>may</strong> deadlock due to resetting semaphores. One approach to
implement command buffers is for command buffers to track which other
command buffers wait on them while adding a counter to represent the
number of command buffers they are waiting on. When a command buffer
completes then decrease the counters of all command buffers waiting on
it. Command buffers are only ready to run when their waiting counter
is zero.</p>
</div></blockquote>
<p>Synchronization of commands within the same command-buffer is done by
<code class="docutils literal notranslate">mux_sync_point_s</code> synchronization points (sync-point). Each command recording
entry-point can return a sync-point for other commands to wait on, and in turn
take a list of sync-points to wait on itself. There are no create or destroy
entry-points for user control of the sync-point lifetimes. Instead
<code class="docutils literal notranslate">mux_sync_point_s</code> objects are valid for the lifetime of the command-buffer
they were created from.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The restriction that commands in a command-buffer must be executed as if
in-order will be relaxed once sync-points are fully implemented for all
targets.</p>
</div>
<div class="section" id="muxcreatecommandbuffer">
<a class="header-link" href="#muxcreatecommandbuffer"><h3 id="muxcreatecommandbuffer">muxCreateCommandBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateCommandBuffer()</code> creates a command_buffer from a given Mux
device.</p>
<pre><code class="language-c">mux_result_t muxCreateCommandBuffer(
    mux_device_t device,
    mux_callback_info_t callback_info,
    mux_allocator_info_t allocator_info,
    mux_command_buffer_t* out_command_buffer);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to create this command buffer with.</p></li>
<li><p><code class="docutils literal notranslate">callback_info</code> - the user provided callback, which <strong>may</strong> be
null, can be used by the implementation to provide detailed messages
about command buffer execution to the user.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_command_buffer</code> - the newly created command buffer.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_command_buffer</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_command_buffer</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateCommandBuffer()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code> that was used in the creation of the
<code class="docutils literal notranslate">mux_command_buffer_t</code> <strong>must not</strong> be destroyed before the command
group has been destroyed.</p></li>
</ul>
</div>
<div class="section" id="muxfinalizecommandbuffer">
<a class="header-link" href="#muxfinalizecommandbuffer"><h3 id="muxfinalizecommandbuffer">muxFinalizeCommandBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxFinalizeCommandBuffer()</code> finalizes a <code class="docutils literal notranslate">mux_command_buffer_t</code>.</p>
<pre><code class="language-c">mux_result_t muxFinalizeCommandBuffer(
    mux_command_buffer_t command_buffer);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - the <code class="docutils literal notranslate">mux_command_buffer_t</code> to be finalized.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>may</strong> not be in a valid state.</p>
<p class="rubric">Valid Usage:</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxFinalizeCommandBuffer()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>Subsequent calls to <code class="docutils literal notranslate">muxFinalizeCommandBuffer()</code> with the same <code class="docutils literal notranslate">command_buffer</code>
will have no effect on <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
<p class="rubric">Validation Rules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> <strong>must</strong> not have further commands pushed to it after
<code class="docutils literal notranslate">muxFinalizeCommandBuffer()</code> is called unless <code class="docutils literal notranslate">muxResetCommandBuffer()</code>
is called first.</p></li>
<li><p>All <code class="docutils literal notranslate">mux_command_buffer_t</code> s must be finalized before being passed to a
<code class="docutils literal notranslate">muxDispatch()</code> call.</p></li>
</ul>
</div>
<div class="section" id="muxclonecommandbuffer">
<a class="header-link" href="#muxclonecommandbuffer"><h3 id="muxclonecommandbuffer">muxCloneCommandBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCloneCommandBuffer()</code> clones a <code class="docutils literal notranslate">mux_command_buffer_t</code>.</p>
<p>Entry point is optional and <strong>must</strong> return <code class="docutils literal notranslate">mux_error_feature_unsupported</code> if
it is not supported.</p>
<pre><code class="language-c">mux_result_t muxCloneCommandBuffer(
    mux_device_t device,
    mux_allocator_info_t allocator_info,
    mux_command_buffer_t command_buffer,
    mux_command_buffer_t* out_command_buffer);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to create the new command buffer with.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used for host
memory allocations as described in the <a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> - the <code class="docutils literal notranslate">mux_command_buffer_t</code> to be cloned.</p></li>
<li><p><code class="docutils literal notranslate">out_command_buffer</code> - the newly created command buffer.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently the caller expectations of this entry-point are that the clone
needs to deep copy the ndrange kernel commands only, and other
commands and resources may be shallow copied.</p>
</div>
<p class="rubric">Return Codes:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">device</code> does not support cloning command buffers
i.e. <code class="docutils literal notranslate">mux_device_info_s::can_clone_command_buffers == false</code>
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> must be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_command_buffer</code> is <code class="docutils literal notranslate">NULL</code>, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong> be
returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> or <code class="docutils literal notranslate">mux_error_feature_unsupported</code>
is returned, <code class="docutils literal notranslate">out_command_buffer</code> <strong>may</strong> not be in a valid state.</p>
<p class="rubric">Valid Usage:</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCloneCommandBuffer()</code> operating on distinct <code class="docutils literal notranslate">command_buffers</code>’s
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">mux_command_buffer_t``s passed as the ``mux_command_buffer</code> parameter <strong>must</strong> be
in the <em>finalized</em> state.</p></li>
<li><p>A <code class="docutils literal notranslate">mux_device_t</code> passed as the <code class="docutils literal notranslate">device</code> parameter <strong>must</strong> be the same
<code class="docutils literal notranslate">device</code> that was passed to the <code class="docutils literal notranslate">muxCreateCommandBuffer</code> call used create the
<code class="docutils literal notranslate">command_buffer</code> parameter.</p></li>
</ul>
<p class="rubric">Validation Rules:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">out_command_buffer</code> <strong>must</strong> not have further commands pushed to it after
<code class="docutils literal notranslate">muxCloneCommandBuffer()</code> is called unless <code class="docutils literal notranslate">muxResetCommandBuffer()</code>
is called first.</p></li>
<li><p>The <code class="docutils literal notranslate">mux_device_t</code> that was used in the creation of the
<code class="docutils literal notranslate">mux_command_buffer_t</code> that is returned via the <code class="docutils literal notranslate">out_command_buffer</code> parameter
<strong>must not</strong> be destroyed before the command buffer has been destroyed.</p></li>
</ul>
</div>
<div class="section" id="muxdestroycommandbuffer">
<a class="header-link" href="#muxdestroycommandbuffer"><h3 id="muxdestroycommandbuffer">muxDestroyCommandBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroyCommandBuffer()</code> destroys a previously created
<code class="docutils literal notranslate">mux_command_buffer_t</code>.</p>
<pre><code class="language-c">void muxDestroyCommandBuffer(
    mux_device_t device,
    mux_command_buffer_t command_buffer,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device to create the command buffer with.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">command_buffer</code>
was created with.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyCommandBuffer()</code> with a given <code class="docutils literal notranslate">command_buffer</code>
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyCommandBuffer()</code>
<strong>must</strong> be the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call
to <code class="docutils literal notranslate">muxCreateCommandBuffer()</code> that created <code class="docutils literal notranslate">command_buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">muxDestroyCommandBuffer()</code> <strong>must not</strong> be called in a
<code class="docutils literal notranslate">muxDispatch()</code>’s <code class="docutils literal notranslate">user_function</code> callback.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_command_buffer_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxresetcommandbuffer">
<a class="header-link" href="#muxresetcommandbuffer"><h3 id="muxresetcommandbuffer">muxResetCommandBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxResetCommandBuffer()</code> resets a previously created
<code class="docutils literal notranslate">mux_command_buffer_t</code>.</p>
<pre><code class="language-c">mux_result_t muxResetCommandBuffer(
    mux_command_buffer_t command_buffer);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxResetCommandBuffer()</code> with a given <code class="docutils literal notranslate">command_buffer</code>
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">muxResetCommandBuffer()</code> <strong>must not</strong> be called in a
<code class="docutils literal notranslate">muxDispatch()</code>’s <code class="docutils literal notranslate">user_function</code> callback.</p></li>
</ul>
</div>
<div class="section" id="muxcommandreadbuffer">
<a class="header-link" href="#muxcommandreadbuffer"><h3 id="muxcommandreadbuffer">muxCommandReadBuffer</h3><span class="material-icons">link</span></a>
<p>Push a command to a command buffer to read a <code class="docutils literal notranslate">mux_buffer_t</code> to a host
pointer.</p>
<pre><code class="language-c">mux_result_t muxCommandReadBuffer(
    mux_command_buffer_t command_buffer,
    mux_buffer_t buffer,
    uint64_t offset,
    void* host_pointer,
    uint64_t size,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be read from.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the offset (in bytes) into <code class="docutils literal notranslate">buffer</code> to read.</p></li>
<li><p><code class="docutils literal notranslate">host_pointer</code> - the host pointer to write to.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) to copy from <code class="docutils literal notranslate">buffer</code> to
<code class="docutils literal notranslate">host_pointer</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">offset</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">offset</code> plus <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">host_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandReadBuffer()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">buffer</code> passed to
<code class="docutils literal notranslate">muxCommandReadBuffer()</code> <strong>must</strong> have been created using the same
<code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandReadBuffer()</code> <strong>must</strong> be bound to
a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandReadBuffer()</code> <strong>must not</strong> be
re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandreadbufferregions">
<a class="header-link" href="#muxcommandreadbufferregions"><h3 id="muxcommandreadbufferregions">muxCommandReadBufferRegions</h3><span class="material-icons">link</span></a>
<p>Push a command to a command buffer to read regions from a
<code class="docutils literal notranslate">mux_buffer_t</code> to regions in a host pointer.</p>
<pre><code class="language-c">mux_result_t muxCommandReadBufferRegions(
    mux_command_buffer_t command_buffer,
    mux_buffer_t buffer,
    void* host_pointer,
    mux_buffer_region_info_t* regions,
    uint64_t regions_length,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be read from.</p></li>
<li><p><code class="docutils literal notranslate">host_pointer</code> - the host pointer to write to.</p></li>
<li><p><code class="docutils literal notranslate">regions</code> - the regions of the <code class="docutils literal notranslate">buffer</code> to write to regions of
the <code class="docutils literal notranslate">host_pointer</code>.</p></li>
<li><p><code class="docutils literal notranslate">regions_length</code> - the number of elements in <code class="docutils literal notranslate">regions</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">host_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">regions</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">regions</code> contain a <code class="docutils literal notranslate">region</code> that has an
<code class="docutils literal notranslate">x</code>,<code class="docutils literal notranslate">y</code>, or <code class="docutils literal notranslate">z</code> attribute set to zero
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned. For a 2D
region <code class="docutils literal notranslate">z</code> should be 1, for a 1D region <code class="docutils literal notranslate">y</code> and <code class="docutils literal notranslate">z</code> should be
1.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">src_desc</code> or <code class="docutils literal notranslate">dst_desc</code> contain an <code class="docutils literal notranslate">x</code> or <code class="docutils literal notranslate">y</code>
value that is less than the <code class="docutils literal notranslate">x</code> or <code class="docutils literal notranslate">y</code> value in <code class="docutils literal notranslate">region</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If the <code class="docutils literal notranslate">region</code> offset by the <code class="docutils literal notranslate">src_offset</code> is out of the bounds
of the <code class="docutils literal notranslate">buffer</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">regions</code> offset by the <code class="docutils literal notranslate">src_offset</code> overlap, then
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">regions_length</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandReadBufferRegions()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">buffer</code> passed to
<code class="docutils literal notranslate">muxCommandReadBufferRegions()</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandReadBufferRegions()</code> <strong>must</strong> be
bound to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandReadBufferRegions()</code> <strong>must not</strong>
be re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandwritebuffer">
<a class="header-link" href="#muxcommandwritebuffer"><h3 id="muxcommandwritebuffer">muxCommandWriteBuffer</h3><span class="material-icons">link</span></a>
<p>Push a command to a command buffer to write to a <code class="docutils literal notranslate">mux_buffer_t</code> from a
host pointer.</p>
<pre><code class="language-c">mux_result_t muxCommandWriteBuffer(
    mux_command_buffer_t command_buffer,
    mux_buffer_t buffer,
    uint64_t offset,
    const void* host_pointer,
    uint64_t size,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be written to.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the offset (in bytes) into <code class="docutils literal notranslate">buffer</code> to write.</p></li>
<li><p><code class="docutils literal notranslate">host_pointer</code> - the host pointer to read from.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) to copy from <code class="docutils literal notranslate">host_pointer</code> to
<code class="docutils literal notranslate">buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">offset</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">offset</code> plus <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">host_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandWriteBuffer()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">buffer</code> passed to
<code class="docutils literal notranslate">muxCommandWriteBuffer()</code> <strong>must</strong> have been created using the same
<code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandWriteBuffer()</code> <strong>must</strong> be bound
to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandWriteBuffer()</code> <strong>must not</strong> be
re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandwritebufferregions">
<a class="header-link" href="#muxcommandwritebufferregions"><h3 id="muxcommandwritebufferregions">muxCommandWriteBufferRegions</h3><span class="material-icons">link</span></a>
<p>Push a command to a command buffer to read regions from a host pointer to
regions in a <code class="docutils literal notranslate">mux_buffer_t</code>.</p>
<pre><code class="language-c">mux_result_t muxCommandWriteBufferRegions(
    mux_command_buffer_t command_buffer,
    mux_buffer_t buffer,
    void* host_pointer,
    mux_buffer_region_info_t* regions,
    uint64_t regions_length,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be written to.</p></li>
<li><p><code class="docutils literal notranslate">host_pointer</code> - the host pointer to read from.</p></li>
<li><p><code class="docutils literal notranslate">regions</code> - the regions of the <code class="docutils literal notranslate">host_pointer</code> to write to regions
of the <code class="docutils literal notranslate">buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">regions_length</code> - the number of elements in <code class="docutils literal notranslate">regions</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">host_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">regions</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">regions</code> contain a <code class="docutils literal notranslate">region</code> that has an
<code class="docutils literal notranslate">x</code>,<code class="docutils literal notranslate">y</code>, or <code class="docutils literal notranslate">z</code> attribute set to zero
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned. For a 2D
region <code class="docutils literal notranslate">z</code> should be 1, for a 1D region <code class="docutils literal notranslate">y</code> and <code class="docutils literal notranslate">z</code> should be
1.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">src_desc</code> or <code class="docutils literal notranslate">dst_desc</code> contain an <code class="docutils literal notranslate">x</code> or <code class="docutils literal notranslate">y</code>
value that is less than the <code class="docutils literal notranslate">x</code> or <code class="docutils literal notranslate">y</code> value in <code class="docutils literal notranslate">region</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If the <code class="docutils literal notranslate">region</code> offset by the <code class="docutils literal notranslate">dst_offset</code> is out of the bounds
of the <code class="docutils literal notranslate">buffer</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">regions</code> offset by the <code class="docutils literal notranslate">dst_offset</code> overlap, then
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">regions_length</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandWriteBufferRegions()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">buffer</code> passed to
<code class="docutils literal notranslate">muxCommandWriteBufferRegions()</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandWriteBufferRegions()</code> <strong>must</strong> be
bound to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandWriteBufferRegions()</code> <strong>must not</strong>
be re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandcopybuffer">
<a class="header-link" href="#muxcommandcopybuffer"><h3 id="muxcommandcopybuffer">muxCommandCopyBuffer</h3><span class="material-icons">link</span></a>
<p>Push a command to a command buffer to copy between two
<code class="docutils literal notranslate">mux_buffer_t</code>’s.</p>
<pre><code class="language-c">mux_result_t muxCommandCopyBuffer(
    mux_command_buffer_t command_buffer,
    mux_buffer_t src_buffer,
    uint64_t src_offset,
    mux_buffer_t dst_buffer,
    uint64_t dst_offset,
    uint64_t size,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be read from.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> - the offset (in bytes) into <code class="docutils literal notranslate">src_buffer</code> to read
from.</p></li>
<li><p><code class="docutils literal notranslate">dst_buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be written to.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> - the offset (in bytes) into <code class="docutils literal notranslate">dst_buffer</code> to write
to.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) to copy from <code class="docutils literal notranslate">src_buffer</code> to
<code class="docutils literal notranslate">dst_buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">src_offset</code> is greater than the size of <code class="docutils literal notranslate">src_buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">src_offset</code> plus <code class="docutils literal notranslate">size</code> is greater than the size of
<code class="docutils literal notranslate">src_buffer</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">dst_offset</code> is greater than the size of <code class="docutils literal notranslate">dst_buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">dst_offset</code> plus <code class="docutils literal notranslate">size</code> is greater than the size of
<code class="docutils literal notranslate">dst_buffer</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is greater than either the size of <code class="docutils literal notranslate">src_buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is greater than either the size of <code class="docutils literal notranslate">dst_buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandCopyBuffer()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">src_buffer</code> passed to
<code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must</strong> have been created using the same
<code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">dst_buffer</code> passed to
<code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must</strong> have been created using the same
<code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">src_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must</strong> be
bound to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">src_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must not</strong> be
re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">dst_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must</strong> be
bound to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">dst_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must not</strong> be
re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">src_buffer</code> and <code class="docutils literal notranslate">dst_buffer</code> passed to
<code class="docutils literal notranslate">muxCommandCopyBuffer()</code> <strong>must not</strong> refer to overlapping regions
within the same <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandcopybufferregions">
<a class="header-link" href="#muxcommandcopybufferregions"><h3 id="muxcommandcopybufferregions">muxCommandCopyBufferRegions</h3><span class="material-icons">link</span></a>
<p>Push a command to a command buffer to copy regions from a
<code class="docutils literal notranslate">mux_buffer_t</code> to regions in another <code class="docutils literal notranslate">mux_buffer_t</code>.</p>
<pre><code class="language-c">mux_result_t muxCommandCopyBufferRegions(
    mux_command_buffer_t command_buffer,
    mux_buffer_t src_buffer,
    mux_buffer_t dst_buffer,
    mux_buffer_region_info_t* regions,
    uint64_t regions_length,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be read from.</p></li>
<li><p><code class="docutils literal notranslate">dst_buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be written to.</p></li>
<li><p><code class="docutils literal notranslate">regions</code> - the regions of the <code class="docutils literal notranslate">host_pointer</code> to write to regions
of the <code class="docutils literal notranslate">buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">regions_length</code> - the number of elements in <code class="docutils literal notranslate">regions</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">host_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">regions</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">dst_offset</code>’s in <code class="docutils literal notranslate">regions</code> are greater than the
size of <code class="docutils literal notranslate">buffer</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">dst_offset</code>’s plus <code class="docutils literal notranslate">size</code>s in <code class="docutils literal notranslate">regions</code> are
greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">size</code>’s in <code class="docutils literal notranslate">regions</code> is 0,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If any of the <code class="docutils literal notranslate">size</code>’s is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If any two regions in <code class="docutils literal notranslate">regions</code> have a <code class="docutils literal notranslate">dst_offset</code> to
<code class="docutils literal notranslate">dst_offset</code> + <code class="docutils literal notranslate">size</code> range that overlaps,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">regions_length</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">src_buffer</code> passed to
<code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">dst_buffer</code> passed to
<code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">src_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> <strong>must</strong>
be bound to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">src_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> <strong>must
not</strong> be re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">dst_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> <strong>must</strong>
be bound to a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">dst_buffer</code> passed to <code class="docutils literal notranslate">muxCommandCopyBufferRegions()</code> <strong>must
not</strong> be re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandfillbuffer">
<a class="header-link" href="#muxcommandfillbuffer"><h3 id="muxcommandfillbuffer">muxCommandFillBuffer</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCommandFillBuffer()</code> pushes a command to a command buffer to fill a
<code class="docutils literal notranslate">mux_buffer_t</code> from a host pointer.</p>
<pre><code class="language-c">mux_result_t muxCommandFillBuffer(
    mux_command_buffer_t command_buffer,
    mux_buffer_t buffer,
    uint64_t offset,
    uint64_t size,
    const void* pattern_pointer,
    uint64_t pattern_size,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">buffer</code> - a buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateBuffer()</code> that will be written to.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - the offset (in bytes) into <code class="docutils literal notranslate">buffer</code> to write.</p></li>
<li><p><code class="docutils literal notranslate">size</code> - the size (in bytes) to write into <code class="docutils literal notranslate">buffer</code>.</p></li>
<li><p><code class="docutils literal notranslate">pattern_pointer</code> - the pattern to repeatedly write to <code class="docutils literal notranslate">buffer</code>,
this data <strong>must</strong> be copied by the device.</p></li>
<li><p><code class="docutils literal notranslate">pattern_size</code> - the size (in bytes) of <code class="docutils literal notranslate">pattern_pointer</code>, the
maximum size is 128 bytes which is the size of the largest supported
vector type.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">offset</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">offset</code> plus <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">size</code> is greater than the size of <code class="docutils literal notranslate">buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">pattern_pointer</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">pattern_size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong>
be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandFillBuffer()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">buffer</code> passed to
<code class="docutils literal notranslate">muxCommandFillBuffer()</code> <strong>must</strong> have been created using the same
<code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">pattern_pointer</code> <strong>may</strong> be reused immediately following return
from the <code class="docutils literal notranslate">muxCommandFillBuffer()</code> call.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandFillBuffer()</code> <strong>must</strong> be bound to
a <code class="docutils literal notranslate">mux_memory_t</code> via <code class="docutils literal notranslate">muxBindBufferMemory()</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">buffer</code> passed to <code class="docutils literal notranslate">muxCommandFillBuffer()</code> <strong>must not</strong> be
re-bound to a new <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandreadimage">
<a class="header-link" href="#muxcommandreadimage"><h3 id="muxcommandreadimage">muxCommandReadImage</h3><span class="material-icons">link</span></a>
<p>Push a read image command to the command buffer.</p>
<pre><code class="language-c">mux_result_t muxCommandReadImage(
    mux_command_buffer_t command_buffer,
    mux_image_t image,
    mux_offset_3d_t offset,
    mux_extent_3d_t extent,
    uint64_t row_size,
    uint64_t slice_size,
    void* pointer,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - The command buffer to push the image read command
to.</p></li>
<li><p><code class="docutils literal notranslate">image</code> - The image to read from.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - The x, y, z, offset in pixels into the image to read
from.</p></li>
<li><p><code class="docutils literal notranslate">extent</code> - The width, height, depth in pixels of the image to read
from.</p></li>
<li><p><code class="docutils literal notranslate">row_size</code> - The row size in bytes of the host addressable pointer
data.</p></li>
<li><p><code class="docutils literal notranslate">slice_size</code> - The slice size in bytes of the host addressable
pointer data.</p></li>
<li><p><code class="docutils literal notranslate">pointer</code> - The host addressable pointer to image data to write
into.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> and <code class="docutils literal notranslate">extent</code> combined exceed the size of the image.</p></li>
<li><p><code class="docutils literal notranslate">pointer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not
<code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is
<code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandReadImage()</code>, for a given <code class="docutils literal notranslate">command_buffer</code>,
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">image</code> <strong>must</strong> have been created using the
same</p></li>
<li><p><code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code> until
<code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">pointer</code> <strong>must</strong> remain valid until <code class="docutils literal notranslate">command_buffer</code> completes
execution.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandwriteimage">
<a class="header-link" href="#muxcommandwriteimage"><h3 id="muxcommandwriteimage">muxCommandWriteImage</h3><span class="material-icons">link</span></a>
<p>Push a write image command to the command buffer.</p>
<pre><code class="language-c">mux_result_t muxCommandWriteImage(
    mux_command_buffer_t command_buffer,
    mux_image_t image,
    mux_offset_3d_t offset,
    mux_extent_3d_t extent,
    uint64_t row_size,
    uint64_t slice_size,
    const void* pointer,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - The command buffer to push the image write command
to.</p></li>
<li><p><code class="docutils literal notranslate">image</code> - The image to write to.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - The x, y, z, offset in pixel into the image to write to.</p></li>
<li><p><code class="docutils literal notranslate">extent</code> - The width, height, depth in pixels of the image to write
to.</p></li>
<li><p><code class="docutils literal notranslate">row_size</code> - The row size in bytes of the host addressable pointer
data.</p></li>
<li><p><code class="docutils literal notranslate">slice_size</code> - The slice size in bytes of the host addressable
pointer data.</p></li>
<li><p><code class="docutils literal notranslate">pointer</code> - The host addressable pointer to image data to read
from.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> and <code class="docutils literal notranslate">extent</code> combined exceed the size of the image.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not
<code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is
<code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandWriteImage()</code>, for a given <code class="docutils literal notranslate">command_buffer</code>,
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">image</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code> until
<code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">pointer</code> <strong>must</strong> remain valid until <code class="docutils literal notranslate">command_buffer</code> completes
execution.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandfillimage">
<a class="header-link" href="#muxcommandfillimage"><h3 id="muxcommandfillimage">muxCommandFillImage</h3><span class="material-icons">link</span></a>
<p>Push a fill image command to the command buffer.</p>
<pre><code class="language-c">mux_result_t muxCommandFillImage(
    mux_command_buffer_t command_buffer,
    mux_image_t image,
    const void* color,
    uint32_t color_size,
    mux_offset_3d_t offset,
    mux_extent_3d_t extent,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - The command buffer to push the image fill command
to.</p></li>
<li><p><code class="docutils literal notranslate">image</code> - The image to fill.</p></li>
<li><p><code class="docutils literal notranslate">color</code> - The color to fill the image with, this data <strong>must</strong> be
copied by the device.</p></li>
<li><p><code class="docutils literal notranslate">color_size</code> - The size (in bytes) of color, the maximum size is 16
bytes which is the size of a 4 element vector of 32-bit elements.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> - The x, y, z, offset in pixels into the image to fill.</p></li>
<li><p><code class="docutils literal notranslate">extent</code> - The width, height, depth in pixels of the image to fill.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">color</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">color_size</code> is <code class="docutils literal notranslate">0</code> or is greater than <code class="docutils literal notranslate">16</code>.</p></li>
<li><p><code class="docutils literal notranslate">offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than the image
size.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not
<code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is
<code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandFillImage()</code>, for a given <code class="docutils literal notranslate">command_buffer</code>,
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">image</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code> until
<code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">color</code> <strong>may</strong> be used immediately after <code class="docutils literal notranslate">muxCommandFillImage()</code>
returns.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandcopyimage">
<a class="header-link" href="#muxcommandcopyimage"><h3 id="muxcommandcopyimage">muxCommandCopyImage</h3><span class="material-icons">link</span></a>
<p>Push a copy image command to the command buffer.</p>
<pre><code class="language-c">mux_result_t muxCommandCopyImage(
    mux_command_buffer_t command_buffer,
    mux_image_t src_image,
    mux_image_t dst_image,
    mux_offset_3d_t src_offset,
    mux_offset_3d_t dst_offset,
    mux_extent_3d_t extent,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - The command buffer to push the image copy command
to.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> - The source image where data will be copied from.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> - The destination image where data will be copied to.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> - The x, y, z offset in pixels into the source image.</p></li>
<li><p><code class="docutils literal notranslate">dst_offset</code> - The x, y, z offset in pixels into the destination
image.</p></li>
<li><p><code class="docutils literal notranslate">extent</code> - The width, height, depth in pixels range of the images
to be copied.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than
<code class="docutils literal notranslate">src_image</code>’s size.</p></li>
<li><p><code class="docutils literal notranslate">dst_offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than
<code class="docutils literal notranslate">dst_image</code>’s size.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not
<code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is
<code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandCopyImage()</code>, for a given <code class="docutils literal notranslate">command_buffer</code>,
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code>, <code class="docutils literal notranslate">src_image</code> and <code class="docutils literal notranslate">dst_image</code> <strong>must</strong> have been
created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code>
until <code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code>
until <code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> and <code class="docutils literal notranslate">dst_image</code> <strong>must not</strong> refer to overlapping
regions within the same <code class="docutils literal notranslate">mux_memory_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandcopyimagetobuffer">
<a class="header-link" href="#muxcommandcopyimagetobuffer"><h3 id="muxcommandcopyimagetobuffer">muxCommandCopyImageToBuffer</h3><span class="material-icons">link</span></a>
<p>Push a copy image to buffer command to the command buffer.</p>
<pre><code class="language-c">mux_result_t muxCommandCopyImageToBuffer(
    mux_command_buffer_t command_buffer,
    mux_image_t src_image,
    mux_buffer_t dst_buffer,
    mux_offset_3d_t src_offset,
    uint64_t dst_offset,
    mux_extent_3d_t extent,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - The command buffer to push the image to buffer
copy to.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> - The source image to copy data from.</p></li>
<li><p><code class="docutils literal notranslate">dst_buffer</code> - The destination buffer to copy data to.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> - The x, y, z, offset in pixels into the source image
to copy.</p></li>
<li><p><code class="docutils literal notranslate">dst_offset</code> - The offset in bytes into the destination buffer to
copy.</p></li>
<li><p><code class="docutils literal notranslate">extent</code> - The width, height, depth in pixels of the image to copy.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than
<code class="docutils literal notranslate">src_image</code> size.</p></li>
<li><p><code class="docutils literal notranslate">dst_offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than
<code class="docutils literal notranslate">dst_buffer</code> size.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not
<code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is
<code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandCopyImageToBuffer()</code>, for a given
<code class="docutils literal notranslate">command_buffer</code>, <strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">image</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">src_image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code>
until <code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">dst_buffer</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code>
instance.</p></li>
<li><p><code class="docutils literal notranslate">dst_buffer</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code>
until <code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandcopybuffertoimage">
<a class="header-link" href="#muxcommandcopybuffertoimage"><h3 id="muxcommandcopybuffertoimage">muxCommandCopyBufferToImage</h3><span class="material-icons">link</span></a>
<p>Push a copy buffer to image command to the command buffer.</p>
<pre><code class="language-c">mux_result_t muxCommandCopyBufferToImage(
    mux_command_buffer_t command_buffer,
    mux_buffer_t src_buffer,
    mux_image_t dst_image,
    uint32_t src_offset,
    mux_offset_3d_t dst_offset,
    mux_extent_3d_t extent,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - The command buffer to push the buffer to image
copy command to.</p></li>
<li><p><code class="docutils literal notranslate">src_buffer</code> - The source buffer to copy data from.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> - The destination image to copy data to.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> - The offset in bytes into the source buffer to copy.</p></li>
<li><p><code class="docutils literal notranslate">dst_offset</code> - The x, y, z, offset in pixels into the destination
image to copy.</p></li>
<li><p><code class="docutils literal notranslate">extent</code> - The width, height, depth in pixels range of the data to
copy.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned when;</p>
<ul>
<li><p><code class="docutils literal notranslate">command_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_buffer</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> is <code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than
<code class="docutils literal notranslate">src_buffer</code> size.</p></li>
<li><p><code class="docutils literal notranslate">dst_offset</code> combined with <code class="docutils literal notranslate">extent</code> is greater than
<code class="docutils literal notranslate">dst_image</code> size.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not
<code class="docutils literal notranslate">NULL</code>.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is
<code class="docutils literal notranslate">NULL</code>.</p></li>
</ul>
</li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandCopyBufferToImage()</code>, for a given
<code class="docutils literal notranslate">command_buffer</code>, <strong>shall</strong> be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">image</code> <strong>must</strong> have been created using the
same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">src_buffer</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code>
instance.</p></li>
<li><p><code class="docutils literal notranslate">src_buffer</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code>
until <code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> <strong>must</strong> be bound to a valid <code class="docutils literal notranslate">mux_memory_t</code> instance.</p></li>
<li><p><code class="docutils literal notranslate">dst_image</code> <strong>must not</strong> be rebound to another <code class="docutils literal notranslate">mux_memory_t</code>
until <code class="docutils literal notranslate">command_buffer</code> completes execution.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandndrange">
<a class="header-link" href="#muxcommandndrange"><h3 id="muxcommandndrange">muxCommandNDRange</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCommandNDRange()</code> pushes a command to a command buffer to execute a
kernel.</p>
<pre><code class="language-c">mux_result_t muxCommandNDRange(
    mux_command_buffer_t command_buffer,
    mux_kernel_t kernel,
    mux_ndrange_options_t options,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">kernel</code> - a kernel previously created by a call to <code class="docutils literal notranslate">muxCreateKernel()</code>.</p></li>
<li><p><code class="docutils literal notranslate">options</code> - a <code class="docutils literal notranslate">mux_ndrange_options_t</code> with user provided
kernel execution options.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">options.descriptors</code> is not NULL and <code class="docutils literal notranslate">descriptors_length</code> is 0,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">options.descriptors</code> is NULL and <code class="docutils literal notranslate">descriptors_length</code> is not 0,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If any element in <code class="docutils literal notranslate">options.local_size</code> is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">options.global_offset</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">options.global_size</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">options.length</code> is 0 or greater than 3, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">options.descriptors</code> contains an element where the <code class="docutils literal notranslate">type</code> data member
is <code class="docutils literal notranslate">mux_descriptor_info_type_custom_buffer</code> and
<code class="docutils literal notranslate">device-&gt;info-&gt;custom_buffer_capabilities</code> is <code class="docutils literal notranslate">0</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandNDRange()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">kernel</code> passed to <code class="docutils literal notranslate">muxCommandNDRange()</code>
<strong>must</strong> have been created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxupdatedescriptors">
<a class="header-link" href="#muxupdatedescriptors"><h3 id="muxupdatedescriptors">muxUpdateDescriptors</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxUpdateDescriptors</code> updates the <code class="docutils literal notranslate">mux_descriptor_info_t</code> descriptors
associated with an ND range command enqueued via <code class="docutils literal notranslate">muxCommandNDRange()</code>. This
entry point updates arguments to an ND range in a command buffer.</p>
<p>Entry point is optional as it requires device support for updating descriptors and
<strong>must</strong> return <code class="docutils literal notranslate">mux_error_feature_unsupported</code> if this is not the case.</p>
<pre><code class="language-c">mux_result_t muxUpdateDescriptors(mux_command_buffer_t command_buffer,
                                 mux_command_id_t command_id,
                                 uint64_t num_args, uint64_t *arg_indices,
                                 mux_descriptor_info_t *descriptors);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - the command buffer containing the NDRange command.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate">command_id</code> - the ID that uniquely identifies the NDRange command within</dt><dd><p><code class="docutils literal notranslate">command_buffer</code> by the index of command within the command
buffer.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate">num_args</code> - the number of arguments to be updated.</p></li>
<li><p><code class="docutils literal notranslate">arg_indices</code> - the indices of the arguments to be updated.</p></li>
<li><p><code class="docutils literal notranslate">descriptors</code> - the descriptors for the new arguments.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If the device associated with <code class="docutils literal notranslate">command_buffer</code> does not support updating
descriptors i.e. <code class="docutils literal notranslate">mux_device_info_s::descriptors_updatable == false</code>
<code class="docutils literal notranslate">mux_error_feature_unsupported</code> must be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned, <code class="docutils literal notranslate">command_buffer</code>
<strong>should</strong> be considered unchanged and the arguments to the ND Range command
identified by <code class="docutils literal notranslate">command_id</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxUpdateDescriptors()</code> operating on distinct <code class="docutils literal notranslate">command_buffer</code>’s
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> <strong>shall</strong> be in the <em>finalized</em> state when it
passed to <code class="docutils literal notranslate">muxUpdateDescriptors()</code>.</p></li>
<li><p>The type of a descriptor <strong>should not</strong> be changed unless it is between:
<code class="docutils literal notranslate">mux_descriptor_info_type_buffer</code> and
<code class="docutils literal notranslate">mux_descriptor_info_type_null_buffer</code>.</p></li>
<li><p>If any descriptors of type <code class="docutils literal notranslate">mux_descriptor_info_type_plain_old_data</code>
change their size, the behaviour is undefined.</p></li>
</ul>
</div>
<div class="section" id="muxcommandusercallback">
<a class="header-link" href="#muxcommandusercallback"><h3 id="muxcommandusercallback">muxCommandUserCallback</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCommandUserCallback()</code> pushes a command to a command buffer that
executes a user callback.</p>
<pre><code class="language-c">mux_result_t muxCommandUserCallback(
    mux_command_buffer_t command_buffer,
    mux_command_user_callback_t user_function,
    void* user_data,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">user_function</code> - a user callback function.</p></li>
<li><p><code class="docutils literal notranslate">user_data</code> - some user data that will be passed to the
<code class="docutils literal notranslate">user_function</code> when it is executed.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">user_function</code> is NULL, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">command_buffer</code> <strong>should</strong> be considered unchanged.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandUserCallback()</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandbeginquery">
<a class="header-link" href="#muxcommandbeginquery"><h3 id="muxcommandbeginquery">muxCommandBeginQuery</h3><span class="material-icons">link</span></a>
<p>Push a begin query command to the command buffer, enable a query pool for
use storing query results.</p>
<pre><code class="language-c">mux_result_t muxCommandBeginQuery(
    mux_command_buffer_t command_buffer,
    mux_query_pool_t query_pool,
    uint32_t query_index,
    uint32_t query_count,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - the command buffer to push the begin query command
to.</p></li>
<li><p><code class="docutils literal notranslate">query_pool</code> - the query pool to store the query result in.</p></li>
<li><p><code class="docutils literal notranslate">query_index</code> - the first query slot index that will contain
results.</p></li>
<li><p><code class="docutils literal notranslate">query_count</code> - the number of query slots that will contain
results.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">command_buffer</code> is not a valid <code class="docutils literal notranslate">mux_command_buffer_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_pool</code> is not a valid <code class="docutils literal notranslate">mux_query_pool_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index</code> is greater than or equal to <code class="docutils literal notranslate">query_pool-&gt;count</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index + query_count</code> is greater than
<code class="docutils literal notranslate">query_pool-&gt;count</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandBeginQuery</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandendquery">
<a class="header-link" href="#muxcommandendquery"><h3 id="muxcommandendquery">muxCommandEndQuery</h3><span class="material-icons">link</span></a>
<p>Push an end query command to the command buffer. End query commands disable a
query pool from use for storing query results.</p>
<pre><code class="language-c">mux_result_t muxCommandEndQuery(
    mux_command_buffer_t command_buffer,
    mux_query_pool_t query_pool,
    uint32_t query_index,
    uint32_t query_count,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - the command buffer to push the begin query command
to.</p></li>
<li><p><code class="docutils literal notranslate">query_pool</code> - the query pool the result is stored in.</p></li>
<li><p><code class="docutils literal notranslate">query_index</code> - the first query slot index that contains results.</p></li>
<li><p><code class="docutils literal notranslate">query_count</code> - the number of query slots that contains results.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">command_buffer</code> is not a valid <code class="docutils literal notranslate">mux_command_buffer_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_pool</code> is not a valid <code class="docutils literal notranslate">mux_query_pool_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index</code> is greater than or equal to <code class="docutils literal notranslate">query_pool-&gt;count</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index + query_count</code> is greater than
<code class="docutils literal notranslate">query_pool-&gt;count</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_pool</code> is not currently enabled with a previous call to
<code class="docutils literal notranslate">muxCommandBeginQuery()</code> with the same <code class="docutils literal notranslate">command_buffer</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>should</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index</code> is not currently enabled with a previous call to
<code class="docutils literal notranslate">muxCommandBeginQuery()</code> with the same <code class="docutils literal notranslate">command_buffer</code> and
<code class="docutils literal notranslate">query_pool</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>should</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<blockquote>
<div><p>Note: <code class="docutils literal notranslate">query_pool</code> and <code class="docutils literal notranslate">query_index</code> validation relating to
previous calls to <code class="docutils literal notranslate">muxCommandBeginQuery()</code> <strong>should</strong> be performed by
the target.</p>
</div></blockquote>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandEndQuery</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
<div class="section" id="muxcommandresetquerypool">
<a class="header-link" href="#muxcommandresetquerypool"><h3 id="muxcommandresetquerypool">muxCommandResetQueryPool</h3><span class="material-icons">link</span></a>
<p>Push a reset query pool command to the command buffer. Reset query pool
commands enable reuse of the query pool as if it was newly created.</p>
<pre><code class="language-c">mux_result_t muxCommandResetQueryPool(
    mux_command_buffer_t command_buffer,
    mux_query_pool_t query_pool,
    uint32_t query_index,
    uint32_t query_count,
    uint32_t num_sync_points_in_wait_list,
    const mux_sync_point_t* sync_point_wait_list,
    mux_sync_point_t* sync_point);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">command_buffer</code> - the command buffer to push the query pool reset
command to.</p></li>
<li><p><code class="docutils literal notranslate">query_pool</code> - the query pool to reset.</p></li>
<li><p><code class="docutils literal notranslate">query_index</code> - the first query index to reset.</p></li>
<li><p><code class="docutils literal notranslate">query_count</code> - the number of query slots to reset.</p></li>
<li><p><code class="docutils literal notranslate">num_sync_points_in_wait_list</code> - Number of items in
<code class="docutils literal notranslate">sync_point_wait_list</code>.</p></li>
<li><p><code class="docutils literal notranslate">sync_point_wait_list</code> - List of sync-points that need to complete before
this command can be executed.</p></li>
<li><p><code class="docutils literal notranslate">sync_point</code> - Returns a sync-point identifying this command, which <strong>may</strong>
be passed as NULL, that other commands in the command-buffer can wait on.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">command_buffer</code> is not a valid <code class="docutils literal notranslate">mux_command_buffer_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_pool</code> is not a valid <code class="docutils literal notranslate">mux_query_pool_t</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index</code> is greater than or equal to <code class="docutils literal notranslate">query_pool-&gt;count</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">query_index + query_count</code> is greater than
<code class="docutils literal notranslate">query_pool-&gt;count</code>, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">num_sync_points_in_wait_list</code> is not 0 and <code class="docutils literal notranslate">sync_point_wait_list</code> is NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCommandResetQueryPool</code> operating on distinct
<code class="docutils literal notranslate">command_buffer</code>’s <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> argument <strong>must</strong> not be in the <em>finalized</em> state.</p></li>
<li><p>The elements of <code class="docutils literal notranslate">sync_point_wait_list</code> <strong>must</strong> have been created from
commands recorded to <code class="docutils literal notranslate">command_buffer</code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="fences">
<a class="header-link" href="#fences"><h2 id="fences">Fences</h2><span class="material-icons">link</span></a>
<p>Fences in Mux allow one way synchronization from device to host.</p>

<div class="section" id="muxcreatefence">
<a class="header-link" href="#muxcreatefence"><h3 id="muxcreatefence">muxCreateFence</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateFence()</code> creates a fence from a given Mux device.</p>
<pre><code class="language-c">mux_result_t muxCreateFence(
    mux_device_t device,
    mux_allocator_info_t allocator_info,
    mux_fence_t* out_fence);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to create this fence with.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_fence</code> - the newly created fence.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_fence</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_fence</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateFence()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxdestroyfence">
<a class="header-link" href="#muxdestroyfence"><h3 id="muxdestroyfence">muxDestroyFence</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroyFence()</code> destroys a previously created
<code class="docutils literal notranslate">mux_fence_t</code>.</p>
<pre><code class="language-c">void muxDestroyFence(
    mux_device_t device,
    mux_fence_t fence,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device the fence was created with.</p></li>
<li><p><code class="docutils literal notranslate">fence</code> - a fence previously created by a call to
<code class="docutils literal notranslate">muxCreateFence()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">fence</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroyFence()</code> with a given <code class="docutils literal notranslate">fence</code>
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroyFence()</code> <strong>must</strong>
be the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateFence()</code> that created <code class="docutils literal notranslate">fence</code>.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">fence</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_fence_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxresetfence">
<a class="header-link" href="#muxresetfence"><h3 id="muxresetfence">muxResetFence</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxResetFence()</code> resets a previously created <code class="docutils literal notranslate">mux_fence_t</code>
such that it is in the same non-signalled state as when it was
originally created.</p>
<pre><code class="language-c">mux_result_t muxResetFence(
    mux_fence_t fence);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">fence</code> - a fence previously created by a call to
<code class="docutils literal notranslate">muxCreateFence()</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxResetFence()</code> with a given <code class="docutils literal notranslate">fence</code> <strong>shall</strong>
be considered thread-safe.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code> that was used in the creation of the
<code class="docutils literal notranslate">mux_fence_t</code> <strong>must not</strong> be destroyed before the fence
has been destroyed.</p></li>
</ul>
</div>
</div>
<div class="section" id="semaphores">
<a class="header-link" href="#semaphores"><h2 id="semaphores">Semaphores</h2><span class="material-icons">link</span></a>
<p>Semaphores in Mux allow synchronization between
<code class="docutils literal notranslate">mux_command_buffer_t</code>’s executing on a <code class="docutils literal notranslate">mux_queue_t</code>. When a
<code class="docutils literal notranslate">mux_command_buffer_t</code> is dispatched via <code class="docutils literal notranslate">muxDispatch()</code> a user can
request that <code class="docutils literal notranslate">mux_command_buffer_t</code> only begin execution once a number
of semaphores are signalled, and can request that when a
<code class="docutils literal notranslate">mux_command_buffer_t</code> has completed that it signal a number of
semaphores too.</p>
<div class="section" id="muxcreatesemaphore">
<a class="header-link" href="#muxcreatesemaphore"><h3 id="muxcreatesemaphore">muxCreateSemaphore</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxCreateSemaphore()</code> creates a semaphore from a given Mux device.</p>
<pre><code class="language-c">mux_result_t muxCreateSemaphore(
    mux_device_t device,
    mux_allocator_info_t allocator_info,
    mux_semaphore_t* out_semaphore);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to create this semaphore with.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <strong>should</strong> be used
for host memory allocations as described in the
<a class="reference external" href="#allocators">Allocators</a> section.</p></li>
<li><p><code class="docutils literal notranslate">out_semaphore</code> - the newly created semaphore.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">allocator_info</code> function pointer fields are <code class="docutils literal notranslate">NULL</code>,
<code class="docutils literal notranslate">mux_error_null_allocator_callback</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_semaphore</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code>
<strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_semaphore</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxCreateSemaphore()</code> <strong>shall</strong> be considered
thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxdestroysemaphore">
<a class="header-link" href="#muxdestroysemaphore"><h3 id="muxdestroysemaphore">muxDestroySemaphore</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDestroySemaphore()</code> destroys a previously created
<code class="docutils literal notranslate">mux_semaphore_t</code>.</p>
<pre><code class="language-c">void muxDestroySemaphore(
    mux_device_t device,
    mux_semaphore_t semaphore,
    mux_allocator_info_t allocator_info);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the device the semaphore was created with.</p></li>
<li><p><code class="docutils literal notranslate">semaphore</code> - a semaphore previously created by a call to
<code class="docutils literal notranslate">muxCreateSemaphore()</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> - the user provided allocator <code class="docutils literal notranslate">semaphore</code> was
created with.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDestroySemaphore()</code> with a given <code class="docutils literal notranslate">semaphore</code>
<strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">allocator_info</code> passed to <code class="docutils literal notranslate">muxDestroySemaphore()</code> <strong>must</strong>
be the same <code class="docutils literal notranslate">mux_allocator_info_t</code> as was used in the call to
<code class="docutils literal notranslate">muxCreateSemaphore()</code> that created <code class="docutils literal notranslate">semaphore</code>.</p></li>
<li><p><code class="docutils literal notranslate">muxDestroySemaphore()</code> <strong>must not</strong> be called in a
<code class="docutils literal notranslate">muxDispatch()</code>’s <code class="docutils literal notranslate">user_function</code> callback.</p></li>
<li><p><code class="docutils literal notranslate">muxDestroySemaphore()</code> <strong>may</strong> be called as soon as a
<code class="docutils literal notranslate">muxDispatch()</code> has signalled the semaphore.</p></li>
<li><p><code class="docutils literal notranslate">device</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">semaphore</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_semaphore_t</code>.</p></li>
<li><p><code class="docutils literal notranslate">allocator_info</code> <strong>must</strong> be a valid <code class="docutils literal notranslate">mux_allocator_info_t</code>.</p></li>
</ul>
</div>
<div class="section" id="muxresetsemaphore">
<a class="header-link" href="#muxresetsemaphore"><h3 id="muxresetsemaphore">muxResetSemaphore</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxResetSemaphore()</code> resets a previously created <code class="docutils literal notranslate">mux_semaphore_t</code>
such that it is in the same non-signalled state as when it was
originally created.</p>
<pre><code class="language-c">mux_result_t muxResetSemaphore(
    mux_semaphore_t semaphore);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">semaphore</code> - a semaphore previously created by a call to
<code class="docutils literal notranslate">muxCreateSemaphore()</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxResetSemaphore()</code> with a given <code class="docutils literal notranslate">semaphore</code> <strong>shall</strong>
be considered thread-safe.</p></li>
<li><p><code class="docutils literal notranslate">muxResetSemaphore()</code> <strong>must not</strong> be called in a
<code class="docutils literal notranslate">muxDispatch()</code>’s <code class="docutils literal notranslate">user_function</code> callback.</p></li>
<li><p><code class="docutils literal notranslate">muxResetSemaphore()</code> <strong>should not</strong> be called with a given
<code class="docutils literal notranslate">semaphore</code> that is being waited on by a call <code class="docutils literal notranslate">muxDispatch()</code>,
but has not been signalled yet.</p></li>
<li><p><code class="docutils literal notranslate">muxResetSemaphore()</code> <strong>may</strong> be called as soon as a
<code class="docutils literal notranslate">muxDispatch()</code> has signalled the semaphore.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code> that was used in the creation of the
<code class="docutils literal notranslate">mux_semaphore_t</code> <strong>must not</strong> be destroyed before the semaphore
has been destroyed.</p></li>
<li><p>The <code class="docutils literal notranslate">mux_semaphore_t</code> <strong>must not</strong> be reset while a
<code class="docutils literal notranslate">mux_command_buffer_t</code> that it is waiting on is currently executing.</p></li>
<li><p>The <code class="docutils literal notranslate">mux_semaphore_t</code> <strong>must not</strong> be reset while a
<code class="docutils literal notranslate">mux_command_buffer_t</code> that is signalling it currently executing.</p></li>
</ul>
</div>
</div>
<div class="section" id="queues">
<a class="header-link" href="#queues"><h2 id="queues">Queues</h2><span class="material-icons">link</span></a>
<p>Queues in Mux are where <code class="docutils literal notranslate">mux_command_buffer_t</code> are dispatched to the
device’s hardware for execution.</p>
<div class="section" id="muxgetqueue">
<a class="header-link" href="#muxgetqueue"><h3 id="muxgetqueue">muxGetQueue</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxGetQueue()</code> retrieves a queue from a given Mux device.</p>
<pre><code class="language-c">mux_result_t muxGetQueue(
    mux_device_t device,
    mux_queue_type_e queue_type,
    uint32_t queue_index,
    mux_queue_t* out_queue);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">device</code> - the <code class="docutils literal notranslate">mux_device_t</code> to get this queue from.</p></li>
<li><p><code class="docutils literal notranslate">queue_type</code> - the type of queue to get.</p></li>
<li><p><code class="docutils literal notranslate">queue_index</code> - the index of the queue type to get.</p></li>
<li><p><code class="docutils literal notranslate">out_queue</code> - the retrieved queue.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">queue_type</code> is not a valid <code class="docutils literal notranslate">mux_queue_type_e</code>,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">queue_index</code> is not a valid index for <code class="docutils literal notranslate">device</code>’s
<code class="docutils literal notranslate">mux_queue_t</code>’s, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be
returned.</p></li>
<li><p>If <code class="docutils literal notranslate">out_queue</code> is NULL, <code class="docutils literal notranslate">mux_error_null_out_parameter</code> <strong>must</strong>
be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p>If an error code other than <code class="docutils literal notranslate">mux_success</code> is returned,
<code class="docutils literal notranslate">out_queue</code> <strong>must not</strong> be used.</p>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxGetQueue()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
</div>
<div class="section" id="muxdispatch">
<a class="header-link" href="#muxdispatch"><h3 id="muxdispatch">muxDispatch</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxDispatch()</code> enqueues a <code class="docutils literal notranslate">mux_command_buffer_t</code> for executing on a
given queue. Commands within a command buffer <strong>must</strong> be executed <em>as
if</em> in the order they are pushed onto the command buffer.</p>
<pre><code class="language-c">mux_result_t muxDispatch(
    mux_queue_t queue,
    mux_command_buffer_t command_buffer,
    mux_fence_t fence,
    mux_semaphore_t* wait_semaphores,
    uint32_t wait_semaphores_length,
    mux_semaphore_t* signal_semaphores,
    uint32_t signal_semaphores_length
    void (*user_function)(
        mux_command_buffer_t command_buffer,
        mux_result_t error,
        void* const user_data),
    void* user_data);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - a queue previously created by a call to
<code class="docutils literal notranslate">muxGetQueue()</code>.</p></li>
<li><p><code class="docutils literal notranslate">command_buffer</code> - a command buffer previously created by a call to
<code class="docutils literal notranslate">muxCreateCommandBuffer()</code>.</p></li>
<li><p><code class="docutils literal notranslate">fence</code> - an optional fence created by a call to <code class="docutils literal notranslate">muxCreateFence()</code> to
be signaled when <code class="docutils literal notranslate">command_buffer</code> completes.</p></li>
<li><p><code class="docutils literal notranslate">wait_semaphores</code> - an array of semaphores that <strong>must</strong> be
complete before <code class="docutils literal notranslate">command_buffer</code> begins execution.</p></li>
<li><p><code class="docutils literal notranslate">wait_semaphores_length</code> - the length of <code class="docutils literal notranslate">wait_semaphores</code>.</p></li>
<li><p><code class="docutils literal notranslate">signal_semaphores</code> - an array of semaphores that <strong>must</strong> be
signaled once both <code class="docutils literal notranslate">command_buffer</code> and <code class="docutils literal notranslate">user_function</code> complete
execution.</p></li>
<li><p><code class="docutils literal notranslate">signal_semaphores_length</code> - the length of <code class="docutils literal notranslate">signal_semaphores</code>.</p></li>
<li><p><code class="docutils literal notranslate">user_function</code> - a callback function to call when the command
group has completed, this <strong>must</strong> occur before <code class="docutils literal notranslate">signal_semaphores</code>
are signaled.</p></li>
<li><p><code class="docutils literal notranslate">user_data</code> - the user data to pass to <code class="docutils literal notranslate">user_function</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate">wait_semaphores</code> is NULL and <code class="docutils literal notranslate">wait_semaphores_length</code> is not
0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">wait_semaphores</code> is not NULL and <code class="docutils literal notranslate">wait_semaphores_length</code> is
0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">signal_semaphores</code> is NULL and <code class="docutils literal notranslate">signal_semaphores_length</code> is
not 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">signal_semaphores</code> is not NULL and <code class="docutils literal notranslate">signal_semaphores_length</code>
is 0, <code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">user_function</code> is NULL and <code class="docutils literal notranslate">user_data</code> is not NULL,
<code class="docutils literal notranslate">mux_error_invalid_value</code> <strong>must</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
<li><p>If <code class="docutils literal notranslate">command_buffer</code> is not finalized, <code class="docutils literal notranslate">mux_error_invalid_value</code>
<strong>must</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxDispatch()</code> <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> and <code class="docutils literal notranslate">command_buffer</code> passed to <code class="docutils literal notranslate">muxDispatch()</code>
<strong>must</strong> have been created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> and <code class="docutils literal notranslate">fence</code> passed to <code class="docutils literal notranslate">muxDispatch()</code>
<strong>must</strong> have been created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> and all <code class="docutils literal notranslate">mux_semaphore_t</code>’s in <code class="docutils literal notranslate">wait_semaphores</code>
<strong>must</strong> have been created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> and all <code class="docutils literal notranslate">mux_semaphore_t</code>’s in
<code class="docutils literal notranslate">signal_semaphores</code> <strong>must</strong> have been created using the same
<code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>All <code class="docutils literal notranslate">mux_semaphore_t</code>’s in <code class="docutils literal notranslate">signal_semaphores</code> <strong>must not</strong> be
signalled by another call to <code class="docutils literal notranslate">muxDispatch()</code> while a given
<code class="docutils literal notranslate">command_buffer</code> is currently executing.</p></li>
<li><p>All <code class="docutils literal notranslate">mux_semaphore_t</code>’s in <code class="docutils literal notranslate">signal_semaphores</code> <strong>may</strong> be reset
with <code class="docutils literal notranslate">muxResetSemaphore()</code> or destroyed with
<code class="docutils literal notranslate">muxDestroySemaphore()</code> as soon as the command buffer invoked by
<code class="docutils literal notranslate">muxDispatch()</code> has completed.</p></li>
<li><p><code class="docutils literal notranslate">fence</code> <strong>may</strong> be reset with <code class="docutils literal notranslate">muxResetFence()</code> or destroyed with
<code class="docutils literal notranslate">muxDestroyFence()</code> as soon as the command buffer invoked by
<code class="docutils literal notranslate">muxDispatch()</code> has completed.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> passed to <code class="docutils literal notranslate">muxDispatch()</code> <strong>may</strong> be empty.</p></li>
<li><p>The <code class="docutils literal notranslate">fence</code> passed to <code class="docutils literal notranslate">muxDispatch()</code> <strong>may</strong> be null indicating there
is no fence to be signaled on dispatch completion.</p></li>
<li><p>The <code class="docutils literal notranslate">user_function</code> callback <strong>must not</strong> destroy or reset the
dispatched <code class="docutils literal notranslate">command_buffer</code> or the semaphores in the
<code class="docutils literal notranslate">wait_semaphores</code> and <code class="docutils literal notranslate">signal_semaphores</code> lists.</p></li>
<li><p>The <code class="docutils literal notranslate">command_buffer</code> <strong>shall</strong> be considered complete after the
<code class="docutils literal notranslate">user_function</code> has been called, semaphores in the <code class="docutils literal notranslate">signal_semaphores</code>
list have been signaled and the optional fence argument has been signaled if
it exists.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate">mux_command_buffer_t</code> that has been dispatched to a queue via
<code class="docutils literal notranslate">muxDispatch()</code> <strong>must not</strong> be destroyed while it is still
executing.</p></li>
</ul>
</div>
<div class="section" id="muxtrywait">
<a class="header-link" href="#muxtrywait"><h3 id="muxtrywait">muxTryWait</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxTryWait()</code> attempts to wait on a <code class="docutils literal notranslate">mux_fence_t</code> to be signaled on
completion of a <code class="docutils literal notranslate">mux_command_buffer_t</code> that is executing on a given queue
dispatched via <code class="docutils literal notranslate">muxDispatch()</code>.</p>
<pre><code class="language-c">mux_result_t muxTryWait(
    mux_queue_t queue,
    uint64_t timeout,
    mux_fence_t fence);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - a queue previously created by a call to
<code class="docutils literal notranslate">muxGetQueue()</code>.</p></li>
<li><p><code class="docutils literal notranslate">timeout</code> - a timeout period in units of nanoseconds. The value of
<code class="docutils literal notranslate">timeout</code> is adjusted to the closest value supported by the target’s
timeout accuracy, this <strong>may</strong> be longer than one nanosecond and hence
<code class="docutils literal notranslate">muxTryWait</code> may wait longer than the period defined by <code class="docutils literal notranslate">timeout</code>.</p></li>
<li><p><code class="docutils literal notranslate">fence</code> - a fence previously used in a call to
<code class="docutils literal notranslate">muxDispatch()</code> on the given <code class="docutils literal notranslate">queue</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If the <code class="docutils literal notranslate">fence</code> has not yet been signaled,
<code class="docutils literal notranslate">mux_fence_not_ready</code> <strong>must</strong> be returned.</p></li>
<li><p>If the <code class="docutils literal notranslate">fence</code> has been signaled,
<code class="docutils literal notranslate">mux_error_fence_failure</code> <strong>may</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxTryWait()</code> <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> and <code class="docutils literal notranslate">fence</code> passed to <code class="docutils literal notranslate">muxTryWait()</code>
<strong>must</strong> have been created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">fence</code> passed to <code class="docutils literal notranslate">muxTryWait()</code> <strong>must</strong> have previously been
dispatched with a command buffer on the given <code class="docutils literal notranslate">queue</code> via a call to
<code class="docutils literal notranslate">muxDispatch()</code>.</p></li>
<li><p><code class="docutils literal notranslate">muxTryWaitTest()</code> <strong>may</strong> wait for the suggested <code class="docutils literal notranslate">timeout</code> period.
Passing <code class="docutils literal notranslate">0</code> for the <code class="docutils literal notranslate">timeout</code> parameter indicates there is no timeout
period.</p></li>
</ul>
</div>
<div class="section" id="muxwait">
<a class="header-link" href="#muxwait"><h3 id="muxwait">muxWait</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxWait()</code> waits on a <code class="docutils literal notranslate">mux_fence_t</code> to be signaled on completion of a
<code class="docutils literal notranslate">mux_command_buffer_t</code> that is executing on a given queue dispatched via
<code class="docutils literal notranslate">muxDispatch()</code>.</p>
<pre><code class="language-c">mux_result_t muxWait(mux_queue_t queue, mux_fence_t fence);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - a queue previously created by a call to
<code class="docutils literal notranslate">muxGetQueue()</code>.</p></li>
<li><p><code class="docutils literal notranslate">fence</code> - a fence previously used in a call to
<code class="docutils literal notranslate">muxDispatch()</code> on the given <code class="docutils literal notranslate">queue</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p>If the <code class="docutils literal notranslate">fence</code> has been signaled,
<code class="docutils literal notranslate">mux_error_fence_failure</code> <strong>may</strong> be returned.</p></li>
<li><p>Otherwise <code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxWait()</code> <strong>shall</strong> be considered thread-safe.</p></li>
<li><p>The <code class="docutils literal notranslate">queue</code> and <code class="docutils literal notranslate">fence</code> passed to <code class="docutils literal notranslate">muxWait()</code> <strong>must</strong>
have been created using the same <code class="docutils literal notranslate">mux_device_t</code>.</p></li>
<li><p>The <code class="docutils literal notranslate">fence</code> passed to <code class="docutils literal notranslate">muxTryWait()</code> <strong>must</strong> have previously been
dispatched with a command buffer on the given <code class="docutils literal notranslate">queue</code> via a call to
<code class="docutils literal notranslate">muxDispatch()</code>.</p></li>
</ul>
</div>
<div class="section" id="muxwaitall">
<a class="header-link" href="#muxwaitall"><h3 id="muxwaitall">muxWaitAll</h3><span class="material-icons">link</span></a>
<p><code class="docutils literal notranslate">muxWaitAll()</code> waits on all previously dispatched
<code class="docutils literal notranslate">mux_command_buffer_t</code>’s that are executing on a given queue to
complete.</p>
<pre><code class="language-c">mux_result_t muxWaitAll(
    mux_queue_t queue);
</code>
</pre>
<ul class="simple">
<li><p><code class="docutils literal notranslate">queue</code> - a queue previously created by a call to
<code class="docutils literal notranslate">muxGetQueue()</code>.</p></li>
</ul>
<p class="rubric">Return Codes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate">mux_success</code> <strong>should</strong> be returned.</p></li>
</ul>
<p class="rubric">Valid Usage</p>
<ul class="simple">
<li><p>Calls to <code class="docutils literal notranslate">muxWaitAll()</code> <strong>shall</strong> be considered thread-safe.</p></li>
</ul>
<p class="rubric">Validation Rules</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate">mux_device_t</code> that was used in the creation of the
<code class="docutils literal notranslate">mux_queue_t</code> <strong>must not</strong> be destroyed before the queue has been
destroyed.</p></li>
<li><p>The <code class="docutils literal notranslate">mux_queue_t</code> <strong>must not</strong> be destroyed while any
<code class="docutils literal notranslate">mux_command_buffer_t</code>’s that were previously enqueued for
execution via <code class="docutils literal notranslate">muxDispatch()</code> are currently executing.</p></li>
</ul>
</div>
</div>
<div class="section" id="execution-model">
<a class="header-link" href="#execution-model"><h2 id="execution-model">Execution Model</h2><span class="material-icons">link</span></a>
<p>This section briefly details Mux’s execution model: how work is defined for a
Mux device, and how the execution of work on that device can be controlled with
the API.</p>
<p>The smallest unit of work that can be created for a device at the Mux API level
is the command. These are the operations defined with the <code class="docutils literal notranslate">muxCommand</code> entry
points, they include commands such as <a class="reference internal" href="#buffers"><span class="std std-ref">Buffer</span></a> operations
(reading/writing/copying), and <a class="reference internal" href="#kernels"><span class="std std-ref">Kernel</span></a> executions.</p>
<p>Commands are not directly executed, instead they are first added to
<a class="reference internal" href="#command-buffers"><span class="std std-ref">Command Buffers</span></a>. A
Command Buffer can be thought of as a list of N commands that must be executed
<em>as if</em> in the order they were added to the Command Buffer. The <em>as if</em> wording
is important: by defining this in-order execution requirement in terms of side
effects rather than absolute execution order, we allow Mux implementations to
execute commands within Command Buffers concurrently as long as there are no
dependencies between them.  Command Buffers are the <em>executable</em> unit of work
in the Mux API. Once finalized with a call to <code class="docutils literal notranslate">muxFinalizeCommandBuffer</code> a
Command Buffer can be submitted to a <a class="reference internal" href="#queues"><span class="std std-ref">Queue</span></a> for immediate execution on the
associated Mux device with a <code class="docutils literal notranslate">muxDispatch</code> call.</p>
<p>Command Buffers executing in a Queue do not have any implicit ordering
guarantees relative to any other executing Command Buffers. Any execution
dependencies between Command Buffers must be manually enforced with the
<a class="reference internal" href="#semaphores"><span class="std std-ref">Semaphore</span></a> primitive. When a
Mux Command Buffer is dispatched, a list of wait Semaphores and a list of
signal Semaphores can optionally also be provided. A Command Buffer will wait
until all of its wait Semaphores are in the signalled state before commencing
execution on the device, and when finished it will put each of its signal
Semaphores into the signalled state. A common use of this mechanism is to
dispatch every Command Buffer with one signal Semaphore, and have it wait on
the signal Semaphores of all currently executing Command Buffers, thus creating
a queue that is guaranteed to execute each of its Command Buffers in the order
they were dispatched.</p>
</div>
</div>
</div>
</div></body>
<!-- Mirrored from 127.0.0.1/products/oneapi/construction-kit/4.0.0/guides/specifications/mux-runtime-spec.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 22 Sep 2025 18:48:44 GMT -->
</html>
                    <a id="bottom"></a>
                </div>

                <!-- Separator -->
                <div class="separator"></div>

                <!-- Rate -->
                <div id="rate" class="rate collapsed">
                    <div>
                        Rate this Guide
                    </div>
                    <form action="https://formspree.io/f/xzbypbvl" method="post">
                        <input type="hidden" name="subject" value="Guide Feedback" />
                        <input type="hidden" name="product" value="oneAPI" />
                        <input type="hidden" name="variant" value="Construction Kit" />
                        <input type="hidden" name="guide" value="http://127.0.0.1/products/oneapi/construction-kit/4.0.0/guides/specifications/mux-runtime-spec.html" />

                        <div class="up" title="Thumb up this guide">
                           <i class="material-icons">thumb_up</i>
                       </div>
                        <div class="down" title="Thumb down this guide">
                            <i class="material-icons">thumb_down</i>
                        </div>
                        <div>
                            <input type="text" name="message"
                                   required="required"
                                   minlength="3"
                                   maxlength="1000"
                                   placeholder="How can we improve this guide? (press enter to send)" />
                        </div>
                    </form>
                </div>

                <!-- Separator -->
                <div class="separator"></div>

                <!-- Navigator -->
                <div id="navigator">
                    <div>
                        <a href="versioning-2.html#bottom"
                            >
                            <div>
                                <i class="material-icons">navigate_before</i>
                            </div>
                            <div>
                                <h1>Versioning Scheme</h1>
                            </div>
                        </a>
                    </div>
                    <div>
                        <a href="mux-compiler-spec-2.html"
                            >
                            <div>
                                <h1>ComputeMux Compiler Specification</h1>
                            </div>
                            <div>
                                <i class="material-icons">navigate_next</i>
                            </div>
                        </a>
                    </div>
                </div>
            </article>

            <!-- Separator -->
            <div class="separator"></div>

            <!-- Footer Target -->
            <div id="footer-target"></div>
        </div>

        <!-- File Jump List -->
        <div id="jump-list-container" class="sticky styled-scroller">
            <div class="nav-padding">
                <div class="jump-list-container">
                    <h1 class="file-container-title">
                        <span class="material-icons">assignment</span>Jump to Section
                    </h1>
                    <ol class="in-page-jump-list">
                        <li class="heading-1"><a href="#computemux-runtime-specification">ComputeMux Runtime Specification</a></li>
                        <li class="heading-2"><a href="#glossary">Glossary</a></li>
                        <li class="heading-2"><a href="#introduction">Introduction</a></li>
                        <li class="heading-2"><a href="#allocators">Allocators</a></li>
                        <li class="heading-2"><a href="#callbacks">Callbacks</a></li>
                        <li class="heading-2"><a href="#devices">Devices</a></li>
                        <li class="heading-2"><a href="#executables">Executables</a></li>
                        <li class="heading-2"><a href="#descriptors">Descriptors</a></li>
                        <li class="heading-2"><a href="#kernels">Kernels</a></li>
                        <li class="heading-2"><a href="#memory">Memory</a></li>
                        <li class="heading-2"><a href="#buffers">Buffers</a></li>
                        <li class="heading-2"><a href="#images">Images</a></li>
                        <li class="heading-2"><a href="#queries">Queries</a></li>
                        <li class="heading-2"><a href="#command-buffers">Command Buffers</a></li>
                        <li class="heading-2"><a href="#fences">Fences</a></li>
                        <li class="heading-2"><a href="#semaphores">Semaphores</a></li>
                        <li class="heading-2"><a href="#queues">Queues</a></li>
                        <li class="heading-2"><a href="#execution-model">Execution Model</a></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Handle layout resizing here to avoid jumping -->
<script nonce="c88bcf21e27ec684e10c295241303397">
    const resizerCookie = getCookie('CDPRESIZER');
    if (resizerCookie) {
        const cookieValue = JSON.parse(resizerCookie);

        for (let [key, value] of Object.entries(cookieValue)) {
            if (value === null || value === undefined) {
                continue;
            }

            key = atob(key);
            $(':root')[0].style.setProperty('--' + key, value + 'px');
        }
    }
</script>

</main>

<!-- Product Selector-->
<div id="productSelectorDialog" class="popupDialog">
    <div class="side-by-side-panel panel">
        <div id="products">
            <div>
                <h1>Select a Product</h1>
            </div>
            <ul>
                <li>
                    <a class="productSelection oneapi" data-product="oneapi">
                        oneAPI
                    </a>
                </li>
            </ul>
        </div>
        <div id="product-selection">
            <div id="no-product">
                Please select a product
            </div>
            <div id="product">
                <div id="product-oneapi" class="product-view">
                    <h1>

                        oneAPI
                    </h1>
                    <p>oneAPI is a cross-industry, open, standards-based unified programming model that delivers a common developer experience across accelerator architecture - for faster application performance, more productivity, and greater innovation.</p>
                    <ul id="variants">
                        <li>
                            <a href="../../../index.html">
                                <div>
                                    Construction Kit
                                </div>
                                <div>
                                    <i class="material-icons">arrow_right</i>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="../../../../amd/index.html">
                                <div>
                                    for AMD GPU
                                </div>
                                <div>
                                    <i class="material-icons">arrow_right</i>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="../../../../nvidia/index.html">
                                <div>
                                    for NVIDIA® GPUs
                                </div>
                                <div>
                                    <i class="material-icons">arrow_right</i>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Color Scheme Selector-->
<div id="colorSchemeDialog" class="popupDialog">
    <div>
        <div class="selectDarkMode">
            <div>
                <img src="../../../../../../assets/img/darkmode.png" alt="Dark Mode" />
            </div>
            <div>
                <i class="material-icons">brightness_2</i>
                <h1>Dark Mode</h1>
                <p>Light text on a dark background.</p>
            </div>
        </div>
        <div class="selectLightMode">
            <div>
                <img src="../../../../../../assets/img/lightmode.png" alt="Light Mode" />
            </div>
            <div>
                <i class="material-icons">lightbulb_outline</i>
                <h1>Light Mode</h1>
                <p>Dark text on a light background.</p>
            </div>
        </div>
    </div>
</div>

<!-- Site Selector -->
<div id="siteSelectorDialog" class="popupDialog">
    <div class="panel" id="profile-panel">
        <header>
            <div>
                <i class="material-icons">public</i>
            </div>
            <div>
                <h1>Also,</h1>
                <h2>part of our network</h2>
            </div>
        </header>
        <ul>
            <li>
                <a href="https://www.codeplay.com/" target="_blank" rel="nofollow noopener noreferrer">
                    <h1>Codeplay.com</h1>
                    <p>Find out about Codeplay, the latest company news and blog posts.</p>
                </a>
            </li>
            <li>
                <a href="https://www.sycl.tech/" target="_blank" rel="nofollow noopener noreferrer">
                    <h1>SYCL.tech</h1>
                    <p>Find out about the latest SYCL news, videos and projects.</p>
                </a>
            </li>
            <li class="selected">
                <a>
                    <img src="../../../../../../assets/img/you-are-here.png" alt="You Are Here Logo" />
                    <h1>Codeplay Developer</h1>
                    <p>Get the latest documentation and release packages for ComputeCpp and ComputeSuite</p>
                </a>
            </li>
            <li>
                <a href="https://github.com/codeplaysoftware" target="_blank" rel="nofollow noopener noreferrer">
                    <h1>Codeplay Open Source</h1>
                    <p>Browse our open source projects and frameworks on GitHub.</p>
                </a>
            </li>
        </ul>
    </div>
</div>

<!-- Footer section -->
<footer class="section-padding">
    <div class="content-wrapper">
        <div>
            <h1>&copy; Codeplay Software Ltd</h1>
            <div id="copyright"></div>
        </div>
        <div>
            <ul>
                <li><a href="https://codeplay.com/" target="_blank" rel="noopener">
                    Visit codeplay.com</a></li>
                <li><a href="https://codeplay.com/company/privacy/" target="_blank" rel="noopener">
                    View Our Privacy Policy</a></li>
                <li><a href="../../../../../../cookies/index.html">
                    Read Our Cookie Policy</a></li>
            </ul>
        </div>
    </div>
</footer>

</body>
</html>